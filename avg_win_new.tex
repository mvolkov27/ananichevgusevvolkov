\documentclass{zapiski}
\originfo{Matiyasevich}{}{}{2011}
%\setcounter{page}{31}

\usepackage{cite}

\usepackage{amsmath,amsfonts}
\usepackage{amssymb}
\usepackage{epic,gastex}
%\usepackage{array}
\usepackage{amsthm}
\usepackage{hhline}
\usepackage{graphicx}

\usepackage[cp1251]{inputenc}
\usepackage[english,russian]{babel}

\newcommand{\sa}{synchronizing automata}
\newcommand{\san}{synchronizing automaton}
\newcommand{\sw}{reset word}
\newcommand{\sws}{reset words}
\newcommand{\ssw}{reset word of minimum length}
\newcommand{\rl}{reset length}

\DeclareMathOperator{\weight}{wg}

\DeclareSymbolFont{rsfscript}{OMS}{rsfs}{m}{n}
\DeclareSymbolFontAlphabet{\mathrsfs}{rsfscript}

\newcommand{\hm}[1]{#1\nobreak\discretionary{}{\hbox{\ensuremath{#1}}}{}}
\newcommand{\qqed}{\hfill$\Box$}

\newtheorem{theorem}{Теорема}
\newtheorem{cor}{Следствие}
\newtheorem{prop}{Предложение}
\newtheorem{lemma}{Лемма}

\renewenvironment{proof}{\trivlist\item[\hskip\labelsep{\bf
Доказательство}.] }{\qqed\endtrivlist}

\newtheorem{conjecture}{Гипотеза}

\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% {\normalsize УДК 519.713.4+519.172.3}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\title[Примитивные орграфы с большими экспонентами]{
 Примитивные орграфы с большими экспонентами\\ и медленно синхронизируемые
автоматы}


\author{Д. С. Ананичев,  М. В. Волков,  В. В. Гусев}
\thanks{Авторы получали
поддержку РФФИ по гранту 10-01-00793. Третий автор был также поддержан
программой Erasmus Mundus Action 2 Partnerships -- Triple I}

\date{}
\maketitle



\begin{abstract}
Мы приводим несколько бесконечных серий синхронизируемых автоматов, для каждого
из которых  длина кратчайшего синхронизирующего слова близка к квадрату числа
состояний. Все эти автоматы тесно связаны с примитивными ориентированными
графами с большими экспонентами.
\end{abstract}

\section*{{\centerline{\large\bf \S1. Постановка задачи и структура работы}}}

Данная работа выросла из попытки теоретически объяснить результаты некоторых численных экспериментов по синхронизации конечных
автоматов\footnote{Предварительное сообщение о части результатов этой работы опубликовано в~\cite{AGV10}.}.  Напомним, что
(\emph{детерминированным конечным}) \emph{автоматом} называется тройка $\mathrsfs{A}=\langle Q,\Sigma,\delta\rangle$, где $Q$ -- конечное
\emph{множество состояний}, $\Sigma$ -- конечный \emph{входной алфавит}, а $\delta:Q\times\Sigma\to Q$ -- всюду определенная \emph{функция
переходов}. Как обычно, через $\Sigma^*$ обозначаем множество всех конечных слов в алфавите $\Sigma$,
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% над алфавитом -- это "калька" с английского "over alphabet"?
%% у Маркова и в Математической энциклопедии -- "слово в алфавите"
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
включая пустое слово 1. Функция $\delta$ естественным образом
продолжается на $Q\times\Sigma^*$: для $q\in Q$ и $w\in\Sigma^*$ полагаем
$\delta(q,w)=q$, если $w=1$, и $\delta(q,w)=\delta(\delta(q,v),a)$, если $w=va$
для некоторого $v\in\Sigma^*$ и $a\in\Sigma$. Таким образом, функция $\delta$
определяет действие каждого слова из $\Sigma^*$ на множестве $Q$.

Автомат $\mathrsfs{A}=\langle Q,\Sigma,\delta\rangle$ называется
\emph{синхронизируемым}, если найдется слово $w\in\Sigma^*$, под действием
которого все состояния переходят в одно: $\delta(q,w)=\delta(q',w)$ для всех
$q,q'\in Q$. Всякое такое слово $w$ называется \emph{синхронизирующим} для
$\mathrsfs{A}$. Минимум длин синхронизирующих слов автомата $\mathrsfs{A}$
называется его \emph{порогом синхронизации}.

Синхронизируемые автоматы представляют собой очень простую и естественную
модель систем, устойчивых к ошибкам. Они используются во многих прикладных
областях (тестирование систем и протоколов, кодирование информации, роботика) и
в то же время неожиданным образом возникают в некоторых разделах
фундаментальной математики (символическая динамика, теория подстановочных
систем и др.). Основы теории синхронизируемых автоматов и ее разнообразные
связи и приложения обсуждаются, например, в недавних обзорах~\cite{Sa05,Vo08}.
В данной работе затрагивается только один аспект этой теории, а именно, вопрос
о том, как зависит порог синхронизации автомата от числа его состояний.

Условимся для краткости называть автомат с $n$ состояниями $n$-\emph{ав\-то\-ма\-том}. В~1964 г.\ Черни~\cite{Ce64} указал серию
синхронизируемых $n$-автоматов с порогом синхронизации $(n-1)^2$. Немного позднее он высказал предположение, что автоматы из этой серии
реализуют наихудший (в смысле скорости синхронизации) случай, т.\,е. что каждый синхронизируемый $n$-автомат может быть синхронизирован
словом длины не более $(n-1)^2$. За этим предположением закрепилось имя \emph{гипотеза Черни}. Несмотря на простоту формулировки и усилия
многочисленных исследователей, гипотеза Черни остается недоказанной и неопровергнутой уже более 45 лет. Более того, до сих пор нет верхней
оценки порядка $O(n^2)$
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Почему \Theta(n^2), а не  O(n^2)?
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
на порог
синхронизации произвольного $n$-автомата\footnote{На сегодняшний день лучшей
верхней оценкой на порог синхронизации произвольного $n$-автомата остается
оценка $\frac{n^3-n}6$, полученная Пэном~\cite{Pi83} еще в 1983 г. Чуть лучшая
оценка $\frac{n(7n^2+6n-16)}{48}$ опубликована недавно в~\cite{Tr11}, но в ее
доказательстве имеется неясное место.}.

Почему гипотеза Черни оказывается столь неприступной? Развернутое обсуждение
этого важного вопроса выходит за рамки данной работы, но одно из затруднений, с
которым приходится сталкиваться в теории синхронизируемых автоматов, здесь
уместно обозначить. Мы имеем в виду дефицит примеров \emph{экстремальных}
автоматов, т.\,е.\ $n$-автоматов с порогом синхронизации $(n-1)^2$.
Единственной известной на сегодня бесконечной серией экстремальных автоматов
остается серия, приведенная в~\cite{Ce64}. Кроме нее, известно лишь несколько
спорадических примеров экстремальных автоматов, наибольшим из которых по числу
состояний является 6-автомат, открытый Кари~\cite{Ka01} в 2001 г. (Полный
список известных экстремальных автоматов см.\ в~\cite{Vo08}.) Более того, до
сих пор даже $n$-автоматы с порогом синхронизации, близким к $(n-1)^2$,
встречались в литературе крайне редко -- кроме серии Черни, здесь можно назвать
только серии из~\cite{AVZ}. В условиях, когда число примеров крайне ограничено,
трудно было подвергать проверке различные предположения и допущения,
возникавшие при поисках подходов к гипотезе Черни. Именно поэтому история
исследований в данной области богата <<ложными следами>> -- вспомогательными
гипотезами, которые сперва казались перспективными, но по прошествии некоторого
времени опровергались. (Ряд таких <<ложных следов>> проанализирован
в~\cite{Be11}.)

Как же находить медленно синхронизируемые автоматы? Эксперименты (см.,
например, \cite{ST11}) показывают, что взятый наугад автомат с вероятностью,
очень близкой к~1, синхронизируем словом, длина которого значительно меньше
числа состояний. Поэтому случайно натолкнуться на автомат, порог синхронизации
которого близок к квадрату числа состояний, невозможно. Приходится выявлять
такие автоматы путем исчерпывающего перебора. Именно такой переборный
эксперимент и послужил отправной точкой данной работы.

Методика и некоторые результаты эксперимента описаны в \S2. Наше внимание
привлекло сходство между наблюдаемым поведением количества синхронизируемых
автоматов с фиксированным числом состояний как фун\-кции от значения порога
синхронизации и хорошо изученным поведением количества примитивных орграфов с
фиксированным числом вершин как функции от значения экспоненты. В \S3 мы
обсуждаем это сходство, предварительно напомнив необходимые понятия и факты из
теории примитивных орграфов. Основные результаты работы содержатся в \S4. Мы
показываем, что медленно синхронизируемые автоматы, обнаруженные в нашем
эксперименте, являются представителями бесконечных серий и что каждая такая
серия тесно связана с некоторой известной серией примитивных орграфов с большой
экспонентой. Установленная связь между орграфами и автоматами позволила дать
прозрачные и единообразные доказательства утверждений о пороге синхронизации
для всех без исключения серий медленно синхронизируемых автоматов -- как для
серий, уже встречавшихся в литературе, так и для серий, впервые появившихся в
данной работе. Техника, примененная в этих доказательствах, насколько нам
известно, является новой и, на наш взгляд, представляет самостоятельный
интерес. В заключительном \S5 обсуждаются дальнейшие перспективы подхода,
развитого в работе, и формулируется ряд новых гипотез.

\section*{{\centerline{\large\bf \S2. Методика и некоторые результаты эксперимента}}}

Как отмечено в \S1, поиск автоматов с порогом синхронизации, близким к квадрату
числа состояний, требует исчерпывающего перебора. Поскольку число $n$-автоматов
стремительно растет с ростом $n$, такой перебор должен быть разумным образом
организован. Так, задание 9-автомата с двумя входными буквами равносильно
заданию пары функций на 9-элементном множестве. Число таких пар равно
$9^{18}\approx 1.50\times 10^{17}$, и если потратить на вычисление порога
синхронизации каждого заданного таким образом автомата одну наносекунду, то
полный перебор займет около пяти лет. Понятно, что при задании $n$-автоматов с
$k$ входными буквами наборами из $k$ функций на $n$-элементном множестве каждый
автомат будет порождаться $n!k!$ раз. Однако ускорить процесс перебора за счет
отбрасывания изоморфных автоматов невозможно -- даже при $n=9$ и $k=2$ на
проверку того, изоморфен ли очередной автомат какому-либо из уже просмотренных,
не хватит ни времени, ни памяти.

Мы использовали для оптимизации перебора строковое представление достижимых
автоматов, предложенное в~\cite{AMR}. Напомним, что автомат
$\mathrsfs{A}=\langle Q,\Sigma,\delta\rangle$ называется \emph{достижимым} (из
состояния $q_0$), если из $q_0$ можно попасть в любое наперед заданное
состояние, применив подходящее слово: для любого $q\in Q$ существует
$w\in\Sigma^*$ такое, что $q=\delta(q_0,w)$. Автомат, достижимый из каждого
своего состояния, называется \emph{сильно связным}. В общем случае
синхронизируемый автомат может не быть достижимым и тем более сильно связным.
Однако хорошо известно, что в рассмотрениях, связанных с гипотезой Черни, можно
ограничиться сильно связными автоматами. Дело в том, что имеет место следующий
несложный результат.
\begin{prop}[\!\!{\mdseries\cite[предложение~2.1]{Vo09}}]
\label{reduction} Пусть $\mathrsfs{A}=\langle Q,\Sigma,\delta\rangle$ --
синхронизируемый автомат, а $S$ -- множество тех состояний, к которым
$\mathrsfs{A}$ можно синхронизировать. Тогда $\mathrsfs{S}=\langle
S,\Sigma,\delta|_S\rangle$ -- сильно связный подавтомат в $\mathrsfs{A}$ и  для
любой функции $f:\mathbb{Z}^+\to\mathbb{N}$, удовлетворяющей неравенствам
$$f(n)\ge\frac{n(n-1)}2\ \text{ и }\ f(n)\ge f(n-m+1)+f(m) \text{ при } n\ge m\ge 1,$$
из того, что порог синхронизации автомата $\mathrsfs{S}$
ограничен числом $f(|S|)$, вытекает, что порог синхронизации для $\mathrsfs{A}$
не превосходит $f(|Q|)$.
\end{prop}
В частности, беря в качестве $f(n)$ функцию $(n-1)^2$, можно заключить, что
если $\mathrsfs{A}$ -- контрпример к гипотезе Черни, то и его сильно связный
подавтомат $\mathrsfs{S}$ необходимо будет контрпримером. Аналогично, если
$\mathrsfs{A}$ -- автомат с порогом синхронизации, близким к квадрату числа
состояний, то таков и сильно связный автомат $\mathrsfs{S}$. Таким образом,
ограничивая перебор достижимыми автоматами, мы не рискуем пропустить
контрпример к~гипотезе Черни или какой-нибудь интересный медленно
синхронизируемый автомат.

Опишем теперь строковое представление из~\cite{AMR}. Пусть $\mathrsfs{A} =
\langle Q, \Sigma, \delta\rangle$ -- автомат, достижимый из состояния $q_0$.
Зафиксируем некоторый линейный порядок на входном алфавите $\Sigma$ и обойдем
автомат поиском в ширину из $q_0$, выбирая исходящие переходы в соответствии с
этим порядком. Присвоим состоянию $q_0$ номер 0, а остальные состояния из $Q$
пронумеруем в порядке их посещения при указанном обходе. Например, состояния
автомата на рис.~\ref{fig:AMR} при алфавитном упорядочении входных букв $a<b<c$
и выборе состояния $A$ в качестве $q_0$ будут пронумерованы так:
\begin{tabular}{c|c|c|c}
$A$ & $B$ & $C$ & $D$\\
\hline 0 & 2 & 1& 3\end{tabular}\,.

\begin{figure}[ht]
\begin{center}
\unitlength .8mm
\begin{picture}(84,45)(0,-60)
\gasset{Nw=11.0,Nh=11.0,Nmr=5.5}
\node[iangle=90.0,ilength=6.0,Nmarks=i](n1)(23.99,-24.0){$A$}
\node(n2)(60.49,-24.25){$C$} \node(n3)(59.9,-56.18){$D$}
\node(n6)(25.06,-56.08){$B$} \drawloop[loopangle=180.0](n1){$c$}
\drawloop[loopangle=0.0](n3){$b$} \drawloop[loopangle=180.0](n6){$c$}
\drawedge[curvedepth=3.6](n1,n2){$a$} \drawedge[curvedepth=3.6](n2,n1){$c$}
\drawedge[ELside=r,curvedepth=-3.6](n3,n2){$a$}
\drawedge[ELside=r,curvedepth=-3.6](n2,n3){$b$}
\drawedge[ELside=r,curvedepth=-3.6](n6,n1){$b$}
\drawedge[ELside=r,curvedepth=-3.6](n1,n6){$b$}
\drawedge[curvedepth=3.6](n6,n3){$a$} \drawedge[curvedepth=3.6](n3,n6){$c$}
\drawedge(n2,n6){$a$}
\end{picture}
\caption{Автомат с канонической строкой
$[1,2,0,2,3,0,3,0,2,1,3,2]$}\label{fig:AMR}
\end{center}
\end{figure}

\noindent Каждому состоянию $q$ автомата $\mathrsfs{A}$ поставим в соответствие строку длины
$|\Sigma|$, в которой на позиции $i$ стоит порядковый номер того состояния, в
которое $q$ переходит под действием $i$-й буквы. Соединив все такие строки в
порядке возрастания номеров состояний, получим строку чисел из множества
$\{0,1,\dots,|Q|-1\}$, которая имеет длину $|Q||\Sigma|$ и однозначно
определяет $\mathrsfs{A}$. Мы будем называть ее \emph{канонической строкой}
автомата $\mathrsfs{A}$. Так, для автомата на рис.~\ref{fig:AMR} каноническая
строка имеет вид $[1,2,0,2,3,0,3,0,2,1,3,2]$.

Несложно проверить (см.~\cite[теорема~5]{AMR}), что строка
$[s_0,\dots,s_{nk-1}]$ чисел из множества $\{0,1,\dots,n-1\}$ будет
канонической строкой некоторого достижимого $n$-автомата с $k$ входными буквами
тогда и только тогда, когда она удовлетворяет двум условиям:
\begin{enumerate}
\item[(R1)] для каждого $i$ такого, что $s_i>1$, найдется такое $j<i$, что $s_j = s_i-1$,
\item[(R2)] для каждого $m$ такого, что $1{\le}m{<}n$, найдется такое $j{<}mk$,
что $s_j=m$.
\end{enumerate}

Опираясь на это наблюдение, мы вычисляли пороги синхронизации для достижимых
$n$-автоматов с двумя входными буквами следующим образом. Для вычислений
использовался 128-ядерный кластер на базе процессоров AMD Opteron с тактовой
частотой 2.6 ГГц. Кластер, принадлежащий Институту математики и механики УрО
РАН, работает под управлением ОС Linux, имеет 256 ГБ оперативной памяти и
пиковую производительность 665.6 Гфлопс. Один узел кластера генерировал
относительно небольшие порции строк, удовлетворяющих (R1) и (R2), и раздавал
остальным узлам, которые обрабатывали соответствующие порции автоматов
параллельно. Для организации данного процесса использовалась известная
библиотека MPI. Проверка каждого автомата на синхронизируемость и вычисление
порога синхронизации производились с помощью стандартных алгоритмов
(см.~\cite{Sa05,Vo08}). Оба этих алгоритма были реализованы на C. Отметим, что
алгоритм проверки синхронизируемости очень быстр, так как работает с орграфом
пар состояний, в то время как алгоритм вычисления порога синхронизации работает
с орграфом непустых подмножеств состояний и в наихудшем случае время его работы
экспоненциально зависит от размера исходного автомата\footnote{Известно
(см.~\cite[теорема~4]{OU10}), что задача вычисления порога синхронизации
данного автомата полна для класса сложности $\mathsf{FP}^\mathsf{NP[log]}$ --
функционального аналога класса $\mathsf{P}^\mathsf{NP[log]}$ задач
распознавания, разрешимых за полиномиальное время на детерминированной машине
Тьюринга, которая может логарифмическое от размера задачи число раз обращаться
за подсказкой к оракулу для $\mathsf{NP}$-полной задачи.}. Однако на практике
порог синхронизации вычисляется довольно быстро, поскольку, как отмечалось в
\S1, для подавляющего большинства автоматов он мал.

Хотя задание автоматов с помощью канонических строк существенным образом
сокращает перебор (нетрудно понять, например, что при таком задании каждый
$n$-автомат с двумя входными буквами порождается не более $2n$ раз), его объем
все равно остается значительным. Так, при $n=9$ число автоматов, которые
пришлось проанализировать, составило 705\,068\,085\,303.  Тем не менее,
благодаря распараллеливанию, вычисления при $n=9$ заняли меньше суток.

Результатом вычислений являлся массив, в котором для каждого встретившегося
значения порога синхронизации указывалось число автоматов, реализующих это
значение. Наиболее значимая для нас часть результатов, относящаяся к медленно
синхронизируемым автоматам, была затем перепроверена с помощью пакета
TESTAS~\cite{Tr06}.

Табл.~\ref{automata} содержит фрагмент массива результатов, полученных в случае
$n=9$. Количество автоматов в ней указано с точностью до изоморфизма.
\begin{table}[ht]
%\extrarowheight=1pt
\tabcolsep=4.8pt \caption{Пороги синхронизации 9-автоматов
с двумя входными буквами} \label{automata} {\tiny
\begin{tabular}{||l|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
\hline
%ing{$N$} & 64 & 63 & 62 & 61 & 60 & 59 & 58 & 57 & 56 & 55 & 54 & 53 & 52 & 51 \\
\hline \parbox{20mm}{\centering{$N$}} & 64 & 63 & 62 & 61 & 60 & 59 & 58 & 57 & 56 & 55 & 54 & 53 & 52 & 51 \\
\hline \parbox{20mm}{Число автоматов с порогом синхронизации~$N$}
 &{1} &{0} &{0}
&{0} &{0} &{0}
&{1} &{2} &{3}
&{0} &{0} &{0}
&{4} &{4} \\
\hline
\end{tabular}}
\end{table}

Понятно, что единственный автомат в столбце, отвечающем $N=64$, -- это
9-автомат из серии Черни. Далее наблюдается разрыв: 9-автоматов с двумя
входными буквами и значением порога синхронизации от 59 до 63 не существует.
Данный разрыв уже упоминался в работах Трахтмана~\cite{Tr06,Tr06a}, где
отмечалось, что при $n=7,8,9,10$ его эксперименты не обнаружили ни одного
$n$-автомата с двумя входными буквами, порог синхронизации которого был бы
больше $n^2-3n+4$, но меньше $n^2-2n+1$. За разрывом следует <<остров>> из трех
значений, достигаемых на 6 автоматах, а за этим <<островом>> снова наблюдается
разрыв. Этот второй разрыв, насколько нам известно, ранее не отмечался в
литературе.

Описанное только что поведение исследуемой величины -- одинокое экстремальное
значение, за которым следуют разрыв, небольшой <<остров>> и еще один разрыв --
проявляется и для автоматов с б\'ольшим числом состояний. При этом размеры
<<острова>> зависят только от четности числа состояний, а размеры разрывов
растут вместе c числом состояний как линейные функции. Сходным образом ведет
себя другая величина, исследовавшаяся в дискретной математике, -- количество
примитивных орграфов с фиксированным числом вершин и данным значением
экспоненты. В следующем параграфе мы напомним соответствующие понятия и обсудим
указанное сходство подробнее.

\section*{{\centerline{\large\bf \S3. Примитивные орграфы и их экспоненты}}}

\emph{Орграф} (т.\,е. ориентированный граф) -- это пара $D=\langle V,E\rangle$,
где $V$ -- конечное множество и $E\subseteq V\times V$. Элементы множеств $V$ и
$E$ будем называть соответственно \emph{вершинами} и \emph{дугами}. Отметим,
что данное определение допускает петли, но исключает кратные дуги. Если
$v,v'\in V$ и $e=(v,v')\in E$, то дуга $e$ называется \emph{исходящей} из $v$.
Мы предполагаем, что читатель знаком с основными понятиями теории орграфов,
такими как маршрут (ориентированный путь), контур (ориентированный цикл),
изоморфизм и~т.\,д.

\emph{Матрица смежности} (или просто матрица) орграфа $D=\langle V,E\rangle$ --
это $V\times V$-матрица, в которой элемент в строке $v$ и столбце $v'$ равен 1,
если $(v,v')\in E$, и равен 0 в противном случае. Обратно, $n\times n$-матрице
$P=(p_{ij})$ с неотрицательными действительными элементами можно поставить в соответствие
орграф $D(P)$ на множестве $\{1,2,\dots,n\}$, в котором пара $(i,j)$ будет
дугой, если и только если $p_{ij}>0$. Указанное соответствие между матрицами и
орграфами позволяет переформулировать на языке орграфов ряд важных понятий и
результатов, возникших в классической теории неотрицательных матриц (теории
Перрона--Фробениуса).

Орграф $D=\langle V,E\rangle$ называется  \emph{сильно связным}, если для
всякой пары $(v,v')\in V\times V$ найдется маршрут из $v$ в $v'$. Сильно
связный орграф $D$ называется \emph{примитивным}, если наибольший общий
делитель длин всех контуров в $D$ равен~1. В литературе такие орграфы иногда
называют \emph{апериодическими}. Наш выбор термина обусловлен тем, что орграф
обладает указанным свойством тогда и только тогда, когда его матрица примитивна
в смысле теории Перрона--Фробениуса, т.\,е.\ когда у этой матрицы есть
положительное собственное значение, строго большее модуля любого из ее
остальных собственных значений.

Под $t$-й \emph{степенью} орграфа $D=\langle V,E\rangle$ понимается орграф
$D^t$ с тем же множеством вершин $V$, в котором пара $(v,v')\in V\times V$
является дугой, если и только если в $D$ найдется маршрут из $v$ в $v'$ длины в
точности $t$. Нетрудно видеть, что если $M$ -- матрица орграфа $D$, то орграф
$D^t$ изоморфен орграфу $D(M^t)$, где $M^t$ -- обычная $t$-я степень матрицы
$M$. Известно (см., например, \cite[с.\,226]{ST00}), что если $D$ --
примитивный орграф, то для некоторого $t$ его степень $D^t$ есть полный орграф
с петлями, т.\,е.\ в $D^t$ все пары вершин являются дугами. На языке матрицы
орграфа это означает, что каждый элемент матрицы $M^t$ положителен. Наименьшее
число $t$ с таким свойством называется \emph{экспонентой} орграфа $D$ и
обозначается через $\gamma(D)$. Экспоненты орграфов служат объектом
интенсивного изучения на протяжении последних 60 лет, обзор накопленных в этой
области фактов см., например, в~\cite{Br}. В данной работе потребуются лишь
несколько классических результатов, собранных в следующем утверждении.Здесь и
далее в работе орграф с $n$ вершинами для краткости именуется
$n$-\emph{орграфом}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% В следующей теореме надо навести единообразие -- либо везде, либо нигде не указывать авторство.
%%% в пункте (а) указать теорему, как в остальных
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{theorem}
\label{dulmage} \emph{(a) (Теорема Виландта, см.\ \cite{Wi50,DM62,DM64})} Если
$D$ -- примитивный $n$-орграф, то $\gamma(D)\le(n-1)^2+1$.

\emph{(b) \cite[теорема~6 и следствие~4]{DM64}} Если $n>2$, то с точностью до
изоморфизма есть ровно один примитивный $n$-орграф с экспонентой $(n-1)^2+1$ и
ровно один примитивный $n$-орграф с с экспонентой $(n-1)^2$. Матрицы этих
орграфов суть соответственно
\begin{equation}
\label{wielandt}
\begin{pmatrix}
0 & 1 & 0 & \dots & 0 & 0\\
0 & 0 & 1 & \dots & 0 & 0\\
\hdotsfor{6}\\
0 & 0 & 0 & \dots & 0 & 1\\
1 & 1 & 0 & \dots & 0 & 0
\end{pmatrix} \text{ и }
\begin{pmatrix}
0 & 1 & 0 & \dots & 0 & 0\\
0 & 0 & 1 & \dots & 0 & 0\\
\hdotsfor{6}\\
1 & 0 & 0 & \dots & 0 & 1\\
1 & 1 & 0 & \dots & 0 & 0
\end{pmatrix}.
\end{equation}

\emph{(c) \cite[теорема~7]{DM64}} Если $n>4$ и $n$ четно, то нет ни одного
примитивного $n$-орграфа $D$, для которого $n^2-4n+6<\gamma(D)<(n-1)^2$. С
точностью до изоморфизма существуют ровно три, если $n$ кратно трем, или ровно
четыре, если $n$ не кратно трем, примитивных $n$-орграфа с экспонентой
$n^2-4n+6$.

\emph{(d) \cite[теорема~8]{DM64}} Если $n>3$ и $n$ нечетно, то нет ни одного
примитивного $n$-орграфа $D$, для которого $n^2-3n+4<\gamma(D)<(n-1)^2$. С
точностью до изоморфизма есть ровно один примитивный $n$-орграф с экспонентой
$n^2-3n+4$, ровно один примитивный $n$-орграф с экспонентой $n^2-3n+3$, и ровно
два примитивных $n$-орграфа с экспонентой $n^2-3n+2$. Матрицы этих орграфов
суть соответственно
\begin{gather}
\label{odd island}
\begin{pmatrix}
0 & 1 & 0 & \dots & 0 & 0\\
0 & 0 & 1 & \dots & 0 & 0\\
\hdotsfor{6}\\
0 & 0 & 0 & \dots & 1 & 0\\
0 & 0 & 0 & \dots & 0 & 1\\
1 & 0 & 1 & \dots & 0 & 0
\end{pmatrix},\quad
\begin{pmatrix}
0 & 1 & 0 & \dots & 0 & 0\\
0 & 0 & 1 & \dots & 0 & 0\\
\hdotsfor{6}\\
0 & 0 & 0 & \dots & 1 & 0\\
0 & 1 & 0 & \dots & 0 & 1\\
1 & 0 & 1 & \dots & 0 & 0
\end{pmatrix},\\
\label{odd island1}
\begin{pmatrix}
0 & 1 & 0 & \dots & 0 & 0\\
0 & 0 & 1 & \dots & 0 & 0\\
\hdotsfor{6}\\
1 & 0 & 0 & \dots & 1 & 0\\
0 & 1 & 0 & \dots & 0 & 1\\
1 & 0 & 1 & \dots & 0 & 0
\end{pmatrix}, \quad
\begin{pmatrix}
0 & 1 & 0 & \dots & 0 & 0\\
0 & 0 & 1 & \dots & 0 & 0\\
\hdotsfor{6}\\
1 & 0 & 0 & \dots & 1 & 0\\
0 & 0 & 0 & \dots & 0 & 1\\
1 & 0 & 1 & \dots & 0 & 0
\end{pmatrix}.
\end{gather}

\emph{(e) \cite[теорема~8]{DM64}} Если $n>3$ и $n$ нечетно, то нет ни одного
$n$-орграфа $D$, для которого $n^2-4n+6<\gamma(D)<n^2-3n+2$. С точностью до
изоморфизма существуют ровно три, если $n$ кратно трем, или ровно четыре, если
$n$ не кратно трем, примитивных $n$-орграфа с экспонентой $n^2-4n+6$.
\end{theorem}

В табл.~\ref{9 states} экспериментальные данные из табл.~\ref{automata}
сопоставлены с информацией, которую можно извлечь из теоремы~\ref{dulmage}.

\begin{table}[ht]
\tabcolsep=4.2pt
%\extrarowheight=1pt
\caption{Экспоненты примитивных 9-орграфов
и пороги синхронизации 9-автоматов с двумя входными буквами} \label{9 states}
{\tiny
\begin{tabular}{|p{1.9cm}||c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|} \hline
\centering{$N$} & 65 & 64 & 63 & 62 & 61 & 60 & 59 & 58 & 57 & 56 & 55 & 54 & 53 & 52 & 51 \\
\hline %\raggedright
{Число орграфов с экспонентой~$N$} & \raisebox{-6pt}{1} &
\raisebox{-6pt}{1} & \raisebox{-6pt}{0} & \raisebox{-6pt}{0} &
\raisebox{-6pt}{0} & \raisebox{-6pt}{0} & \raisebox{-6pt}{0} &
\raisebox{-6pt}{1} & \raisebox{-6pt}{1} & \raisebox{-6pt}{2}
& \raisebox{-6pt}{0} & \raisebox{-6pt}{0} & \raisebox{-6pt}{0} & \raisebox{-6pt}{0} & \raisebox{-6pt}{3} \\
\hline %\raggedright
{Число автоматов с порогом синхронизации~$N$}
&\raisebox{-11pt}{0} &\raisebox{-11pt}{1} &\raisebox{-11pt}{0}
&\raisebox{-11pt}{0} &\raisebox{-11pt}{0} &\raisebox{-11pt}{0}
&\raisebox{-11pt}{0} &\raisebox{-11pt}{1} &\raisebox{-11pt}{2}
&\raisebox{-11pt}{3}
&\raisebox{-11pt}{0} &\raisebox{-11pt}{0} &\raisebox{-11pt}{0} &\raisebox{-11pt}{4} &\raisebox{-11pt}{4} \\
\hline
\end{tabular}}
\end{table}

Сходство между второй и третьей строками табл.~\ref{9 states} очевидно.
Аналогичное сходство проявляется при сравнении данных для других размеров
автоматов/орграфов. Нам представляется, что обнаруженное сходство не случайно,
а напротив, отражает глубокие и, возможно, еще не до конца проясненные
взаимосвязи между примитивными орграфами и синхронизируемыми автоматами.
Некоторые из этих взаимосвязей были вскрыты при изучении так называемой
проблемы раскраски дорог. Напомним соответствующие понятия.

\emph{Орграфом} автомата $\mathrsfs{A}=\langle Q,\Sigma,\delta\rangle$ будем
называть орграф $D(\mathrsfs{A})$ со множеством вершин $Q$, в котором дугами
служат все такие пары $(q,q')\in Q\times Q$, что $q'=\delta(q,a)$ для некоторой
буквы $a\in\Sigma$. Легко видеть, что орграф $D$ изоморфен орграфу некоторого
автомата тогда и только тогда, когда любая вершина $D$ имеет хотя бы одну
исходящую дугу. В дальнейшем мы всегда будем предполагать, что рассматриваемые
орграфы удовлетворяют этому условию. Если $D$ -- орграф, то его
\emph{раскраской} называется всякий автомат $\mathrsfs{A}$ со свойством $D\cong
D(\mathrsfs{A})$. Любая раскраска орграфа $D=\langle V,E\rangle$ получается,
если зафиксировать некоторый конечный алфавит $\Sigma$ и приписать каждой дуге
из $E$ непустое множество букв из $\Sigma$ так, чтобы для каждой вершины $v\in
V$ множества, приписанные исходящим из $v$ дугам, составляли разбиение алфавита
$\Sigma$. На рис.\,\ref{fig:cerny} изображен орграф и две его раскраски при
помощи алфавита $\Sigma=\{a,b\}$.

\begin{figure}[ht]
 \begin{center}
  \unitlength=1.8pt
    %\begin{picture}(18,30)(-65,-4)
    {\scriptsize
    \begin{picture}(18,30)(-85,-4)
    \gasset{Nw=6,Nh=6,Nmr=3}
    \node(A1)(0,18){$1$}
    \node(A2)(18,18){$2$}
    \node(A3)(18,0){$3$}
    \node(A4)(0,0){$4$}
    \drawloop[loopangle=135](A1){$a$}
    \drawloop[loopangle=45](A2){$b$}
    \drawloop[loopangle=-45](A3){$b$}
    \drawedge(A1,A2){$b$}
    \drawedge(A2,A3){$a$}
    \drawedge(A3,A4){$a$}
    \drawedge(A4,A1){$a,b$}
    \end{picture}
 \begin{picture}(18,30)(0,-4)
    \gasset{Nw=6,Nh=6,Nmr=3}
    \node(A1)(0,18){$1$}
    \node(A2)(18,18){$2$}
    \node(A3)(18,0){$3$}
    \node(A4)(0,0){$4$}
    \drawloop[loopangle=135](A1){$a$}
    \drawloop[loopangle=45](A2){$a$}
    \drawloop[loopangle=-45](A3){$a$}
    \drawedge(A1,A2){$b$}
    \drawedge(A2,A3){$b$}
    \drawedge(A3,A4){$b$}
    \drawedge(A4,A1){$a,b$}
    \end{picture}
 \begin{picture}(18,30)(85,-4)
    \gasset{Nw=6,Nh=6,Nmr=3}
    \node(A1)(0,18){$1$}
    \node(A2)(18,18){$2$}
    \node(A3)(18,0){$3$}
    \node(A4)(0,0){$4$}
    \drawloop[loopangle=135](A1){}
    \drawloop[loopangle=45](A2){}
    \drawloop[loopangle=-45](A3){}
    \drawedge(A1,A2){}
    \drawedge(A2,A3){}
    \drawedge(A3,A4){}
    \drawedge(A4,A1){}
    \end{picture}
    }
 \end{center}
 \caption{Орграф и две его раскраски}
 \label{fig:cerny}
\end{figure}

Еще в 1977 г.\ Адлер, Гудвин и Вейс~\cite{AGW} отметили, что орграф каждого
сильно связного синхронизируемого автомата примитивен, и предположили,  что
каждый примитивный орграф имеет синхронизируемую раскраску -- в этом и состояла
гипотеза раскраски дорог, недавно доказанная Трахтманом~\cite{Tr09}. Нетрудно
указать и соотношение между порогом синхронизации сильно связного
синхронизируемого автомата и экспонентой его орграфа.

\begin{prop}
\label{lower bound} Пусть $\mathrsfs{A}=\langle Q,\Sigma,\delta\rangle$ --
сильно связный синхронизируемый $n$-автомат с порогом синхронизации $t$. Тогда
\begin{equation}
\label{eq:lower bound} \gamma(D(\mathrsfs{A}))\le t+n-1.
\end{equation}
\end{prop}

\begin{proof}
Пусть $w\in\Sigma^*$ -- синхронизирующее слово длины $t$ и пусть $p$ -- то
состояние, к которому $w$ синхронизирует автомат $\mathrsfs{A}$, т.\,е.
$\delta(q,w)=p$ для всех $q\in Q$. Возьмем теперь произвольную пару
$(q',q'')\in Q\times Q$ и укажем в орграфе $D(\mathrsfs{A})$ маршрут из $q'$ в
$q''$ длины в точности $t+n-1$. Поскольку орграф $D(\mathrsfs{A})$ сильно
связен, в нем существует маршрут из $p$ в $q''$. Пусть $\ell$ -- минимальная
длина такого маршрута. Так как маршрут минимальной длины не проходит ни через
одну вершину дважды, $\ell\le n-1$. Рассмотрим теперь произвольный маршрут
длины $n-1-\ell$, начинающийся из $q'$. Из конечной вершины этого маршрута
пройдем по маршруту длины $t$, вдоль которого в автомате $\mathrsfs{A}$
читается слово $w$. Поскольку $w$ -- синхронизирующее слово, такой маршрут
необходимо окончится в $p$. Теперь осталось пройти по маршруту  длины $\ell$ из
$p$ в $q''$, чтобы получить маршрут из $q'$ в $q''$ длины
$(n-1-\ell)+t+\ell=t+n-1$.
\end{proof}

Таким образом, раскраски примитивных орграфов с~большими экспонентами приводят
к автоматам с большими порогами синхронизации. Это наблюдение, однако, еще не
достаточно для того, чтобы полностью объяснить сходство между строками
табл.~\ref{9 states}, поскольку далеко не все автоматы, отвечающие ненулевым
позициям в третьей строке, могут быть получены как раскраски примитивных
орграфов с~большими экспонентами. В \S4 мы укажем еще один способ получения
медленно синхронизируемых автоматов из примитивных орграфов.

\section*{{\centerline{\large\bf \S4. Серии медленно синхронизируемых автоматов}}}

\paragraph*{4.1. Обзор.} Обсудим прежде всего, какими именно автоматами мы
интересуемся, другими словами, какой точный смысл вкладывается в выражения типа
<<медленно синхронизируемые автоматы>> или <<автоматы, с порогом синхронизации,
близким к квадрату числа состояний>>. Как отмечалось в \S1, порог синхронизации
$n$-автомата может достигать $(n-1)^2$ -- соответствующим примером служит
открытый Черни~\cite{Ce64} автомат $\mathrsfs{C}_n=\langle
\{1,2,\dots,n\},\{a,b\},\delta\rangle$, где буквы $a$ и $b$ действуют следующим
образом:
$$\delta(i,a)=\begin{cases}
i, &\text{если } i<n,\\
1, &\text{если } i=n;
\end{cases}\quad
\delta(i,b)=\begin{cases}
i+1, &\text{если } i<n,\\
1, &\text{если } i=n.
\end{cases}$$
Автомат $\mathrsfs{C}_n$ изображен слева на рис.\,\ref{fig:cerny-n}.
Нетрудно понять, что если к автомату $\mathrsfs{C}_{n-1}$ добавить новое
состояние $q_0$, а затем всевозможными способами доопределять действие букв $a$
и $b$ на этом новом состоянии так, чтобы хотя бы одна из них не фиксировала
$q_0$, то можно получить $n^2-1$ неизоморфных достижимых $n$-автоматов с
порогами синхронизации от $(n-2)^2$ до $(n-2)^2+1$. Аналогичным образом можно
<<размножать>> до семейств $n$-автоматов и другие $(n-1)$-автоматы с порогом
синхронизации, близким к $(n-2)^2$. Поскольку мы хотим избежать рассмотрения
таких более или менее тривиальных модификаций, наше внимание сосредоточено на
$n$-автоматах с порогом синхронизации, заключенным в пределах от $(n-2)^2+2$ до
$(n-1)^2$. (В частности, именно из этих соображений выбирался диапазон значений
порога синхронизации в табл.~\ref{automata} и~\ref{9 states}.)

Наши эксперименты показывают, что в указанных пределах автоматов не слишком
много и что их распределение по возможным значениям порога синхронизации
устойчиво следует такому образцу: изолированное экстремальное значение --
разрыв -- небольшой <<остров>> -- разрыв -- <<материк>>, см.
табл.~\ref{automata} и обсуждение в конце \S2. Мы продемонстрируем, что исходя
из примитивных орграфов с большими экспонентами, представленных в
теореме~\ref{dulmage}, можно построить следующие серии автоматов над
двухбуквенным алфавитом:
\begin{itemize}
\item серию $\mathrsfs{C}_n$, отвечающую наблюдаемому экстремальному значению;
\item серии $\mathrsfs{W}_n$, $\mathrsfs{D}'_n$, $\mathrsfs{D}''_n$,
$\mathrsfs{E}_n$, а при нечетном $n$ -- еще и серии $\mathrsfs{B}_n$ и
$\mathrsfs{F}_n$, отвечающие всем наблюдаемым <<островным>> значениям;
\item серии $\mathrsfs{G}_n$ (при нечетном $n$) и $\mathrsfs{H}_n$,
отвечающие максимальным наблюдаемым <<материковым>> значениям.
\end{itemize}
Рис.~\ref{fig:relation} показывает, из каких именно орграфов получаются
перечисленные серии. (Для наглядности на рис.~\ref{fig:relation} вместо матриц
из теоремы~\ref{dulmage} изображены <<типичные представители>> соответствующих
серий орграфов.) Если от символа орграфа к букве, обозначающей серию автоматов,
проведена сплошная стрелка, то автоматы серии получены раскраской
соответствующих орграфов; штриховая стрелка указывает на другой способ
получения автомата из орграфа. Пунктирной рамкой объединены серии автоматов с
одинаковым значением порога синхронизации.
\begin{figure}[h]
\begin{center}
\includegraphics[width=8cm]{relation.eps}
\unitlength 0.58mm
\begin{picture}(1,1)(2,0)
\put(-132,45){{$\mathrsfs{C}_n$}}
\put(-106,45){{$\mathrsfs{D}'_n$}} \put(-92,45){{$\mathrsfs{W}_n$}}
\put(-84,45){{$\mathrsfs{F}_n$}} \put(-71,45){{$\mathrsfs{E}_n$}}
\put(-64,45){{$\mathrsfs{D}''_n$}} \put(-54,45){{$\mathrsfs{B}_n$}}
\put(-23,45){{$\mathrsfs{G}_n$}} \put(-10,45){{$\mathrsfs{H}_n$}}
\put(-71,1){$\underbrace{\rule{4.07cm}{0pt}}_{\text{при нечетном $n$}}$}
\end{picture}
\caption{Связи между сериями примитивных орграфов с большими экспонентами и
сериями медленно синхронизируемых автоматов} \label{fig:relation}
\end{center}
\end{figure}

Итак, здесь мы докажем ряд утверждений о перечисленных на
рис.~\ref{fig:relation} сериях автоматов. (Два из этих утверждений -- о сериях
$\mathrsfs{C}_n$ и $\mathrsfs{B}_n$ -- встречались в литературе, но наши
доказательства являются существенно новыми.) Эти результаты будут объединены в
5 групп в соответствии с <<происхождением>> серий, т.\,е.\ с типом орграфов, из
которых получены автоматы серий.

\paragraph*{4.2. Автоматы, связанные с орграфами серии $W_n$.} Орграф $W_n$ -- это
$n$-орграф наибольшей экспоненты, отвечающий первой матрице в~\eqref{wielandt}.
Если обозначить вершины $W_n$ через $1,2,\dots,n$, то его дуги суть $(n,1)$,
$(n,2)$ и $(i,i+1)$ для $i=1,\dots,n-1$. Нетрудно видеть, что с точностью до
изоморфизма и переименования букв существует единственная раскраска орграфа
$W_n$ с помощью двух букв. Обозначим соответствующий автомат через
$\mathrsfs{W}_n$. Орграф $W_n$ и автомат $\mathrsfs{W}_n$ изображены на
рис.\,\ref{fig:anan}.

\begin{figure}[hb]
\begin{center}
\unitlength .5mm
\small
\begin{picture}(72,60)(20,-67)
\gasset{Nw=16,Nh=16,Nmr=8} \node(n0)(36.0,-16.0){1} \node(n1)(4.0,-40.0){$n$}
\node(n2)(68.0,-40.0){2} \node(n3)(16.0,-72.0){$n{-}1$}
\node(n4)(56.0,-72.0){3} \drawedge[ELdist=2.0](n1,n0){}
\drawedge[ELdist=1.5](n2,n4){} \drawedge[ELdist=1.7](n0,n2){}
\drawedge[ELdist=1.7](n3,n1){} \drawedge[ELdist=2.0](n1,n2){}
\put(31,-73){$\dots$}
\end{picture}
\begin{picture}(72,60)(-20,-67)
\gasset{Nw=16,Nh=16,Nmr=8}
\node(n0)(36.0,-16.0){1}
\node(n1)(4.0,-40.0){$n$} \node(n2)(68.0,-40.0){2}
\node(n3)(16.0,-72.0){$n{-}1$} \node(n4)(56.0,-72.0){3}
\drawedge[ELdist=2.0](n1,n0){$b$} \drawedge[ELdist=1.5](n2,n4){$a, b$}
\drawedge[ELdist=1.7](n0,n2){$a, b$}
\drawedge[ELdist=1.7](n3,n1){$a, b$} \drawedge[ELdist=2.0](n1,n2){$a$}
\put(31,-73){$\dots$}
\end{picture}
\end{center}
\caption{Орграф $W_n$ и автомат $\mathrsfs{W}_n$}\label{fig:anan}
\end{figure}

\begin{theorem}
\label{theorem:anan} Автомат $\mathrsfs{W}_n$ синхронизируем, и его порог
синхронизации равен $n^2-3n+3$.
\end{theorem}

\begin{proof}
Нетрудно проверить, что слово $(ab^{n-2})^{n-2}a$ синхронизирует автомат
$\mathrsfs{W}_n$. Длина этого слова равна $(n-1)(n-2)+1=n^2-3n+3$. С другой
стороны, из теоремы~\ref{dulmage}(b) и предложения~\ref{lower bound} вытекает,
что порог синхронизации для $\mathrsfs{W}_n$ не может быть меньше чем
$((n-1)^2+1)-(n-1)=n^2-3n+3$.
\end{proof}

Серия автоматов $\mathrsfs{W}_n$ была обнаружена первым автором данной работы
в~2008 г. Его первоначальное доказательство теоремы~\ref{theorem:anan}
использовало теоретико-игровую технику из~\cite{AVZ} и было весьма трудоемким.

Теперь продемонстрируем, что и серия автоматов $\mathrsfs{C}_n$ тесно (хотя и
менее очевидным образом) связана с орграфами из серии $W_n$. Отметим, что хотя
автоматы $\mathrsfs{C}_n$ известны уже около 50 лет и многократно
переоткрывались, их родство с орграфами из серии $W_n$ ранее, по-видимому, не
отмечалось.
\begin{figure}[th]
\begin{center}
\unitlength .5mm
\small
\begin{picture}(72,66)(25,-76)
\gasset{Nw=16,Nh=16,Nmr=8,loopdiam=10} \node(n0)(36.0,-16.0){1}
\node(n1)(4.0,-40.0){$n$} \node(n2)(68.0,-40.0){2}
\node(n3)(16.0,-72.0){$n{-}1$} \node(n4)(56.0,-72.0){3}
\drawedge[ELdist=2.0](n1,n0){$a,b$} \drawedge[ELdist=1.5](n2,n4){$b$}
\drawedge[ELdist=1.7](n0,n2){$b$} \drawedge[ELdist=1.7](n3,n1){$b$}
\drawloop[ELdist=1.5,loopangle=30](n2){$a$}
\drawloop[ELdist=2.4,loopangle=-30](n4){$a$}
\drawloop[ELdist=1.5,loopangle=-90](n0){$a$}
\drawloop[ELdist=1.5,loopangle=210](n3){$a$} \put(31,-73){$\dots$}
\end{picture}
\begin{picture}(72,66)(-25,-76)
\gasset{Nw=16,Nh=16,Nmr=8} \node(n0)(36.0,-16.0){1} \node(n1)(4.0,-40.0){$n$}
\node(n2)(68.0,-40.0){2} \node(n3)(16.0,-72.0){$n{-}1$}
\node(n4)(56.0,-72.0){3} \drawedge[ELdist=2.0](n1,n0){$b$}
\drawedge[ELdist=1.5](n2,n4){$b,c$} \drawedge[ELdist=1.7](n0,n2){$b,c$}
\drawedge[ELdist=1.7](n3,n1){$b,c$} \drawedge[ELdist=2.0](n1,n2){$c$}
\put(31,-73){$\dots$}
\end{picture}
\end{center}
\caption{Автомат $\mathrsfs{C}_n$ и автомат, определяемый действиями слов $b$ и
$c=ab$}\label{fig:cerny-n}
\end{figure}

Дадим новое простое доказательство классического результата Черни.
\begin{theorem}[\!\!{\mdseries\cite[лемма~1]{Ce64}}]
\label{theorem:cerny} Автомат $\mathrsfs{C}_n$ синхронизируем, и его порог
синхронизации равен $(n-1)^2$.
\end{theorem}

\begin{proof}
Легко проверить, что слово $(ab^{n-1})^{n-2}a$ синхронизирует автомат
$\mathrsfs{C}_n$. Длина этого слова равна $n(n-2)+1=(n-1)^2$.

Теперь воспользуемся следующим наблюдением, которое будет полезно и в других
доказательствах.

\begin{prop}
\label{prop:simple idempotent} Пусть $\mathrsfs{A}=\langle
Q,\{a,b\},\delta\rangle$ -- синхронизируемый $n$-авто\-мат с порогом
синхронизации $t$, в котором буква $a$ фиксирует все состояния, кроме ровно
одного, а буква $b$ действует как перестановка множества $Q$. Рассмотрим
автомат $\mathrsfs{B}=\langle Q,\{b,c\},\zeta\rangle$, в котором
$\zeta(q,b)=\delta(q,b)$ и $\zeta(q,c)=\delta(q,ab)$ для всех $q\in Q$. Тогда
автомат $\mathrsfs{B}$ синхронизируем, и его порог синхронизации не превосходит
$t-n+2$.
\end{prop}

\begin{proof}
Пусть $w$ -- некоторое синхронизирующее автомат $\mathrsfs{A}$ слово длины $t$.
Поскольку буква $b$ действует как перестановка множества $Q$, слово $w$ не
может оканчиваться на $b$ -- в противном случае, удалив последнюю букву из $w$,
мы получили бы более короткое синхронизирующее слово. Итак, $w=w'a$ для
некоторого слова $w'\in\{a,b\}^*$. Пусть $q_1\in Q$ -- то единственное
состояние, которое не фиксируется буквой $a$, и пусть $q_2=\delta(q_1,a)$. Из
минимальности длины слова $w$ вытекает, что образ множества $Q$ под действием
слова $w'$ равен $\{q_1,q_2\}$.

Поскольку слово $a^2$ действует на $Q$ точно так же, как буква $a$, это слово не может появиться в $w$ в качестве фактора -- в противном
случае, заменив вхождение $a^2$ на $a$, мы получили бы более короткое синхронизирующее слово. Поэтому после каждого вхождения $a$ в $w$,
кроме последнего, следует вхождение буквы $b$, а стало быть, слово $w'$ может быть записано как слово от образующих $b$ и $ab$. Заменяя
теперь каждое вхождение фактора $ab$ в $w'$ на вхождение буквы $c$, перепишем $w'$ в слово $v$ в алфавите $\{b,c\}$.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% что такое с? Если это буква, то как понимать равенство  $c=ab$?
%% если же с -- это слово, то $\{b,c\}$ -- не алфавит.
%% В этом месте можно было бы написать
%% "переписано в слово $v$ из $\{b,ab\}^*$
%% но в других местах требуемый переход на "академический" стиль
%% осуществить труднее
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Поскольку буква $c$ в автомате $\mathrsfs{B}$ действует так же, как слово $ab$ действует в автомате $\mathrsfs{A}$, слова $w'$ и $v$
действуют на множестве $Q$ одинаково, и потому слово $vc$ является синхронизирующим для автомата $\mathrsfs{B}$. Итак, автомат
$\mathrsfs{B}$ синхронизируем; пусть $s$ -- его порог синхронизации.

Поскольку $b$ лишь переставляет состояния, а каждое применение $c$ может перевести в одно состояние лишь одну пару состояний, слово $vc$,
переводящее все состояния в одно, должно содержать по меньшей мере $n-1$ вхождение буквы $c$. Длина $v$ как слова в алфавите $\{b,c\}$ не
меньше $s-1$ и $v$ содержит по меньшей мере $n-2$ вхождения $c$. Поскольку каждое вхождение $c$ в $v$ отвечает вхождению фактора $ab$ в
$w'$, мы можем заключить, что слово $w'$ имеет длину не меньше $(s-1)+(n-2)$. Учитывая, что длина слова $w=w'a$ равна $t$, получаем $t-1\ge
(s-1)+(n-2)$, откуда $s\le t-n+2$.
\end{proof}

Заметим, что модификации некоторого данного автомата $\mathrsfs{A}$ в духе предложения~\ref{prop:simple idempotent}, когда на том же
множестве состояний рассматривается новый автомат с входными буквами $c_1$ и $c_2$, действия которых определяются действиями некоторых слов
$w_1$ и соответственно $w_2$ в автомате $\mathrsfs{A}$, будут часто использоваться ниже. Допуская вольность речи, мы будем говорить об
автомате, получающемся таким образом, как об автомате, \emph{определяемом действиями слов $c_1=w_1$ и $c_2=w_2$.}

Вернемся к доказательству теоремы~\ref{theorem:cerny}. Легко видеть, что для
автомата $\mathrsfs{C}_n$ автомат, определяемый действиями слов $b$ и $c=ab$,
изоморфен автомату $\mathrsfs{W}_n$, см. рис.\,\ref{fig:cerny-n}. По
теореме~\ref{theorem:anan} порог синхронизации для $\mathrsfs{W}_n$ есть
$n^2-3n+3$. Применяя предложение~\ref{prop:simple idempotent}, заключаем, что
порог синхронизации для $\mathrsfs{C}_n$ не может быть меньше чем
$(n^2-3n+3)+(n-2)=n^2-2n+1=(n-1)^2$.
\end{proof}

Следующая серия из семейства автоматов, связанных с орграфом $W_n$, состоит из
автоматов $\mathrsfs{E}_n=\langle\{1,2,\dots,n\},\{a,b\},\delta\rangle$, где
буквы $a$ и $b$ действуют следующим образом:
$$\delta(i,a)=\begin{cases}
2, &\text{если } i = 1,\\
3, &\text{если } i = 2,\\
i, &\text{если } i>2;
\end{cases}\quad
\delta(i,b)=\begin{cases}
i+1, &\text{если } i<n,\\
1, &\text{если } i=n.
\end{cases}$$
Автомат $\mathrsfs{E}_n$ изображен на рис.\,\ref{fig:e-n} слева.
\begin{figure}[hb]
\begin{center}
\unitlength .45mm
\begin{picture}(72,66)(25,-76)
\gasset{Nw=16,Nh=16,Nmr=8,loopdiam=10} \node(n0)(36.0,-16.0){2}
\node(n1)(4.0,-40.0){$1$} \node(n2)(68.0,-40.0){3} \node(n3)(16.0,-72.0){$n$}
\node(n4)(56.0,-72.0){4} \drawedge[ELdist=2.0](n1,n0){$a$}
\drawedge[ELdist=1.5](n2,n4){$b$} \drawedge[ELdist=1.7](n0,n2){$a,b$}
\drawedge[ELdist=1.7](n3,n1){$b$} \drawedge[ELdist=1.7](n1,n2){$b$}
\drawloop[ELdist=1.5,loopangle=30](n2){$a$}
\drawloop[ELdist=2.4,loopangle=-30](n4){$a$}
\drawloop[ELdist=1.5,loopangle=210](n3){$a$} \put(31,-73){$\dots$}
\end{picture}
\begin{picture}(72,66)(-25,-76)
\gasset{Nw=16,Nh=16,Nmr=8,loopdiam=10} \node(n0)(36.0,-16.0){2}
\node(n1)(4.0,-40.0){1} \node(n2)(68.0,-40.0){3} \node(n3)(16.0,-72.0){$n$}
\node(n4)(56.0,-72.0){4} \drawedge[ELdist=1.5](n2,n4){$b$}
\drawedge[ELdist=1.7](n0,n2){$b,c$} \drawedge[ELdist=1.7](n3,n1){$b$}
\drawedge[ELdist=2.0](n1,n2){$b,c$} \drawloop[ELdist=1.5,loopangle=30](n2){$c$}
\drawloop[ELdist=2.4,loopangle=-30](n4){$c$}
\drawloop[ELdist=1.5,loopangle=210](n3){$c$} \put(31,-73){$\dots$}
\end{picture}
\end{center}
\caption{Автомат $\mathrsfs{E}_n$ и автомат, определяемый действиями слов $b$ и
$c=aa$}\label{fig:e-n}
\end{figure}

\begin{theorem}
\label{thm:e-n} Автомат $\mathrsfs{E}_n$ синхронизируем, и его порог
синхронизации равен $n^2-3n+2$.
\end{theorem}

\begin{proof}
Несложно проверить, что слово $(a^2b^{n-2})^{n-3}a^2$ синхронизирует автомат
$\mathrsfs{E}_n$. Длина этого слова равна $n(n-3)+2=n^2-3n+2$.

Пусть теперь $w$ -- некоторое синхронизирующее $\mathrsfs{E}_n$ слово
минимальной длины. Заметим, что в $\mathrsfs{E}_n$ слова $bab$ и $b^2$
действуют одинаково и слова $a^3$ и $a^2$ тоже действуют одинаково. Поэтому
слова
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% факторы -- это по определеию то, что входит
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
$bab$ и $a^3$ не могут входить в слово $w$ в качестве факторов. Кроме того, $w$ не может начинаться с $ab$. Действительно, образ множества
всех состояний под действием слова $ab$ равен $\{1,3,\dots,n\}$, что совпадает с образом буквы $b$. Поэтому если бы слово $w$ начиналось с
$ab$, то, заменив $ab$ на $b$, мы получили бы более короткое синхронизирующее слово. Наконец, $w$ не может заканчиваться на $ba$.
Действительно, если $w=w'a$, то из минимальности $w$ следует, что образ множества всех состояний под действием слова $w'$ равен $\{2,3\}$.
Однако последнее множество не принадлежит образу буквы $b$, т.\,е.\ $w'$ не может оканчиваться на $b$. Итак, любое вхождение буквы $a$ в
слово $w$ происходит внутри фактора $a^2$ и никакие два вхождения таких факторов в $w$ не перекрываются.

Положим $c=a^2$, тогда слово $w$ может быть переписано в слово $v$ в алфавите $\{b,c\}$. Действия $b$ и $c$ на множестве $\{1,2,\dots,n\}$
определяют автомат, изображенный на рис.\,\ref{fig:e-n} справа. Поскольку слова $w$ и $v$ действуют на множестве $\{1,2,\dots,n\}$
одинаково, слово $v$ является синхронизирующим для этого автомата, а значит, и для его подавтомата с множеством состояний
$\{1,3,\dots,n\}$. Легко видеть, что этот подавтомат изоморфен автомату $\mathrsfs{C}_{n-1}$. По теореме~\ref{theorem:cerny} длина $v$ как
слова в алфавите $\{b,c\}$ не меньше $(n-2)^2$ и $v$ содержит по меньшей мере $n-2$ вхождения $c$. Поскольку каждое вхождение $c$ в $v$
отвечает вхождению фактора $a^2$ в $w$, мы можем заключить, что слово $w$ имеет длину не меньше $(n-2)^2+(n-2)=n^2-3n+2$.
\end{proof}

Доказательство теоремы~\ref{thm:e-n} показывает, что автомат $\mathrsfs{E}_n$ возникает из одной из тех
%%%%%%%%%%%%%%%%%%%%%%%
%% тех ? той
%%%%%%%%%%%%%%%%%%%%%%
<<тривиальных>> модификаций автомата
$\mathrsfs{C}_{n-1}$, которые мы обсудили в п.\,4.1. Последняя серия медленно
синхронизируемых автоматов из семейства автоматов, связанных с орграфом $W_n$,
возникает из аналогичной модификации автомата $\mathrsfs{W}_{n-1}$. Она состоит
из автоматов $\mathrsfs{H}_n=\langle\{1,2,\dots,n\},\{a,b\},\delta\rangle$, где
буквы $a$ и $b$ действуют следующим образом:
$$\delta(i,a)=\begin{cases}
n, &\text{если } i=1,\\
i, &\text{если } 1<i<n,\\
1, &\text{если } i=n;
\end{cases}\quad
\delta(i,b)=\begin{cases}
i+1, &\text{если } i<n-1,\\
1, &\text{если } i=n-1,\\
3, &\text{если } i=n.
\end{cases}$$
Автомат $\mathrsfs{H}_n$ изображен на рис.\,\ref{fig:h-n} слева.

\begin{figure}[ht]
\unitlength .5mm
\begin{center}
\begin{picture}(72,72)(25,-75)
\gasset{Nw=16,Nh=16,Nmr=8,loopdiam=10}
\node[NLangle=0.0](n0)(24.25,-23.6){$n{-}1$}
\node[NLangle=0.0](n1)(52.25,-7.6){$1$}
\node[NLangle=0.0](n2)(80.25,-23.6){$2$}
\node[NLangle=0.0](n3)(24.25,-52){$n{-}2$}
\node[NLangle=0.0](n4)(55,-67.6){$4$} \node[NLangle=0.0](n6)(80.25,-52){$3$}
\drawedge(n1,n2){$b$} \drawedge(n2,n6){$b$} \drawedge(n0,n1){$b$}
\drawedge(n3,n0){$b$} \drawedge(n6,n4){$b$} \drawloop[loopangle=0.0](n6){$a$}
\drawloop[loopangle=270.0](n4){$a$} \drawloop[loopangle=180.0](n3){$a$}
\drawloop[loopangle=0.0](n2){$a$} \node[NLangle=0.0](n31)(52.0,-38){$n$}
\drawedge[ELside=r,ELdist=3.0,curvedepth=-5.0](n1,n31){$a$}
\drawedge[ELside=r,ELdist=3.0,curvedepth=-5.0](n31,n1){$a$}
\drawloop[loopangle=180.0](n0){$a$} \drawedge(n31,n6){$b$}
\put(31,-67){$\dots$}
\end{picture}
\begin{picture}(72,72)(-25,-75)
\gasset{Nw=16,Nh=16,Nmr=8,loopdiam=10}
\node[NLangle=0.0](n0)(24.25,-23.6){$n{-}1$}
\node[NLangle=0.0](n1)(52.25,-7.6){$1$}
\node[NLangle=0.0](n2)(80.25,-23.6){$2$}
\node[NLangle=0.0](n3)(24.25,-52){$n{-}2$}
\node[NLangle=0.0](n4)(55,-67.6){$4$} \node[NLangle=0.0](n6)(80.25,-52){$3$}
\drawedge[ELdist=0.7](n1,n2){$b$} \drawedge[ELpos=35, ELdist=0.5](n1,n6){$c$}
\drawedge(n2,n6){$b, c$} \drawedge(n0,n1){$b, c$} \drawedge(n3,n0){$b, c$}
\drawedge(n6,n4){$b,c$} \node[NLangle=0.0](n31)(50,-40){$n$}
\drawedge[ELpos=35,ELdist=0.7](n31,n6){$b$}
\drawedge[ELpos=35,ELdist=0.7](n31,n2){$c$} \put(31,-67){$\dots$}
\end{picture}
\end{center}
\caption{Автомат $\mathrsfs{H}_n$ и автомат, определяемый действиями слов $b$ и
$c=ab$}\label{fig:h-n}
\end{figure}

\begin{theorem}
\label{thm:h-n} Автомат $\mathrsfs{H}_n$ синхронизируем, и его порог
синхронизации равен $n^2-4n+6$.
\end{theorem}

\begin{proof}
Легко убедиться, что слово $b(ab^{n-2})^{n-3}ab$ синхронизирует автомат
$\mathrsfs{H}_n$. Длина этого слова равна $1+(n-1)(n-3)+2=n^2-4n+6$.

Пусть теперь $w$ -- некоторое синхронизирующее $\mathrsfs{H}_n$ слово
минимальной длины. Поскольку в $\mathrsfs{H}_n$ слово $a^2$ действует как
тождественное преобразование, оно не может входить в $w$ в качестве фактора.
Кроме того, слово $w$ не может ни начинаться, ни заканчиваться буквой $a$, так
как эта буква действует на множестве всех состояний как перестановка.

Положим $c=ab$, тогда слово $w$ может быть переписано в слово $v$ в алфавите $\{b,c\}$. Действия $b$ и $c$ на множестве $\{1,2,\dots,n\}$
определяют автомат, изображенный на рис.\,\ref{fig:h-n} справа. Поскольку слова $w$ и $v$ действуют на множестве $\{1,2,\dots,n\}$
одинаково, слово $v$ является синхронизирующим для этого автомата. Выше отмечено, что слово $w$ начинается с буквы $b$, а значит, с нее
начинается и $v$. Если записать $v=bv'$ для некоторого $v'\in\{b,c\}^*$, то легко видеть, что слово $v'$ будет синхронизирующим для
подавтомата с множеством состояний $\{1,2,\dots,n-1\}$. Поскольку этот подавтомат изоморфен автомату $\mathrsfs{W}_{n-1}$, по
теореме~\ref{theorem:anan} длина $v'$ как слова в алфавите $\{b,c\}$ не меньше $(n-1)^2-3(n-1)+3$. Кроме того, $v'$ содержит по меньшей
мере $n-2$ вхождения $c$, поскольку $b$ лишь переставляет состояния из $\{1,2,\dots,n-1\}$, а каждое применение $c$ может перевести в одно
состояние лишь одну пару состояний. Учитывая, что каждое вхождение $c$ в $v'$ отвечает вхождению фактора $ab$ в $w$, мы можем заключить,
что длина слова $w$ не может быть меньше чем $1+((n-1)^2-3(n-1)+3)+(n-2)=n^2-4n+6$.
\end{proof}

\paragraph*{4.3. Автоматы, связанные с орграфами серии $D_n$.} Орграф $D_n$ -- это
$n$-орграф с экспонентой $(n-1)^2$, отвечающий второй матрице
в~\eqref{wielandt}. Он получается из орграфа $W_n$ добавлением дуги $(n-1,1)$.
Нетрудно видеть, что с точностью до изоморфизма и переименования букв
существуют ровно две раскраски орграфа $D_n$ с помощью двух букв. На
рис.\,\ref{fig:dulmage} изображен орграф $D_n$ и две его раскраски -- автоматы
$\mathrsfs{D}'_n$ и $\mathrsfs{D}''_n$.

\begin{figure}[hb]
\begin{center}
\unitlength .4mm
\begin{picture}(64,60)(30,-72)
\scriptsize
\gasset{Nw=16,Nh=16,Nmr=8} \node(n0)(32.0,-16.0){1} \node(n1)(0,-40.0){$n$}
\node(n2)(64.0,-40.0){2} \node(n3)(12.0,-72.0){$n{-}1$}
\node(n4)(52.0,-72.0){3} \drawedge(n1,n0){} \drawedge(n2,n4){}
\drawedge(n0,n2){} \drawedge(n3,n0){} \drawedge(n3,n1){} \drawedge(n1,n2){}
\put(31,-73){$\dots$}
\end{picture}
\begin{picture}(64,60)(0,-72)
\scriptsize
\gasset{Nw=16,Nh=16,Nmr=8} \node(n0)(32.0,-16.0){1} \node(n1)(0,-40.0){$n$}
\node(n2)(64.0,-40.0){2} \node(n3)(12.0,-72.0){$n{-}1$}
\node(n4)(52.0,-72.0){3} \drawedge[ELdist=2.0](n1,n0){$b$}
\drawedge[ELdist=1.5](n2,n4){$a, b$} \drawedge[ELdist=1.7](n0,n2){$a,b$}
\drawedge[ELpos=40,ELdist=1.7](n3,n0){$a$} \drawedge[ELdist=1.7](n3,n1){$b$}
\drawedge[ELdist=2.0](n1,n2){$a$} \put(31,-73){$\dots$}
\end{picture}
\begin{picture}(64,60)(-30,-72)
\scriptsize
\gasset{Nw=16,Nh=16,Nmr=8} \node(n0)(32.0,-16.0){1} \node(n1)(0,-40.0){$n$}
\node(n2)(64.0,-40.0){2} \node(n3)(12.0,-72.0){$n{-}1$}
\node(n4)(52.0,-72.0){3} \drawedge[ELdist=2.0](n1,n0){$a$}
\drawedge[ELdist=1.5](n2,n4){$a, b$} \drawedge[ELdist=1.7](n0,n2){$a, b$}
\drawedge[ELpos=40,ELdist=1.7](n3,n0){$a$} \drawedge[ELdist=1.7](n3,n1){$b$}
\drawedge[ELdist=2.0](n1,n2){$b$} \put(31,-73){$\dots$}
\end{picture}
\end{center}
\caption{Орграф $D_n$ и его раскраски $\mathrsfs{D}'_n$ и $\mathrsfs{D}''_n$}\label{fig:dulmage}
\end{figure}

\begin{theorem}
\label{theorem:new series} Автоматы $\mathrsfs{D}'_n$ и $\mathrsfs{D}''_n$
синхронизируемы, и их пороги синхронизации равны $n^2-3n+4$ и $n^2-3n+2$
соответственно.
\end{theorem}

\begin{proof}
Нетрудно проверить, что слово $(ab^{n-2})^{n-2}ba$ синхронизирует автомат
$\mathrsfs{D}'_n$, а слово $(ba^{n-1})^{n-3}ba$ -- автомат $\mathrsfs{D}''_n$.
Длины этих слов равны $(n-1)(n-2)+2=n^2-3n+4$ и $n(n-3)+2=n^2-3n+ 2$
соответственно.

Из теоремы~\ref{dulmage}(b) и предложения~\ref{lower bound} вытекает, что порог
синхронизации для раскрасок орграфа $D_n$ не может быть меньше чем
$(n-1)^2-(n-1)=n^2-3n+2$. Это доказывает утверждение теоремы для автомата
$\mathrsfs{D}''_n$.

Займемся теперь автоматом $\mathrsfs{D}'_n$. Здесь будет полезен следующий
элементарный результат.
\begin{lemma}[\!\!{\mdseries\cite[Теорема 2.1.1]{RaAl05}}]
\label{sylvester} Если натуральные числа $k$ и $\ell$ взаимно просты, то
наибольшее натуральное число, не представимое в виде линейной комбинации чисел
$k$ и $\ell$ c целыми неотрицательными коэффициентами, равно $k\ell-k-\ell$.
\end{lemma}

Пусть теперь $w$ -- некоторое синхронизирующее автомат $\mathrsfs{D}'_n$ слово
минимальной длины. Поскольку 2 -- единственное состояние в $\mathrsfs{D}'_n$,
являющееся общим концом двух разных дуг с одинаковой меткой, из минимальности
$w$ следует, что под действием $w$ все состояния автомата переходят в~2. Если
предположить, что длина $w$ равна $n^2-3n+2$, то в $D_n$ найдется маршрут такой
длины из вершины~1 в вершину~2. Но вершина~1 имеет единственную исходящую дугу
$(1,2)$, следовательно, указанный маршрут состоит из этой дуги и контура длины
$n^2-3n+1$. В орграфе $D_n$ есть ровно три простых контура: один длины $n$ и
два длины $n-1$. Любой контур можно разбить на простые контуры, а потому число
$n^2-3n+1$ должно (как длина некоторого контура в $D_n$) быть линейной
комбинацией чисел $n$ и $n-1$ (длин простых контуров) c целыми неотрицательными
коэффициентами. Но это невозможно по лемме~\ref{sylvester}, поскольку
$n^2-3n+1=n(n-1)-n-(n-1)$.

Предположим теперь, что длина $w$ равна $n^2-3n+3$. Тогда в $D_n$ найдется
маршрут указанной длины из вершины~$n-1$ в вершину~2. Поскольку $b$ действует
как перестановка множества всех состояний автомата $\mathrsfs{D}'_n$, слово $w$
должно начинаться с буквы $a$. Состояние $n-1$ под действием $a$ переходит в
состояние~1. Поэтому в $D_n$ должен быть и маршрут  длины $n^2-3n+2$ из~1 в~2,
но в предыдущем абзаце показано, что это невозможно. Таким образом, длина $w$
не может быть меньше чем $n^2-3n+4$.
\end{proof}

Серия $\mathrsfs{D}'_n$ интересна тем, что при $n>6$ автоматы этой серии
обладают наибольшим порогом синхронизации среди всех известных автоматов за
исключением автоматов из серии Черни $\mathrsfs{C}_n$, а также наибольшим
порогом синхронизации среди всех известных автоматов без петель. У серии
$\mathrsfs{D}''_n$ также есть экстремальное свойство: автоматы этой серии
обладают наибольшим порогом синхронизации среди всех известных автоматов, в
которых ни одна буква не действует как перестановка множества состояний.

C орграфами $D_n$ связана еще одна серия $n$-автоматов с порогом синхронизации
$n^2-4n+6$. Мы не будем ее здесь приводить, поскольку одна серия с такими же
параметрами уже описана выше (см.\ теорему~\ref{thm:h-n}).

\paragraph*{4.4. Автоматы, связанные с орграфами серии $V_n$.} Орграф $V_n$ -- это
$n$-орграф, отвечающий первой матрице в~\eqref{odd island}. Если обозначить
вершины $V_n$ через $1,2,\dots,n$, то его дуги суть $(n,1)$, $(n,3)$ и
$(i,i+1)$ для $i=1,\dots,n-1$. Орграф $V_n$ примитивен только при нечетном $n$,
и в этом случае его экспонента равна $n^2-3n+4$. С орграфами серии $V_n$
связано семейство автоматов
$\mathrsfs{F}_n=\langle\{1,2,\dots,n\},\{a,b\},\delta\rangle$, в которых буквы
$a$ и $b$ действуют следующим образом:
$$\delta(i,a)=\begin{cases}
i, &\text{если } i<n,\\
2, &\text{если } i=n;
\end{cases}\quad
\delta(i,b)=\begin{cases}
i+1, &\text{если } i<n,\\
1, &\text{если } i=n.
\end{cases}$$
Автомат $\mathrsfs{F}_n$ изображен на рис.\,\ref{fig:f-n} слева.

\begin{figure}[th]
\begin{center}
\unitlength .5mm
\begin{picture}(72,86)(25,-76)
\gasset{Nw=16,Nh=16,Nmr=8,loopdiam=10} \node(n0)(36.0,-16.0){1}
\node(n1)(4.0,-40.0){$n$} \node(n2)(68.0,-40.0){2}
\node(n3)(16.0,-72.0){$n{-}1$} \node(n4)(56.0,-72.0){3}
\drawedge[ELdist=2.0](n1,n0){$b$} \drawedge[ELdist=1.5](n2,n4){$b$}
\drawedge[ELdist=1.7](n0,n2){$b$} \drawedge[ELdist=1.7](n3,n1){$b$}
\drawedge[ELdist=1.7](n1,n2){$a$} \drawloop[ELdist=1.5,loopangle=30](n2){$a$}
\drawloop[ELdist=2.4,loopangle=-30](n4){$a$}
\drawloop[ELdist=1.5,loopangle=210](n3){$a$}
\drawloop[ELdist=1.5,loopangle=90](n0){$a$} \put(31,-73){$\dots$}
\end{picture}
\begin{picture}(72,86)(-25,-76)
\gasset{Nw=16,Nh=16,Nmr=8} \node(n0)(36.0,-16.0){1} \node(n1)(4.0,-40.0){$n$}
\node(n2)(68.0,-40.0){2} \node(n3)(16.0,-72.0){$n{-1}$}
\node(n4)(56.0,-72.0){3} \drawedge[ELdist=1.5](n2,n4){$b,c$}
\drawedge[ELdist=1.7](n0,n2){$b,c$} \drawedge[ELdist=1.7](n3,n1){$b,c$}
\drawedge[ELdist=2.0](n1,n0){$b$} \drawedge[ELdist=2.0](n1,n4){$c$}
\put(31,-73){$\dots$}
\end{picture}
\end{center}
\caption{Автомат $\mathrsfs{F}_n$ и автомат, определяемый действиями слов $b$ и
$c=ab$}\label{fig:f-n}
\end{figure}


\begin{theorem}
\label{thm:f-n} Автомат $\mathrsfs{F}_n$ синхронизируем при нечетном $n>3$, и
его порог синхронизации равен $n^2-3n+3$.
\end{theorem}

\begin{proof}
Непосредственно проверяется, что при каждом нечетном $n>3$ слово
$(ab^{n-2})^{n-2}a$ синхронизирует автомат $\mathrsfs{F}_n$. Длина этого слова
составляет $(n-1)(n-2)+1=n^2-3n+3$.

Ясно, что автомат $\mathrsfs{F}_n$ удовлетворяет условиям
предложения~\ref{prop:simple idempotent}. Действия слов $b$ и $c=ab$ на
множестве $\{1,2,\dots,n\}$ определяют автомат, изображенный на
рис.\,\ref{fig:f-n} справа; обозначим этот автомат через $\mathrsfs{V}$. Ясно,
что автомат $\mathrsfs{V}$ изоморфен некоторой раскраске орграфа $V_n$. Из
теоремы~\ref{dulmage}(d) и предложения~\ref{lower bound} следует, что порог
синхронизации для раскрасок орграфа $V_n$ не может быть меньше чем
$(n^2-3n+4)-(n-1)=n^2-4n+5$. Применяя предложение~\ref{prop:simple idempotent},
заключаем, что порог синхронизации для $\mathrsfs{F}_n$ не может быть меньше
чем $(n^2-4n+5)+(n-2)=n^2-3n+3$.
\end{proof}

\paragraph*{4.5. Автоматы, связанные с орграфами серии $R_n$.} Орграф $R_n$ -- это
$n$-орграф, отвечающий второй матрице в~\eqref{odd island}. Он получается из
орграфа $V_n$ добавлением дуги $(n-1,2)$. Орграф $R_n$ примитивен только при
нечетном $n$, и в этом случае его экспонента равна $n^2-3n+3$. С орграфами
серии $R_n$ связано семейство автоматов
$\mathrsfs{B}_n=\langle\{1,2,\dots,n\},\{a,b\},\delta\rangle$, в которых буквы
$a$ и $b$ действуют следующим образом:
$$\delta(i,a)=\begin{cases}
i &\text{if } i<n-1,\\
1 &\text{if } i=n-1,\\
2 &\text{if } i=n;
\end{cases}\quad
\delta(i,b)=\begin{cases}
i+1 &\text{if } i<n,\\
1 &\text{if } i=n.
\end{cases}$$
Автомат $\mathrsfs{B}_n$ изображен на рис.\,\ref{fig:avz-n} слева.

\begin{figure}[ht]
\begin{center}
\unitlength .5mm
\begin{picture}(72,72)(30,-76)
\gasset{Nw=16,Nh=16,Nmr=8,loopdiam=10} \node(n1)(56.0,-16.0){1}
\node(n2)(68.0,-44.0){2} \node(n3)(56.0,-72.0){3}
\node(n4)(16.0,-72.0){$n{-}2$} \node(n5)(4.0,-44.0){$n{-}1$}
\node(n6)(16.0,-16.0){$n$} \drawedge[ELdist=1.7](n1,n2){$b$}
\drawedge[ELdist=1.7](n2,n3){$b$} \drawedge[ELdist=1.7](n4,n5){$b$}
\drawedge[ELdist=1.7](n5,n6){$b$} \drawedge[ELdist=1.7](n6,n1){$b$}
\drawedge[ELdist=1.7,ELpos=40](n5,n1){$a$}
\drawedge[ELdist=1.7,ELpos=60](n6,n2){$a$}
\drawloop[ELdist=1.5,loopangle=30](n1){$a$}
\drawloop[ELdist=1.5,loopangle=0](n2){$a$}
\drawloop[ELdist=1.5,loopangle=-30](n3){$a$}
\drawloop[ELdist=1.5,loopangle=210](n4){$a$} \put(31,-73){$\dots$}
\end{picture}
\begin{picture}(72,72)(-30,-76)
\gasset{Nw=16,Nh=16,Nmr=8} \node(n1)(56.0,-16.0){1} \node(n2)(68.0,-44.0){2}
\node(n3)(56.0,-72.0){3} \node(n4)(16.0,-72.0){$n{-}2$}
\node(n5)(4.0,-44.0){$n{-}1$} \node(n6)(16.0,-16.0){$n$}
\drawedge[ELdist=1.7](n1,n2){$b,c$} \drawedge[ELdist=1.7](n2,n3){$b,c$}
\drawedge[ELdist=1.7](n4,n5){$b,c$} \drawedge[ELdist=1.7](n5,n6){$b$}
\drawedge[ELdist=1.7](n6,n1){$b$} \drawedge[ELdist=1.7,ELpos=60](n5,n2){$c$}
\drawedge[ELdist=1.7,ELpos=35](n6,n3){$c$} \put(31,-73){$\dots$}
\end{picture}
\end{center}
\caption{Автомат $\mathrsfs{B}_n$ и автомат, определяемый действиями слов $b$ и
$c=ab$}\label{fig:avz-n}
\end{figure}

Серия $\mathrsfs{B}_n$ (при нечетном $n>3$) была опубликована в~\cite{AVZ} и до
недавнего времени оставалась единственной бесконечной серией медленно
синхронизируемых автоматов с двумя входными буквами, представленной в
литературе, помимо серии Черни. Ее связь с орграфами из серии $R_n$ ранее не
отмечалась.

Следующее утверждение, являющееся
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
основным результатом статьи~\cite{AVZ},
было доказано  в ней теоретико-игровым методом. Здесь мы даем вполне элементарное
доказательство, сходное с доказательствами теорем~\ref{theorem:cerny}
и~\ref{thm:f-n}.

\begin{theorem}[\!\!{\mdseries\cite[теорема~1.1]{AVZ}}]
\label{theorem:avz} Если $n>3$ нечетно, то автомат $\mathrsfs{B}_n$
синхронизируем, и его порог синхронизации равен $n^2-3n+2$.
\end{theorem}

\begin{proof}
Нетрудно проверить, что при каждом нечетном $n>3$ слово
$(ab^{n-2})^{\frac{n-3}{2}}ab^{n-3}(ab^{n-2})^{\frac{n-3}{2}}a$ синхронизирует
автомат $\mathrsfs{B}_n$. Длина этого слова равна
$(n-1)\frac{n-3}{2}+n-2+(n-1)\frac{n-3}{2}+1=n^2-3n+2.$

Пусть $w$ -- некоторое синхронизирующее автомат $\mathrsfs{B}_n$ слово
минимальной длины $t$. Поскольку буква $b$ действует как перестановка множества
всех состояний, слово $w$ не может ни начинаться с $b$, ни оканчиваться на $b$.
В частности, $w=w'a$ для некоторого слова $w'\in\{a,b\}^*$. Из минимальности длины
слова $w$ вытекает, что образ множества всех состояний под действием слова $w'$
равен либо $\{1,n-1\}$, либо $\{2,n\}$.

Поскольку слово $a^2$ действует в $\mathrsfs{B}_n$ точно так же, как буква $a$,
это слово не может появиться в $w$ в качестве фактора. Далее, слово $b^n$ действует
в $\mathrsfs{B}_n$ как тождественное преобразование и, стало быть, также не может
быть фактором в синхронизирующем слове минимальной длины. Итак, мы заключаем,
что $w=ab^{k_1}ab^{k_2}a\cdots ab^{k_m}a$, где $1\le k_1,k_2,\dots,k_m\le n-1$.

Положим $c=ab$. Тогда слово $w'$ и слово $v=cb^{k_1-1}cb^{k_2-1}c\cdots cb^{k_m-1}$ одинаково действуют на множестве $\{1,2,\dots,n\}$.
Поэтому слово $vc$ является синхронизирующим для автомата $\mathrsfs{R}$, определяемого действиями слов $b$ и $c=ab$ и изображенного на
рис.\,\ref{fig:avz-n} справа. Ясно, что автомат $\mathrsfs{R}$ изоморфен некоторой раскраске орграфа $R_n$. Из теоремы~\ref{dulmage}(d) и
предложения~\ref{lower bound} следует, что порог синхронизации для раскрасок орграфа $R_n$ не может быть меньше чем
$(n^2-3n+3)-(n-1)=n^2-4n+4$, откуда длина $v$ как слова в алфавите $\{b,c\}$, равная $\sum_{i=1}^mk_i$, не меньше $n^2-4n+3$. Поскольку
$k_i\le n-1$ для всех $i=1,\dots,m$, имеем
\begin{equation}
\label{inequality} m(n-1)\ge\sum_{i=1}^mk_i\ge n^2-4n+3=(n-3)(n-1),
\end{equation}
откуда $m\ge n-3$. При этом равенство $m=n-3$ возможно только в случае, когда
все неравенства в~\eqref{inequality} обращаются в равенства, т.\,е.\ когда
$k_i=n-1$ для всех $i=1,\dots,m$. Тогда $vc=(cb^{n-2})^{n-3}c$, но последнее
слово не является синхронизирующим для $\mathrsfs{R}$ -- легко видеть, что оно
переставляет состояния~2 и~3. Значит, $m\ge n-2$.

Поскольку каждое вхождение $c$ в $v$ отвечает вхождению фактора $ab$ в $w'$,
можем заключить, что слово $w'$ имеет длину не меньше
$(n^2-4n+3)+(n-2)=n^2-3n+1$, откуда длина $w$ не меньше чем $n^2-3n+2$.
\end{proof}

\paragraph*{4.6. Автоматы, связанные с орграфами серии $G_n$.} Орграф $G_n$ -- это
$n$-орграф, отвечающий второй матрице в~\eqref{odd island1}. Он получается из
орграфа $V_n$ добавлением дуги $(n-2,1)$. Орграф $G_n$ примитивен только при
нечетном $n$, и в этом случае его экспонента равна $n^2-3n+2$. На
рис.~\ref{fig:aut:fat} изображен автомат  $\mathrsfs{G}_n$, являющийся одной из
возможных раскрасок орграфа $G_n$. Эта серия автоматов интересна для нас тем,
что при нечетном $n$ она реализует максимальное наблюдаемое <<материковое>>
значение порога синхронизации.

\begin{figure}[ht]
\begin{center}
\unitlength .5mm
\begin{picture}(100,95)(0,-95)
\gasset{Nw=16,Nh=16,Nmr=8} \node[NLangle=0.0](n0)(24.09,-24.01){$n{-}1$}
\node[NLangle=0.0](n1)(51.93,-12.0){$n$}
\node[NLangle=0.0](n2)(80.09,-24.01){$1$}
\node[NLangle=0.0](n3)(12.09,-48.01){$n{-}2$}
\node[NLangle=0.0](n4)(16.09,-76.01){$n{-}3$}
\node[NLangle=0.0](n5)(92.09,-48.01){$2$}
\node[NLangle=0.0](n6)(64.09,-92.01){$4$}
\node[NLangle=0.0](n7)(88.09,-76.01){$3$} \drawedge(n1,n2){$b$}
\drawedge(n2,n5){$a, b$} \drawedge(n5,n7){$a, b$} \drawedge(n7,n6){$a,b$}
\drawedge(n4,n3){$a, b$} \drawedge(n3,n0){$b$} \drawedge(n0,n1){$a,b$}
\drawedge(n1,n7){$a$} \drawedge(n3,n2){$a$} \put(33,-90){$\dots$}
\end{picture}
\end{center}
\caption{Автомат $\mathrsfs{G}_n$} \label{fig:aut:fat}
\end{figure}

\begin{theorem}
Если $n>3$ нечетно, то автомат $\mathrsfs{G}_n$ синхронизируем, и его порог
синхронизации равен $n^2-4n+7$.
\end{theorem}

\begin{proof}
Легко видеть, что при каждом нечетном $n>3$ слово $a^2(baba^{n-3})^{n-4}baba^2$
синхронизирует автомат $\mathrsfs{G}_n$. Длина этого слова равна
$2+n(n-4)+5=n^2-4n+7$.

Дальнейшие рассуждения вполне аналогичны аргументам из доказательства
теоремы~\ref{theorem:new series}. Из теоремы~\ref{dulmage}(d) и
предложения~\ref{lower bound} вытекает, что порог синхронизации для раскрасок
орграфа $G_n$ не может быть меньше чем $(n^2-3n+2)-(n-1)=n^2-4n+3$.

Пусть теперь $w$ -- некоторое синхронизирующее автомат $\mathrsfs{G}_n$ слово
минимальной длины. Поскольку 3 -- единственное состояние в $\mathrsfs{G}_n$,
являющееся общим концом двух разных дуг с одинаковой меткой, из минимальности
$w$ следует, что под действием $w$ все состояния автомата переходят в~3. Если
предположить, что длина $w$ равна $n^2-4n+3$, то в $D_n$ найдется маршрут такой
длины из вершины~2 в вершину~3. Но вершина~2 имеет единственную исходящую дугу
$(2,3)$, следовательно, указанный маршрут состоит из этой дуги и контура длины
$n^2-4n+2$. В орграфе $G_n$ есть ровно три простых контура: один длины $n$ и
два длины $n-2$. Любой контур можно разбить на простые контуры, а потому число
$n^2-4n+2$ должно -- как длина некоторого контура в $G_n$ -- быть линейной
комбинацией c целыми неотрицательными коэффициентами длин простых контуров,
т.\,е.\ чисел $n$ и $n-2$. (Отметим, что числа $n$ и $n-2$ взаимно просты, так
как $n$ нечетно.) Однако это невозможно по лемме~\ref{sylvester}, поскольку
$n^2-4n+2=n(n-2)-n-(n-2)$.

Допустим, что длина $w$ равна $n^2-4n+4$. Тогда в $G_n$ найдется маршрут такой
длины из вершины~1 в вершину~3. Вершина~1 имеет единственную исходящую дугу
$(1,2)$, следовательно, указанный маршрут состоит из этой дуги и маршрута длины
$n^2-4n+3$ из~2 в~3. В предыдущем абзаце показано, что в $G_n$ нет маршрута
из~2 в~3 с такой длиной.

Предположим, что длина $w$ равна $n^2-4n+5$. Подействовав словом $w$ на
состояние $n-2$, мы должны перейти в состояние~3. Для состояния $n-2$ есть две
исходящие дуги: $(n-2,1)$  с меткой $a$ и $(n-2,n-1)$ с меткой $b$. Поскольку
буква $b$ действует как перестановка множества всех состояний автомата
$\mathrsfs{G}_n$, слово $w$ начинается с буквы $a$. Поэтому первой дугой
маршрута из $n-2$ в~3, соответствующего действию слова $w$, необходимо будет
дуга $(n-2,1)$, за которой следует маршрут из вершины~1 в вершину~3 с длиной
$n^2-4n+4$. В предыдущем абзаце показано, что в $G_n$ нет маршрута из~1 в~3 с
такой длиной.

Пусть, наконец, длина $w$ равна $n^2-4n+6$. Подействовав словом $w$ на каждое
из состояний $n-3$ и $n-1$, мы должны перейти в состояние~3. Если вторая буква
слова $w$ есть $a$, то маршрут из $n-3$ в~3, соответствующий действию слова
$w$, начинается с дуг $(n-3,n-2)$ и $(n-2,1)$, за которыми должен следовать
маршрут из вершины~1 в вершину~3 с длиной $n^2-4n+4$, что невозможно. Если же
вторая буква слова $w$ есть $b$, то маршрут из $n-1$ в~3, соответствующий
действию слова $w$, начинается с дуг $(n-1,n)$ и $(n,1)$, за которыми снова
должен следовать невозможный маршрут из~1 в~3.

Итак, мы показали, что порог синхронизации автомата $\mathrsfs{G}_n$  не может
быть меньше чем $n^2-4n+7$.
\end{proof}


\section*{{\centerline{\large\bf \S5. Обсуждение и новые гипотезы}}}

\paragraph*{5.1. Две гипотезы.} Построения и результаты, изложенные в \S4,
свидетельствуют о наличии достаточно тесных связей между порогами синхронизации
автоматов с двумя входными буквами и экспонентами примитивных орграфов. Такой
вывод подтверждается и недавними результатами третьего
автора~\cite{Gusev:2011}. Представляется перспективным дальнейшее исследование
этих связей. Чтобы придать такому исследованию конкретность, мы сформулируем
здесь одну весьма общую гипотезу в духе теоремы~\ref{dulmage}. Эта гипотеза
уточняет гипотезу Черни для случая автоматов с двумя входными буквами и
согласуется со всеми известными нам экспериментальными и теоретическими
результатами.

\begin{conjecture}
\label{general} \emph{(a) (Гипотеза Черни)} Порог синхронизации любого
синхронизируемого $n$-автомата с двумя входными буквами не превосходит
$(n-1)^2$.

\emph{(b)} Если $n>6$, то с точностью до изоморфизма есть ровно один
синхронизируемый $n$-автомат с двумя входными буквами и порогом синхронизации
$(n-1)^2$, а именно, автомат $\mathrsfs{C}_n$.

\emph{(c)} Если $n>6$ то нет ни одного синхронизируемого $n$-автомата с двумя
входными буквами, для которого порог синхронизации был бы больше $n^2-3n+4$, но
меньше $(n-1)^2$.

\emph{(d)} Если $n>7$ и $n$ нечетно, то с точностью до изоморфизма есть ровно
один синхронизируемый $n$-автомат с двумя входными буквами и порогом
синхронизации $n^2-3n+4$, а именно, автомат $\mathrsfs{D}'_n$, ровно два
синхронизируемых $n$-автомата с двумя входными буквами и порогом синхронизации
$n^2-3n+3$, а именно, автоматы $\mathrsfs{W}_n$ и $\mathrsfs{F}_n$, и ровно три
синхронизируемых $n$-автомата с двумя входными буквами и порогом синхронизации
$n^2-3n+2$, а именно, автоматы $\mathrsfs{E}_n$, $\mathrsfs{D}''_n$ и
$\mathrsfs{B}_n$. Нет ни одного синхронизируемого $n$-автомата с двумя входными
буквами, для которого порог синхронизации был бы больше $n^2-4n+7$, но меньше
$n^2-3n+2$.

\emph{(e)} Если $n>8$ и $n$ четно, то с точностью до изоморфизма есть ровно
один синхронизируемый $n$-автомат с двумя входными буквами и порогом
синхронизации $n^2-3n+4$, а именно, автомат $\mathrsfs{D}'_n$, ровно один
синхронизируемый $n$-автомат с двумя входными буквами и порогом синхронизации
$n^2-3n+3$, а именно, автомат $\mathrsfs{W}_n$, и ровно два синхронизируемых
$n$-автомата с двумя входными буквами и порогом синхронизации $n^2-3n+2$, а
именно, автоматы $\mathrsfs{E}_n$ и $\mathrsfs{D}''_n$. Нет ни одного
синхронизируемого $n$-автомата с двумя входными буквами, для которого порог
синхронизации был бы больше $n^2-4n+6$, но меньше $n^2-3n+2$.
\end{conjecture}

Сформулируем еще одну, более специальную, гипотезу, которую можно рассматривать
как количественную форму упоминавшейся в \S3 гипотезы раскраски дорог.
Поскольку теперь известно, что всякий примитивный орграф имеет синхронизируемую
раскраску~\cite{Tr09}, понятие порога синхронизации можно естественным образом
распространить на такие орграфы. А именно, назовем \emph{порогом синхронизации}
примитивного орграфа минимум среди длин синхронизирующих слов для всех его
синхронизируемых раскрасок. Немедленно возникает задача о том, как зависит
порог синхронизации примитивного орграфа от числа его вершин.

Заметим, что орграфы медленно синхронизируемых автоматов могут обладать
раскрасками с малым порогом синхронизации. Рис.~\ref{fig:cerny} иллюстрирует
это замечание: первая раскраска изображенного в левой части рисунка орграфа --
это автомат Черни $\mathrsfs{C}_4$, кратчайшее синхронизирующее слово которого
имеет длину~9, вторая же раскраска может быть синхронизирована словом $a^3$
длины~3. В~этой связи  интересна серия орграфов $W_n$, в которой каждый орграф
имеет единственную (с точностью до изоморфизма) раскраску. Тем самым, порог
синхронизации этой раскраски, установленный в теореме~\ref{theorem:anan},
совпадает с порогом синхронизации орграфа $W_n$ и дает нижнюю оценку в
предлагаемой задаче. Мы предполагаем, что эта оценка в действительности точна.

\begin{conjecture}
\label{hybrid} Порог синхронизации каждого примитивного $n$-орграфа не
превосходит $n^2-3n+3$. Если $n>3$, то с точностью до изоморфизма есть ровно
один примитивный $n$-орграф с порогом синхронизации $n^2-3n+3$, а именно,
орграф $W_n$.
\end{conjecture}

Гипотеза~\ref{hybrid} озвучивалась в нескольких докладах второго автора начиная
с 2008 г., и уже опубликованы некоторые первые частичные результаты в
направлении к ее доказательству~\cite{Carpi&D'Alessandro:2010,Steinberg:2011}.
Ясно, что гипотезу~\ref{hybrid} можно уточнять в духе гипотезы~\ref{general}:
например, единственным (с точностью до изоморфизма) примитивным $n$-орграфом с
порогом синхронизации $n^2-3n+2$ является, по-видимому, орграф $D_n$, и т.\,д.

\

\paragraph*{5.2. Влияние размера входного алфавита.} В наших экспериментах
рассматривались автоматы с двумя входными буквами. Это ограничение связано с
тем, что рост размера алфавита влияет на количество автоматов значительно
сильнее, чем рост числа состояний, и потому перебор автоматов с более чем двумя
входными буквами даже при небольшом числе состояний находится далеко за
пределами наших вычислительных ресурсов. Табл.~\ref{table:number of automata}
иллюстрирует это обстоятельство. (Данные в таблице рассчитаны по формуле
из~\cite{Lis69}.)

\begin{table}[ht]
%\extrarowheight=2pt
\tabcolsep=3.45pt  \caption{Число достижимых автоматов с 2
и 3 входными буквами} \label{table:number of automata} {\footnotesize
\begin{tabular}{|p{2.5cm}||c|c|c|} \hline
Число состояний & 7 & 8 & 9  \\
\hline 2 входные буквы & \hfill 256\,182\,290 & \hfill 12\,665\,445\,248 & \hfill 705\,068\,085\,303\\
\hline 3 входные буквы &  500\,750\,172\,337\,212 &
572\,879\,126\,392\,178\,688 & 835\,007\,874\,759\,393\,878\,655 \\
\hline
\end{tabular}}
\end{table}

Тем не менее, есть некоторые основания полагать, что поведение исследовавшейся
нами величины (количества синхронизируемых автоматов с фиксированным числом
состояний как функции от значения порога синхронизации) не слишком сильно
зависит от размера алфавита. Например, в экспериментах Трахтмана, о результатах
которых сообщается в~\cite{Tr06,Tr06a}, не было обнаружено ни одного 7-автомата
с 3 или 4 входными буквами, порог синхронизации которого был бы больше 32, но
меньше 36. Таким образом, величина разрыва между максимальным и следующим за
ним возможным значениями порога синхронизации здесь такая же, как для
7-автоматов с двумя входными буквами.

Отметим еще наблюдение, впервые сделанное, по видимому, в~\cite{Be10}: если имеется верхняя оценка вида $O(n^2)$
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Опять почему \Theta(n^2), а не  O(n^2)?
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
для порогов синхронизации
синхронизируемых $n$-автоматов с двумя входными буквами, то оценка такого же
порядка (возможно, с худшей константой) существует для порогов синхронизации
синхронизируемых $n$-автоматов с любым фиксированным размером входного
алфавита.

\begin{thebibliography}{99}
\bibitem{Lis69}
\textsl{В.\,А.\,Лисковец}, Число связных инициальных автоматов, Кибернетика,
\No3 (1969), 16--19.

\bibitem{ST00}
\textsl{В.\,Н.\,Сачков, В.\,Е.\,Тараканов}, Комбинаторика неотрицательных
матриц. М.: ТВП, 2000.

\bibitem{AGW}
\textsl{R.\,L.\,Adler, L.\,W.\,Goodwyn, B.\,Weiss}, Equivalence of topological
Markov shifts, Israel J. Math., 27 (1977), 49--63.

\bibitem{AMR}
\textsl{M.\,Almeida, N.\,Moreira, R.\,Reis}, Enumeration and generation with a
string automata representation, Theor.\ Comput.\ Sci., 387 (2007), 93--102.

\bibitem{AGV10}
\textsl{D.\,S.\,Ananichev, V.\,V.\,Gusev, M.\,V.\,Volkov}, Slowly synchronizing
automata and digraphs, Mathematical Foundations of Computer Science, Lect.\
Notes Comput.\ Sci., 6281 (2010), 55--64.

\bibitem{AVZ}
\textsl{D.\,S.\,Ananichev, M.\,V.\,Volkov, Yu.\,I.\,Zaks}, Synchronizing
automata with a letter of deficiency 2, Theor.\ Comput.\ Sci., 376 (2007),
30--41.

\bibitem{Be10}
\textsl{M.\,Berlinkov}, Approximating the minimum length of synchronizing words
is hard,  Computer Science in Russia, Lect.\ Notes Comput.\ Sci., 6072 (2010),
37--47.

\bibitem{Be11}
\textsl{M.\,Berlinkov}, On a conjecture by Carpi and D'Alessandro, Int.\ J.
Foundations Comp.\ Sci., 22 (2011), 1565--1576.

\bibitem{Br}
\textsl{R.\,Brualdi, H.\,Ryser}, Combinatorial Matrix Theory, Cambridge University Press, 1991.

\bibitem{Carpi&D'Alessandro:2010}
\textsl{A.\,Carpi, F.\,D'Alessandro}, On the hybrid \v{C}ern{\'y}-{R}oad
{C}oloring {P}roblem and {H}amiltonian paths, Developments in Language Theory,
Lect.\ Notes Comput.\ Sci., 6224 (2010), 124--135.

\bibitem{Ce64}
\textsl{J.\,\v{C}ern\'{y}}, Pozn\'{a}mka k homog\'{e}nnym eksperimentom s
kone\v{c}n\'{y}mi automatami, Matematicko-fyzikalny \v{C}asopis Slovensk.\
Akad.\ Vied, 14, \No3 (1964), 208--216.

\bibitem{DM62}
\textsl{A.\,L.\,Dulmage, N.\,S.\,Mendelsohn}, The exponent of a primitive
matrix, Can.\ Math.\ Bull., 5 (1962), 241--244.

\bibitem{DM64}
\textsl{A.\,L.\,Dulmage, N.\,S.\,Mendelsohn}, Gaps in the exponent set of
primitive matrices, Ill.\ J. Math., 8 (1964), 642--656.

\bibitem{Gusev:2011}
\textsl{V.\,Gusev}, Lower bounds for the length of reset words in {E}ulerian
automata, Reachability Problems, Lect.\ Notes Comput.\ Sci., 6945 (2011),
180--190.

\bibitem{Ka01}
\textsl{J.\,Kari}, A counter example to a conjecture concerning synchronizing
words in finite automata, Bull.\ European Assoc.\ Theor.\ Comput.\ Sci., 73
(2001), 146.

\bibitem{OU10}
\textsl{J.\,Olschewski, M.\,Ummels}, The complexity of finding reset words in
finite automata, Mathematical Foundations of Computer Science, Lect.\ Notes
Comput.\ Sci., 6281 (2010), 568--579.

\bibitem{Pi83}
\textsl{J.-E.\,Pin}, On two combinatorial problems arising from automata
theory, Ann.\ Discrete Math., 17 (1983), 535--548.

\bibitem{RaAl05}
\textsl{J.\,L.\,Ram\'{\i}rez Alfons\'{\i}n}, The diophantine Frobenius problem,
Oxford University Press, 2005.

\bibitem{Sa05}
\textsl{S.\,Sandberg}, Homing and synchronizing sequences, Model-Based Testing
of Reactive Systems, Lect.\ Notes Comput.\ Sci., 3472 (2005), 5--33.

\bibitem{ST11}
\textsl{E.\,Skvortsov, E.\,Tipikin}, Experimental study of the shortest reset
word of random automata, Implementation and Application  of Automata, Lect.\
Notes Comput.\ Sci., 6807 (2011), 290--298.

\bibitem{Steinberg:2011}
\textsl{B.\,Steinberg}, The \v{C}ern\'y conjecture for one-cluster automata
with prime length cycle, Theor.\ Comput.\ Sci., 412 (2011) 5487--5491.

\bibitem{Tr06}
\textsl{A.\,N.\,Trahtman}, An efficient algorithm finds noticeable trends and
examples concerning the \v{C}ern\'y conjecture, Mathematical Foundations of
Computer Science, Lect.\ Notes Comput.\ Sci., 4162 (2006), 789--800.

\bibitem{Tr06a}
\textsl{A.\,N.\,Trahtman}, Notable trends concerning the synchronization of
graphs and automata, Electr.\ Notes Discrete Math., 25 (2006), 173--175.

\bibitem{Tr09}
\textsl{A.\,N.\,Trahtman}, The Road Coloring Problem, Israel J. Math., 172
(2009), 51--60.

\bibitem{Tr11}
\textsl{A.\,N.\,Trahtman}, Modifying the upper bound on the length of minimal
synchronizing word,  Fundamentals of Computation Theory, Lect.\ Notes Comput.\
Sci, 6914 (2011), 173--180.

\bibitem{Vo08}
\textsl{M.\,V.\,Volkov}, Synchronizing automata and the \v{C}ern\'{y}
conjecture, Languages and Automata: Theory and Applications, Lect.\ Notes
Comput.\ Sci., 5196, (2008), 11--27.

\bibitem{Vo09}
\textsl{M.\,V.\,Volkov}, Synchronizing automata preserving a chain of partial
orders, Theor.\ Comput.\ Sci., 410 (2009), 3513--3519.

\bibitem{Wi50}
\textsl{H.\,Wielandt}, Unzerlegbare, nicht negative Matrizen, Math.\ Z., 52,
(1950), 642--648.
\end{thebibliography}
\end{document}
