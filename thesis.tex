\documentclass[12pt]{article}
\usepackage[english,russian]{babel}
\usepackage{amsmath}
\usepackage{amssymb,cite,amsthm}
\usepackage{graphicx, gastex}
\usepackage{enumerate}

\DeclareSymbolFont{rsfscript}{OMS}{rsfs}{m}{n}
\DeclareSymbolFontAlphabet{\mathrsfs}{rsfscript}
\DeclareMathOperator{\df}{df}
\DeclareMathOperator{\rt}{rt}
\DeclareMathOperator{\dt}{.}
\DeclareMathOperator{\dfa}{df_{\mathrsfs{A}}}
\DeclareMathOperator{\GCD}{\text{НОД}}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\Mod}{ mod}

%Из синхронизации ограниченного ранга.
\newcommand{\A}{\mathrsfs{A}}
%\newcommand{\C}{\mathrsfs{C}}
\newcommand{\R}{\mathrsfs{R}}
\newcommand{\AD}{\mathrsfs{A_{\sigma}}}
\newcommand{\G}{\Gamma}
\newcommand{\D}{\Delta}
\newcommand{\g}{\gamma}
\newcommand{\dl}{\delta}
\newcommand{\rk}{\mathrm{rk}}
%\newcommand{\rt}{\mathrm{rt}}
\newcommand{\rtc}{\mathrm{rt}_{c}}

\newcommand{\Fact}{\textit{Fact}}%{\operatorname{Fact}}
\newcommand{\Pref}{\textit{Pref}}%{\operatorname{Pref}}
\newcommand{\Suff}{\textit{Suff}}%{\operatorname{Suff}}

\newtheorem{theorem}{Теорема}
\newtheorem{proposition}{Предложение}[section]
\newtheorem{lemma}[proposition]{Лемма}
\newtheorem{corollary}[proposition]{Следствие}
\newtheorem{conjecture}{Гипотеза}
\renewcommand{\thefigure}{\arabic{figure}}

\theoremstyle{definition}
\newtheorem{remark}[proposition]{Замечание}
\newtheorem{example}[proposition]{Пример}
\begin{document}

%Титульный лист
\thispagestyle{empty}
\centerline{ГОУ ВПО УРАЛЬСКИЙ ФЕДЕРАЛЬНЫЙ}

\centerline{УНИВЕРСИТЕТ ИМЕНИ ПЕРВОГО ПРЕЗИДЕНТА РФ Б.Н. ЕЛЬЦИНА}

\vspace{12mm}
\rightline{На правах рукописи}

\vspace{12mm}
\centerline{Гусев Владимир Валерьевич}
\vspace{12mm}
\rightline{УДК 519.713.2}
\vspace{10mm}
\centerline{\large ЭКСТРЕМАЛЬНЫЕ ПРИМЕРЫ В ТЕОРИИ}
\medskip
\centerline{\large СИНХРОНИЗИРУЕМЫХ АВТОМАТОВ}
\vspace{10mm}\centerline{01.01.09 --- дискретная математика и математическая
кибернетика}
\vspace{15mm}
\centerline{Диссертация на соискание уч\"еной степени}
\medskip
\centerline{кандидата физико-математических наук}
\vspace{15mm}
\hspace{3in}{Научный руководитель ---}

\hspace{3in}{доктор физ.-мат. наук,}

\hspace{3in}{профессор М.~В.~Волков}

\vspace{30mm}
\centerline{Екатеринбург, 2012}


\newpage
\tableofcontents

\newpage
\section*{Введение}
\label{ch:intro}
\addcontentsline{toc}{section}{Введение}
\subsection{Синхронизируемые автоматы и гипотеза Черни}

В данной работе под словом <<язык>> понимается формальный
язык над фиксированным конечным алфавитом $\Sigma$, т.е.\
подмножество свободного моноида $\Sigma^*$ над $\Sigma$, а под
словом <<автомат>> -- конечный детерминированный автомат с входным
алфавитом $\Sigma$. Такой автомат
$\mathrsfs{A}=\langle Q,\Sigma,\delta\rangle$ определяется
заданием конечного \emph{множества состояний} $Q$ и \emph{функции
перехода} $\delta: Q\times\Sigma\rightarrow Q$. (Отметим, что в 
теории формальных языков к набору данных, определяющему конечный 
детерминированный автомат, обычно добавляют выделенное \emph{начальное} 
состояние $q_0\in Q$ и множество  $F$ \emph{заключительных}
состояний. Мы также будем пользоваться этим вариантом определения, 
когда речь будет идти о языках, распознаваемых автоматами.)   Функция $\delta$
естественным образом продолжается на свободный моноид
$\Sigma^{*}$, это продолжение
 мы также будем обозначать через $\delta$.  Таким образом, каждое
слово $w\in\Sigma^*$ (в частности каждая буква алфавита $\Sigma$)
порождает преобразование $\delta(\rule{8pt}{.4pt}\,,w):Q\to Q$
множества $Q$. Имея дело с конечными детерминированными
автоматами, мы  будем отождествлять слово $w$ с этим
преобразованием. Для слова $w\in\Sigma^*$ и подмножества
$S\subseteq Q$ через $S\dt w$ обозначим образ слова $w$, т.е.\
множество $\{\delta(q,w)\mid q\in S\}$.

Автомат $\mathrsfs{A}=\langle Q,A,\delta\rangle$ называется
\emph{синхронизируемым}, если существует слово $w\in A^*$,
переводящее его в одно выделенное состояние, независимо от текущего состояния автомата,
т.е.\ $q\dt w=q'\dt w$ для всех $q,q'\in Q$. Любое слово с таким свойством называется 
\emph{синхронизирующим} для автомата $\mathrsfs A$. Пример синхронизируемого автомата 
с четырьмя состояниями приведен на рис. \ref{fig:cerny}.
\begin{figure}[ht]
 \begin{center}
  \unitlength=4pt
    \begin{picture}(18,26)(0,-2)
    \gasset{Nw=6,Nh=6,Nmr=3}
    \thinlines
    \node(A1)(0,18){$1$}
    \node(A2)(18,18){$2$}
    \node(A3)(18,0){$3$}
    \node(A4)(0,0){$4$}
    \drawloop[loopangle=135](A1){$b$}
    \drawloop[loopangle=45](A2){$b$}
    \drawloop[loopangle=-45](A3){$b$}
    \drawedge(A1,A2){$a$}
    \drawedge(A2,A3){$a$}
    \drawedge(A3,A4){$a$}
    \drawedge[curvedepth=2](A4,A1){$b$}
    \drawedge[ELside=r, curvedepth=-2](A4,A1){$a$}
    \end{picture}
 \end{center}
 \caption{Автомат Черни $\mathrsfs{C}_4$}
 \label{fig:cerny}
\end{figure}
Нетрудно проверить, что слово $w=ba^3ba^3b$ синхронизирует этот автомат 
(более того, $w$ является кратчайшим синхронизирующим для этого автомата). 
Данный пример принадлежит словацкому математику Яну Черни, который в 1964 году 
в работе \cite{Ce64} впервые формально ввел понятие синхронизируемого автомата. 
Это понятие возникло в рамках классического подхода <<умозрительных экспериментов>>
Мура \cite{Moore_56}. Мур и его последователи использовали конечные автоматы для 
моделирования дискретно работающих устройств (компьютеров). Естественный вопрос в 
связи с этим следующий: как мы можем восстановить контроль над устройством, не зная
его текущего состояния, но наблюдая его поведение в ответ на различные посылаемые ему
входные сигналы? Мур в 1956 году в работе \cite{Moore_56} показал, что при некоторых 
условиях можно однозначно определить состояние, в которое автомат приходит под действием 
подходящей последовательности сигналов. В его работе такая последовательность называлась 
\emph{экспериментом}. Отметим, что эксперименты Мура были адаптивными, т.е.\ каждое следующее
действие выбиралось на основе реакции устройства на предыдущие действия. Гинзбург в 1958 году
в работе \cite{Ginz58} рассмотрел особый тип экспериментов, которые он назвал \emph{однородными}.
Такой эксперимент -- это просто фиксированная последовательность сигналов, т.е.\  подходящее
слово над входным алфавитом; особенностью однородных экспериментов являлось то, что ответные
сигналы нужны были только для определения состояния устройства в конце эксперимента. Отсюда
понадобился всего один шаг, чтобы прийти к понятию синхронизирующего слова -- эксперимента,
в котором вообще не учитываются ответные сигналы устройства. Отметим, что это понятие является
довольно естественным с точки зрения практики, поскольку далеко не всегда можно наблюдать 
ответные сигналы устройства: например, при движении спутника вокруг Луны он не может контролироваться
с Земли в момент, когда он находится <<позади>> Луны.

С середины 60х годов прошлого века теория синхронизируемых автоматов начинает активно развиваться
ввиду многочисленных приложений таких автоматов в различных областях: тестировании реактивных систем,
роботике, символической динамике и др., см. обзоры \cite{MaSa99,Sa05,Vo_Survey}.  Остановимся чуть
подробней на одном из возможных будущих приложений -- области молекулярных вычислений. В недавних
экспериментах \cite{Benenson2003} Бененсон и др. использовали ДНК одновременно в качестве
компьютера и программного обеспечения, построив конечный автомат наноскопического размера.
Был создан <<бульон>> из автоматов, т.е.\ раствор, содержащий $3\times10^{12}$ копий одного
и того же автомата на микролитр. Все эти копии могут работать параллельно на разных входах и,
следовательно, заканчивать вычисления в разных и непредсказуемых состояниях. В отличие от
электронного компьютера, мы не можем перезапустить систему, просто нажав кнопку. Вместо этого,
чтобы одновременно перевести все автоматы в исходное состояние, нужно <<заправить>> бульон
достаточным количеством ДНК молекул, чья последовательность нуклеотидов кодирует синхронизирующее
слово для данного автомата.

С другой стороны, для математиков синхронизируемые автоматы сами по себе представляют интересный
комбинаторный объект, и их изучению уделяется большое внимание, прежде всего, в связи с
\emph{гипотезой Черни}. Для удобства в дальнейшем автомат с $n$ состояниями будем называть
$n$-автоматом. Черни в своей работе \cite{Ce64} построил серию $n$-автоматов над двухбуквенным
алфавитом, для которых кратчайшие синхронизирующие слова имеют длину $(n-1)^2$ (автомат на
рис.~1 является автоматом Черни для $n=4$). Позднее он предположил, что эта конструкция реализует
наихудший случай, т.е.\ что \emph{\textbf{любой синхронизируемый $n$-автомат
обладает синхронизирующим словом длины не более $(n-1)^2$}}. За годы, прошедшие с тех пор, было
предпринято множество попыток доказать или опровергнуть эту гипотезу, но ни одна из них не
увенчалась успехом -- гипотеза доказана лишь для многих частных классов автоматов, и  простота
ее формулировки до сих пор продолжает привлекать внимание многочисленных исследователей, см. \cite{Dubuc1998,Epp90,Kari2003,Ryst_97,Steinberg_TCS06,Traht2007,Vo_CIAA07,AnVolk_genmono}.


 \begin{figure}[ht]
\begin{center}
\unitlength=3pt
\begin{picture}(85,85)(-10,20)
\node(A)(-20,57){4} \node(B)(0,57){1} \node(C)(0,38){2}
\node(D)(-20,38){3} \drawedge(A,B){$a,b$} \drawedge(B,C){$a$}
\drawedge(C,D){$a$} \drawedge(D,A){$a$}
\drawloop[loopangle=45](B){$b$} \drawloop[loopangle=-45](C){$b$}
\drawloop[loopangle=-135](D){$b$} \node(AD)(20,38){34}
\node(AB)(20,57){14} \node(BC)(40,57){12} \node(CD)(40,38){23}
\node(AC)(60,57){24} \node(BD)(80,57){13}
\drawloop[loopangle=0](CD){$b$} \drawloop[loopangle=0](BD){$b$}
\drawloop[loopangle=45](BC){$b$}
\drawedge[linewidth=.5,AHLength=2,ELside=r](CD,AD){$a$}
\drawedge[linewidth=.5,AHLength=2](AD,AB){$a$}
\drawedge(AB,BC){$a$}
\drawedge[linewidth=.5,AHLength=2](BC,CD){$a$}
\drawedge[linewidth=.5,AHLength=2,curvedepth=5](AB,B){$b$}
\gasset{Nadjust=w,Nadjustdist=1.5,Nh=6,Nmr=2}
\node(ABC)(40,76){124} \node(ABD)(70,76){134}
\node(BCD)(40,95){123} \node(ACD)(70,95){234}
\node(ABCD)(10,95){1234} \drawloop(ABCD){$a$} \drawloop(BCD){$b$}
\drawedge[linewidth=.5,AHLength=2](ABCD,BCD){$b$}
\drawedge[linewidth=.5,AHLength=2,ELside=r](BCD,ACD){$a$}
\drawedge[curvedepth=-5,ELside=r](ACD,BCD){$b$}
\drawedge[linewidth=.5,AHLength=2](ACD,ABD){$a$}
\drawedge(ABC,BCD){$a$}
\drawedge[linewidth=.5,AHLength=2,ELside=r](ABD,ABC){$a$}
\drawedge[linewidth=.5,AHLength=2,curvedepth=-5,ELside=r](ABC,BC){$b$}
\drawedge[curvedepth=5](ABD,BD){$b$}
\drawedge[curvedepth=5](AC,BC){$b$}
\drawedge[curvedepth=5](BD,AC){$a$} \drawedge(AC,BD){$a$}
\drawedge[curvedepth=-20,ELside=r](AD,BD){$b$}
\end{picture}
\caption{Автомат подмножеств
$\mathcal{P}(\mathrsfs{C}_4$)}\label{fig:power automaton}
\end{center}
\end{figure}


Первый естественный вопрос, связанный с синхронизируемыми автоматами, следующий: 
\emph{как по данному автомату проверить, является ли он синхронизируемым?} Алгоритм
проверки данного автомата $\mathrsfs{A}=\langle Q,\Sigma,\delta\rangle$ на 
синхронизируемость получается непосредственно из классической конструкции 
\emph{автомата подмножеств} $\mathcal{P}(\mathrsfs{A})$. Множество состояний этого 
автомата определяется как множество $\mathcal{P}'(Q)$ всех непустых подмножеств 
множества $Q$, а функция переходов -- как естественное продолжение функции $\delta$ 
на множество $\mathcal{P}'(Q)\times\Sigma$ (это продолжение также обозначается через
$\delta$). На рис. \ref{fig:power automaton} приведен автомат подмножеств для автомата
$\mathrsfs{C}_4$, представленного на рис. \ref{fig:cerny}.
Ясно, что некоторое слово $w\in\Sigma^*$ синхронизирует автомат $\mathrsfs{A}$ тогда 
и только тогда, когда оно читается вдоль пути в автомате $\mathcal{P}(\mathrsfs{A})$ 
из состояния $Q$ в некоторое одноэлементное  подмножество. Таким образом, задача 
проверки синхронизируемости автомата сводится к задаче достижимости в графе, которая 
легко решается поиском в ширину. Несмотря на концептуальную простоту, описанный алгоритм 
не является эффективным, поскольку число состояний в автомате подмножеств экспоненциально 
зависит от числа состояний исходного автомата. Однако существует и полиномиальный 
алгоритм проверки автомата на синхронизируемость. Он основан на следующем наблюдении из \cite{Ce64}.
\begin{proposition} Автомат $\mathrsfs{A}=\langle Q,\Sigma,\delta\rangle$ является 
синхронизируемым тогда и только тогда, когда для любой пары состояний $q,q'\in Q$ 
существует слово $w\in\Sigma^*$ такое, что $q\dt w=q'\dt w.$
\end{proposition}
Иначе говоря, автомат является синхронизируемым тогда и только тогда, когда любую пару
$(q,q')$ состояний можно <<склеить>>, т.е.\ подходящим словом перевести $q$ и $q'$ в 
некоторое состояние $p$. Проверку этого условия можно осуществить поиском в ширину в 
\emph{автомате пар} $\mathcal{P}^{[2]}(\mathrsfs{A})$ -- подавтомате автомата подмножеств, 
в котором присутствуют лишь двух- и одноэлементные подмножества. Поскольку этот автомат 
имеет $\frac{|Q|(|Q|+1)}2$ состояний, то такой алгоритм работает за время $O(|Q|^2)$. 
Отметим, что он не дает на выходе никакого синхронизирующего слова, в отличие от первого 
алгоритма, на выходе которого получаются кратчайшие синхронизирующие слова. Лучший 
известный алгоритм, выдающий в случае синхронизируемости автомата некоторое 
синхронизирующее его слово, был найден Эпштейном в \cite{Epp90}. Он работает за время 
$O(|Q|^3)$ и находит синхронизирующее слово длины $O(|Q|^3)$. Вообще задача, в которой 
для заданного автомата $\mathrsfs{A}$ и заданного натурального числа $\ell$ требуется 
определить, имеет ли автомат $\mathrsfs{A}$ синхронизирующее слово длины не больше $\ell$, 
является NP-полной \cite{Epp90}. Самотий в работе \cite{Samotij2007} показал, что задача 
проверки того, что кратчайшее слово, синхронизирующее автомат $\mathrsfs{A}$ имеет длину
ровно $\ell$, является NP-трудной и co-NP-трудной. Таким образом, если co-NP$\ne$NP, эта 
задача не может принадлежать NP. Значит, даже недетерминированные алгоритмы не могут 
найти кратчайшее синхронизирующее слово для данного автомата за полиномиальное время.

Что касается верхних оценок длины кратчайших синхронизирующих слов, то лучшая оценка, 
известная на сегодняшний день,  принадлежит Пэну \cite{Pin1983}. Он показал, что для 
любого синхронизируемого $n$-автомата существует синхронизирующее слово длины не 
более $\frac{n^3-n}{6}$. Введем в рассмотрение \emph{функцию Черни} $\mathfrak{C}(n)$ 
как наибольшую длину кратчайших синхронизирующих слов для синхронизируемых $n$-автоматов. 
Тогда автоматы Черни из \cite{Ce64} дают нижнюю оценку $\mathfrak{C}(n)\ge(n-1)^2$, а 
гипотезу Черни можно переформулировать как $\mathfrak{C}(n)=(n-1)^2$.
С учетом верхней оценки справедливо следующее неравенство:
\begin{equation}\label{Bound_Pin}
(n-1)^2\le\mathfrak{C}(n)\le\frac{n^3-n}6.
\end{equation}


В дальнейшем усилия математиков были направлены на получение оценок функции Черни 
для различных частных классов автоматов. Было получено много интересных результатов, 
в качестве примера приведем некоторые из них.
Пусть $X$ -- некоторый класс синхронизируемых автоматов. Обозначим через $\mathfrak{C}_X(n)$ 
ограничение функции Черни на $X$.

1. В 1998 году Дюбук рассмотрел в работе \cite{Dubuc1998} класс \emph{циклических} 
синхронизируемых автоматов (обозначение --  $cycle$), т.е.\ автоматов, для которых 
существует буква, действующая на множестве состояний как циклическая перестановка и  
показал, что $\mathfrak{C}_{cycle}(n)\le(n-1)^2$. Отметим, что автоматы Черни попадают 
в этот класс, следовательно, верно $\mathfrak{C}_{cycle}(n)\ge(n-1)^2$. В итоге, 
$$\mathfrak{C}_{cycle}(n)=(n-1)^2.$$

2. В 2003 году Кари в своей работе \cite{Kari2003} доказал гипотезу Черни для класса 
$euler$ синхронизируемых автоматов, чей граф является эйлеровым. В действительности 
он доказал более сильное неравенство: $$\mathfrak{C}_{euler}\le(n-1)(n-2)+1.$$ Однако 
до сих пор не известно, является ли эта оценка точной.

3. \emph{Моноидом переходов} $M(\mathrsfs{A})$ автомата $\mathrsfs{A}=\langle Q,
\Sigma,\delta\rangle$ называется моноид (полугруппа с единицей, где в роли единицы 
выступает пустое слово $\lambda$) преобразований множества состояний $Q$, порожденный 
действием букв алфавита $\Sigma$ на этом множестве. Моноид называется 
\emph{апериодическим}, если все его подгруппы тривиальны; автомат называется 
\emph{апериодическим}, если его моноид переходов является апериодическим. Класс таких 
автоматов обозначим через $aper$. Апериодические автоматы играют важную роль во многих 
аспектах теории формальных языков, и изучение синхронизирующих слов для этого класса 
автоматов вполне оправданно. В 2007 году в работе \cite{Traht2007} Трахтман показал, 
что $\mathfrak{C}_{aper}(n)\le\frac{n(n-1)}{2}$. Тем не менее для всех известных на 
сегодняшний день нетривиальных примеров апериодических автоматов длина кратчайшего 
синхронизирующего слова является линейной функцией от числа состояний. Лучшая 
известная нижняя оценка для этого класса принадлежит Ананичеву \cite{Anan2005}: 
$\mathfrak{C}_{aper}(n)\ge n+\lfloor\frac{n}2\rfloor-2$, тем самым, $$n+\left\lfloor
\frac{n}2\right\rfloor-2\le\mathfrak{C}_{aper}(n)\le\frac{n(n-1)}{2}.$$

Стоит отметить, что при получении нижних оценок функции Черни для различных классов 
ситуация осложняется еще и тем, что известно мало примеров <<медленно>> 
синхронизируемых автоматов, т.е.\ $n$-автоматов с кратчайшим синхронизирующим 
словом длины $(n-1)^2$ или близкой к этому значению. Автоматы Черни -- единственная 
бесконечная серия таких <<экстремальных>> автоматов. Кроме того, существует несколько 
отдельных примеров автоматов с небольшим числом состояний над двух- и трехбуквенным 
алфавитом, на которых достигается оценка Черни. Вообще, вычислительные эксперименты 
показывают, что медленно синхронизируемые автоматы встречаются довольно редко. В 
пользу этого наблюдения говорят и вероятностные аргументы. Например, известно, что 
если $Q$ -- $n$-элементное множество, то (для достаточно большого $n$) произведение 
$2n$ случайно выбранных преобразований множества $Q$ в среднем является константным 
преобразованием \cite{Higg1988}. В терминах теории автоматов это означает, что 
произвольно выбранный $n$-автомат над алфавитом с достаточно большим количеством букв 
с большой вероятностью является синхронизируемым, причем словом длины, не 
превосходящей $2n$. Поэтому поиск серий наиболее медленно синхронизируемых автоматов 
в каждом классе представляет интересную и нетривиальную задачу. В главе \ref{Synch_zero} 
диссертации рассматривается эта задача для класса \emph{синхронизируемых автоматов с 
нулем}, т.е.\ автоматов, обладающих выделенным состоянием $0$, для которого $0\dt a=0$ 
для любой буквы $a\in \Sigma$. Отметим, что этот класс является особенно важным в связи 
с гипотезой Черни, так как известно, см., например, \cite[предложение~3]{Vo_CIAA07} что 
ее доказательство
в общем случае сводится к доказательству в двух
частных случаях: когда
автомат обладает нулем, и когда граф автомата является сильно-связным,
т.\,е.\ каждое состояние достижимо из любого другого.

\subsection{Предварительные сведения}

Чтобы зафиксировать используемые в работе терминологию и
обозначения, приведем основные определения из теории формальных языков и автоматов.
Через $|w|$ будем обозначать \emph{длину} слова $w$, т.\,е.\ число
входящих в него букв; длину \emph{пустого слова} $\lambda$ будем
считать равной нулю: $|\lambda|=0$.
Через $\Sigma^+$ будем обозначать множество всех непустых слов над алфавитом $\Sigma$,
а  через $\Sigma^k$ -- множество всех слов длины $k$ над $\Sigma$.
Слово $u\in \Sigma^+$ называется \emph{фактором} слова $w$
(соответственно \emph{префиксом}, \emph{суффиксом}), если  $w$
представимо в виде $w=xuy$ (соответственно $w=uy$, $w=xu$)
для некоторых $x,y\in \Sigma^*$. Фактор (префикс, суффикс) $u$ слова
$w$ называется \emph{собственным}, если $u\ne w.$


В теории формальных языков конечные детерминированные автоматы обычно рассматриваются как
устройства, распознающие языки. Для этого во множестве состояний
автомата выделяется начальное состояние $q_0$ и множество
заключительных состояний $F$. Говорят, что автомат
$\mathrsfs{A}=\langle Q,A,\delta,q_0,F\rangle$ \emph{распознает}
язык $L\subseteq A^*$, если
$$L=\{w\in A^*\mid \delta(q_0,w)\in F\},$$ т.е.\ все слова языка $L$ читаются вдоль всевозможных путей, ведущих из начального состояния в заключительные.
Язык называется \emph{регулярным}, если он распознается некоторым конечным детерминированным автоматом. Автомат с минимальным числом состояний, распознающий данный регулярный язык $L$, называется \emph{минимальным автоматом} языка $L$.

Кроме распознающих устройств, языки могут задаваться порождающими устройствами. Такими устройствами являются \emph{порождающие грамматики}.
Порождающей грамматикой $G$ называется четверка объектов $G=(V,\Sigma,P,S)$, где $V$ -- вспомогательный алфавит (алфавит \emph{нетерминальных} символов), $\Sigma$ -- основной алфавит (алфавит \emph{терминальных} символов), $S\in V$ -- \emph{аксиома} (начальный вспомогательный символ),
$P$ -- конечное множество \emph{правил вывода}, т.е.\ выражений вида $\alpha \rightarrow \beta$, где $\alpha,\beta\in {(V\cup\Sigma)}^*$.
Пусть $\gamma,\delta\in{(V\cup\Sigma)}^*$.
Слово $\delta$ непосредственно выводимо из $\gamma$ (обозначение $\gamma\Rightarrow\delta$),
если $\gamma=x\alpha y$, $\delta=x\beta y$, и  $\alpha \rightarrow \beta\in P.$
Через $\gamma\Rightarrow^+\delta$ обозначим транзитивное замыкание отношения $\Rightarrow$.

Языком, порождаемым грамматикой $G$, называется множество всех слов над $\Sigma$, выводимых из аксиомы:
$${\cal L}(G)=\{w\in\Sigma^* \mid S\Rightarrow^+ w\}.$$

Грамматики можно классифицировать по виду их правил вывода. Общепринятой классификацией грамматик и
порождаемых ими языков является иерархия Хомского.

\emph{Грамматика типа $0$} (рекурсивно-перечислимая грамматика) -- грамматика произвольного вида, без ограничений на правила вывода. Такие грамматики порождают класс \emph{рекурсивно перечислимых} языков, т.е.\ языков, принимаемых машинами Тьюринга.

\emph{Грамматика типа $1$} (контекстно зависимая грамматика) -- это грамматика, все правила вывода которой
имеют вид $\alpha_1 A\alpha_2\rightarrow\alpha_1\beta\alpha_2$, $A\in V$, $\alpha_1,\alpha_2,\beta\in{(V\cup\Sigma)}^*.$ Класс языков, порождаемых контекстно зависимыми грамматиками, совпадает с классом языков, распознаваемых машинами Тьюринга, использующими линейную память.

\emph{Грамматика типа $2$} (контекстно свободная грамматика) -- грамматика, все правила вывода
которой имеют вид $A\rightarrow\beta$, $A\in V$, $\beta\in {(V\cup\Sigma)}^*.$

\emph{Грамматика типа $3$} (регулярная грамматика) -- все правила вывода
имеют вид $A\rightarrow aB$  или  $A\rightarrow b$, $A,B\in V$,  $a,b\in{\Sigma}^*.$ Класс языков, порождаемых регулярными грамматиками, совпадает с классом регулярных языков.


\begin{center}\textbf{Предварительные сведения из теории сложности вычислений}\end{center}

Рассматриваемые в теории сложности вычислений задачи являются \emph{массовыми задачами распознавания}, объединяющими в себе множество конкретных задач. Стандартная форма описания таких задач состоит из УСЛОВИЯ и ВОПРОСА, предполагающего один из двух ответов -- <<да>> или <<нет>>. Каждая конкретизация массовой задачи получается фиксированием УСЛОВИЯ. \emph{Размером} задачи называется длина ее записи на ленте машине Тьюринга. Задача принадлежит классу сложности P, если она решается за полиномиальное время от ее размера на \emph{детерминированной машине Тьюринга} (см. \cite{GarJons82,Papa94}).  Задача принадлежит классу сложности NP, если существует \emph{недерминированная машина Тьюринга}, решающая ее за полиномиальное время.  Если угадав каким-то образом ответ задачи, мы можем его проверить за полиномиальное время на детерминированной машине Тьюринга, то такая задача называется \emph{задачей полиномиальной проверкой}. Все такие задачи, очевидно, принадлежат классу NP. Задача принадлежит классу co-NP, если ее отрицание принадлежит NP. Нетрудно видеть, что если задача принадлежит классу NP, то для нее существует экспоненциальный по времени алгоритм решения.  При естественном (с практической точки зрения) предположении, что P$\ne$NP, задачи из класса P считаются <<легкими>>, а задачи из класса NP, для которых не известен полиномиальный алгоритм решения, -- <<труднорешаемыми>>. Конечно, поскольку до сих пор не доказано, что P$\ne$NP, нет никакой надежды показать, что некоторая задача $A$ принадлежит NP$\setminus$P. По этой причине в теории сложности вычислений доказываются более слабые результаты вида: <<если P$\ne$NP, то $A\in$NP$\setminus$P>>. Подобные доказательства основаны на идее полиномиальной сводимости. Задача $A$ \emph{полиномиально сводится} к задаче $B$, если существует полиномиальный от размера задачи $A$ алгоритм $f$, который по каждой конкретизации $a$ задачи $A$ строит конкретизацию $f(a)$ задачи $B$ так, что размер построенной задачи $f(a)$ полиномиально зависит от размера задачи $a$;  ответ на задачу $a$ положителен тогда и только тогда, когда ответ на задачу $f(a)$ также положителен.


Задача называется NP[co-NP]-трудной, если к ней полиномиально сводится любая задача из класса NP[co-NP]. Если NP[co-NP]-трудная задача принадлежит классу NP[co-NP], то она называется NP[co-NP]-полной. Честь быть <<первой>> NP-полной задачей выпала на долю задачи \verb"ВЫПОЛНИМОСТЬ". Результат о ее NP-полноте, независимо полученный Куком \cite{Cook71} и Левиным \cite{Levin73}, позволил с тех пор доказать вычислительную трудность широкого класса алгоритмических задач. Напомним, что под задачей \verb"ВЫПОЛНИМОСТЬ" понимается следующая задача распознавания:

\begin{description}
\item[УСЛОВИЕ:] набор булевых переменных $X_1,\ldots,X_n$ и \emph{клозов} $c_1,\ldots,c_m$ (дизъюнкций переменных или их отрицаний);

\item[ВОПРОС:] существует ли приписывание значений истинности переменным так, что булева формула $\wedge_{i=1}^mc_i$ становится истиной?
\end{description}

\newpage
\subsection{Апробация результатов}

Основные результаты диссертации опубликованы в \cite{Pri_IAC_05,Pri_LNCS_05,Prib_06,PriRoda,Pri_WSA_05,Pri_Auth07,Prib_IZV08,PriRoda_TUCS}. Совместные работы \cite{PriRoda,PriRoda_TUCS} с Э. Родаро выполнены в нераздельном соавторстве. Работа \cite{Prib_06} опубликована в издании, входящем в перечень утвержденных ВАК.

\bigskip
Ссылки на результаты диссертации присутствуют в работах других авторов: \cite{APV_survey,ChKiPi,ChKiPi_DMTCS09,CheKi_05,CheKi_09,Che_survey2007,Petrov_06,ChGK}.

\bigskip
Основные результаты диссертации докладывались на международном симпозиуме по математическим 
основам компьютерных наук MFCS 2010 (Брно, Чехия, 2010), международной конференции по формальным 
языкам DLT 2011 (Милан, Италия, 2011), международном семинаре по проблемам достижимости RP 2011 (Генуя,
Италия, 2011), международной конференции по реализации и применению автоматов CIAA 2012 (Порто,
Португалия, 2012).

Автор выражает глубокую благодарность своему научному руководителю профессору М.~В.~Волкову за 
постановки задач и постоянное внимание к работе.

\newpage


%------------------------Примитивные орграфы с большими экспонентами и медленно синхронизируемые автоматы----------------------------------------------
\section{Примитивные орграфы с большими экспонентами и медленно синхронизируемые автоматы}
\label{ch:SlowSynch}

В этой главе мы приводим несколько бесконечных серий синхронизируемых автоматов, для каждого
из которых  длина кратчайшего синхронизирующего слова близка к квадрату числа
состояний. Все эти автоматы тесно связаны с примитивными ориентированными
графами с большими экспонентами.

\subsection{Постановка задачи и структура работы}

Данная работа выросла из попытки теоретически объяснить результаты некоторых
численных экспериментов по синхронизации конечных автоматов. Напомним, что
(\emph{детерминированным конечным}) \emph{автоматом} называется тройка
$\mathrsfs{A}=\langle Q,\Sigma,\delta\rangle$, где $Q$ -- конечное
\emph{множество состояний}, $\Sigma$ -- конечный \emph{входной алфавит}, а
$\delta:Q\times\Sigma\to Q$ -- всюду определенная \emph{функция переходов}. Как
обычно, через $\Sigma^*$ обозначаем множество всех конечных слов над алфавитом
$\Sigma$, включая пустое слово 1. Функция $\delta$ естественным образом
продолжается на $Q\times\Sigma^*$: для $q\in Q$ и $w\in\Sigma^*$ полагаем
$\delta(q,w)=q$, если $w=1$, и $\delta(q,w)=\delta(\delta(q,v),a)$, если $w=va$
для некоторого $v\in\Sigma^*$ и $a\in\Sigma$. Таким образом, функция $\delta$
определяет действие каждого слова из $\Sigma^*$ на множестве $Q$.

Автомат $\mathrsfs{A}=\langle Q,\Sigma,\delta\rangle$ называется
\emph{синхронизируемым}, если найдется слово $w\in\Sigma^*$, под действием
которого все состояния переходят в одно: $\delta(q,w)=\delta(q',w)$ для всех
$q,q'\in Q$. Всякое такое слово $w$ называется \emph{синхронизирующим} для
$\mathrsfs{A}$. Минимум длин синхронизирующих слов автомата $\mathrsfs{A}$
называется его \emph{порогом синхронизации}.

Синхронизируемые автоматы представляют собой очень простую и естественную
модель систем, устойчивых к ошибкам. Они используются во многих прикладных
областях (тестирование систем и протоколов, кодирование информации, роботика) и
в то же время неожиданным образом возникают в некоторых разделах
фундаментальной математики (символическая динамика, теория подстановочных
систем и др.). Основы теории синхронизируемых автоматов и ее разнообразные
связи и приложения обсуждаются, например, в недавних обзорах~\cite{Sa05,Vo08}.
В данной работе затрагивается только один аспект этой теории, а именно, вопрос
о том, как зависит порог синхронизации автомата от числа его состояний.

Условимся для краткости называть автомат с $n$ состояниями
$n$-\emph{ав\-то\-ма\-том}. В~1964 г.\ Черни~\cite{Ce64} указал серию
синхронизируемых $n$-автоматов с порогом синхронизации $(n-1)^2$. Немного
позднее он высказал предположение, что автоматы из этой серии реализуют
наихудший (в смысле скорости синхронизации) случай, т.\,е. что каждый
синхронизируемый $n$-автомат может быть синхронизирован словом длины не более
$(n-1)^2$. За этим предположением закрепилось имя \emph{гипотеза Черни}.
Несмотря на простоту формулировки и усилия многочисленных исследователей,
гипотеза Черни остается недоказанной и неопровергнутой уже более 45 лет. Более
того, до сих пор нет верхней оценки порядка $\Theta(n^2)$ на порог
синхронизации произвольного $n$-автомата\footnote{На сегодняшний день лучшей
верхней оценкой на порог синхронизации произвольного $n$-автомата остается
оценка $\frac{n^3-n}6$, полученная Пэном~\cite{Pi83} еще в 1983 г. Чуть лучшая
оценка $\frac{n(7n^2+6n-16)}{48}$ опубликована недавно в~\cite{Tr11}, но в ее
доказательстве имеется неясное место.}.

Почему гипотеза Черни оказывается столь неприступной? Развернутое обсуждение
этого важного вопроса выходит за рамки данной работы, но одно из затруднений, с
которым приходится сталкиваться в теории синхронизируемых автоматов, здесь
уместно обозначить. Мы имеем в виду дефицит примеров \emph{экстремальных}
автоматов, т.\,е.\ $n$-автоматов с порогом синхронизации $(n-1)^2$.
Единственной известной на сегодня бесконечной серией экстремальных автоматов
остается серия, приведенная в~\cite{Ce64}. Кроме нее, известно лишь несколько
спорадических примеров экстремальных автоматов, наибольшим из которых по числу
состояний является 6-автомат, открытый Кари~\cite{Ka01} в 2001 г. (Полный
список известных экстремальных автоматов см.\ в~\cite{Vo08}.) Более того, до
сих пор даже $n$-автоматы с порогом синхронизации, близким к $(n-1)^2$,
встречались в литературе крайне редко -- кроме серии Черни, здесь можно назвать
только серии из~\cite{AVZ}. В условиях, когда число примеров крайне ограничено,
трудно было подвергать проверке различные предположения и допущения,
возникавшие при поисках подходов к гипотезе Черни. Именно поэтому история
исследований в данной области богата <<ложными следами>> -- вспомогательными
гипотезами, которые сперва казались перспективными, но по прошествии некоторого
времени опровергались. (Ряд таких <<ложных следов>> проанализирован
в~\cite{Be11}.)

Как же находить медленно синхронизируемые автоматы? Эксперименты (см.,
например, \cite{ST11}) показывают, что взятый наугад автомат с вероятностью,
очень близкой к~1, синхронизируем словом, длина которого значительно меньше
числа состояний. Поэтому случайно натолкнуться на автомат, порог синхронизации
которого близок к квадрату числа состояний, невозможно. Приходится выявлять
такие автоматы путем исчерпывающего перебора. Именно такой переборный
эксперимент и послужил отправной точкой данной работы.

Методика и некоторые результаты эксперимента описаны в \S2. Наше внимание
привлекло сходство между наблюдаемым поведением количества синхронизируемых
автоматов с фиксированным числом состояний как фун\-кции от значения порога
синхронизации и хорошо изученным поведением количества примитивных орграфов с
фиксированным числом вершин как функции от значения экспоненты. В \S3 мы
обсуждаем это сходство, предварительно напомнив необходимые понятия и факты из
теории примитивных орграфов. Основные результаты работы содержатся в \S4. Мы
показываем, что медленно синхронизируемые автоматы, обнаруженные в нашем
эксперименте, являются представителями бесконечных серий и что каждая такая
серия тесно связана с некоторой известной серией примитивных орграфов с большой
экспонентой. Установленная связь между орграфами и автоматами позволила дать
прозрачные и единообразные доказательства утверждений о пороге синхронизации
для всех без исключения серий медленно синхронизируемых автоматов -- как для
серий, уже встречавшихся в литературе, так и для серий, впервые появившихся в
данной работе. Техника, примененная в этих доказательствах, насколько нам
известно, является новой и, на наш взгляд, представляет самостоятельный
интерес. В заключительном \S5 обсуждаются дальнейшие перспективы подхода,
развитого в работе, и формулируется ряд новых гипотез.

\subsection{Методика и некоторые результаты эксперимента}

Как отмечено в \S1, поиск автоматов с порогом синхронизации, близким к квадрату
числа состояний, требует исчерпывающего перебора. Поскольку число $n$-автоматов
стремительно растет с ростом $n$, такой перебор должен быть разумным образом
организован. Так, задание 9-автомата с двумя входными буквами равносильно
заданию пары функций на 9-элементном множестве. Число таких пар равно
$9^{18}\approx 1.50\times 10^{17}$, и если потратить на вычисление порога
синхронизации каждого заданного таким образом автомата одну наносекунду, то
полный перебор займет около пяти лет. Понятно, что при задании $n$-автоматов с
$k$ входными буквами наборами из $k$ функций на $n$-элементном множестве каждый
автомат будет порождаться $n!k!$ раз. Однако ускорить процесс перебора за счет
отбрасывания изоморфных автоматов невозможно -- даже при $n=9$ и $k=2$ на
проверку того, изоморфен ли очередной автомат какому-либо из уже просмотренных,
не хватит ни времени, ни памяти.

Мы использовали для оптимизации перебора строковое представление достижимых
автоматов, предложенное в~\cite{AMR}. Напомним, что автомат
$\mathrsfs{A}=\langle Q,\Sigma,\delta\rangle$ называется \emph{достижимым} (из
состояния $q_0$), если из $q_0$ можно попасть в любое наперед заданное
состояние, применив подходящее слово: для любого $q\in Q$ существует
$w\in\Sigma^*$ такое, что $q=\delta(q_0,w)$. Автомат, достижимый из каждого
своего состояния, называется \emph{сильно связным}. В общем случае
синхронизируемый автомат может не быть достижимым и тем более сильно связным.
Однако хорошо известно, что в рассмотрениях, связанных с гипотезой Черни, можно
ограничиться сильно связными автоматами. Дело в том, что имеет место следующий
несложный результат.
\begin{proposition}[\!\!{\mdseries\cite[предложение~2.1]{Vo09}}]
\label{reduction} Пусть $\mathrsfs{A}=\langle Q,\Sigma,\delta\rangle$ --
синхронизируемый автомат, а $S$ -- множество тех состояний, к которым
$\mathrsfs{A}$ можно синхронизировать. Тогда $\mathrsfs{S}=\langle
S,\Sigma,\delta|_S\rangle$ -- сильно связный подавтомат в $\mathrsfs{A}$ и  для
любой функции $f:\mathbb{Z}^+\to\mathbb{N}$, удовлетворяющей неравенствам
$$f(n)\ge\frac{n(n-1)}2\ \text{ и }\ f(n)\ge f(n-m+1)+f(m) \text{ при } n\ge m\ge 1,$$
из того, что порог синхронизации автомата $\mathrsfs{S}$
ограничен числом $f(|S|)$, вытекает, что порог синхронизации для $\mathrsfs{A}$
не превосходит $f(|Q|)$.
\end{proposition}
В частности, беря в качестве $f(n)$ функцию $(n-1)^2$, можно заключить, что
если $\mathrsfs{A}$ -- контрпример к гипотезе Черни, то и его сильно связный
подавтомат $\mathrsfs{S}$ необходимо будет контрпримером. Аналогично, если
$\mathrsfs{A}$ -- автомат с порогом синхронизации, близким к квадрату числа
состояний, то таков и сильно связный автомат $\mathrsfs{S}$. Таким образом,
ограничивая перебор достижимыми автоматами, мы не рискуем пропустить
контрпример к~гипотезе Черни или какой-нибудь интересный медленно
синхронизируемый автомат.

Опишем теперь строковое представление из~\cite{AMR}. Пусть $\mathrsfs{A} =
\langle Q, \Sigma, \delta\rangle$ -- автомат, достижимый из состояния $q_0$.
Зафиксируем некоторый линейный порядок на входном алфавите $\Sigma$ и обойдем
автомат поиском в ширину из $q_0$, выбирая исходящие переходы в соответствии с
этим порядком. Присвоим состоянию $q_0$ номер 0, а остальные состояния из $Q$
пронумеруем в порядке их посещения при указанном обходе. Например, состояния
автомата на рис.~\ref{fig:AMR} при алфавитном упорядочении входных букв $a<b<c$
и выборе состояния $A$ в качестве $q_0$ будут пронумерованы так:
\begin{tabular}{c|c|c|c}
$A$ & $B$ & $C$ & $D$\\
\hline 0 & 2 & 1& 3\end{tabular}\,.

\begin{figure}[ht]
\begin{center}
\unitlength .8mm
\begin{picture}(84,45)(0,-60)
\gasset{Nw=11.0,Nh=11.0,Nmr=5.5}
\node[iangle=90.0,ilength=6.0,Nmarks=i](n1)(23.99,-24.0){$A$}
\node(n2)(60.49,-24.25){$C$} \node(n3)(59.9,-56.18){$D$}
\node(n6)(25.06,-56.08){$B$} \drawloop[loopangle=180.0](n1){$c$}
\drawloop[loopangle=0.0](n3){$b$} \drawloop[loopangle=180.0](n6){$c$}
\drawedge[curvedepth=3.6](n1,n2){$a$} \drawedge[curvedepth=3.6](n2,n1){$c$}
\drawedge[ELside=r,curvedepth=-3.6](n3,n2){$a$}
\drawedge[ELside=r,curvedepth=-3.6](n2,n3){$b$}
\drawedge[ELside=r,curvedepth=-3.6](n6,n1){$b$}
\drawedge[ELside=r,curvedepth=-3.6](n1,n6){$b$}
\drawedge[curvedepth=3.6](n6,n3){$a$} \drawedge[curvedepth=3.6](n3,n6){$c$}
\drawedge(n2,n6){$a$}
\end{picture}
\caption{Автомат с канонической строкой
$[1,2,0,2,3,0,3,0,2,1,3,2]$}\label{fig:AMR}
\end{center}
\end{figure}

\noindent Каждому состоянию $q$ автомата $\mathrsfs{A}$ сопоставим строку длины
$|\Sigma|$, в которой на позиции $i$ стоит порядковый номер того состояния, в
которое $q$ переходит под действием $i$-й буквы. Соединив все такие строки в
порядке возрастания номеров состояний, получим строку чисел из множества
$\{0,1,\dots,|Q|-1\}$, которая имеет длину $|Q||\Sigma|$ и однозначно
определяет $\mathrsfs{A}$. Мы будем называть ее \emph{канонической строкой}
автомата $\mathrsfs{A}$. Так, для автомата на рис.~\ref{fig:AMR} каноническая
строка имеет вид $[1,2,0,2,3,0,3,0,2,1,3,2]$.

Несложно проверить (см.~\cite[теорема~5]{AMR}), что строка
$[s_0,\dots,s_{nk-1}]$ чисел из множества $\{0,1,\dots,n-1\}$ будет
канонической строкой некоторого достижимого $n$-автомата с $k$ входными буквами
тогда и только тогда, когда она удовлетворяет двум условиям:
\begin{enumerate}
\item[(R1)] для каждого $i$ такого, что $s_i>1$, найдется такое $j<i$, что $s_j = s_i-1$,
\item[(R2)] для каждого $m$ такого, что $1{\le}m{<}n$, найдется такое $j{<}mk$,
что $s_j=m$.
\end{enumerate}

Опираясь на это наблюдение, мы вычисляли пороги синхронизации для достижимых
$n$-автоматов с двумя входными буквами следующим образом. Для вычислений
использовался 128-ядерный кластер на базе процессоров AMD Opteron с тактовой
частотой 2.6 ГГц. Кластер, принадлежащий Институту математики и механики УрО
РАН, работает под управлением ОС Linux, имеет 256 ГБ оперативной памяти и
пиковую производительность 665.6 Гфлопс. Один узел кластера генерировал
относительно небольшие порции строк, удовлетворяющих (R1) и (R2), и раздавал
остальным узлам, которые обрабатывали соответствующие порции автоматов
параллельно. Для организации данного процесса использовалась известная
библиотека MPI. Проверка каждого автомата на синхронизируемость и вычисление
порога синхронизации производились с помощью стандартных алгоритмов
(см.~\cite{Sa05,Vo08}). Оба этих алгоритма были реализованы на C. Отметим, что
алгоритм проверки синхронизируемости очень быстр, так как работает с орграфом
пар состояний, в то время как алгоритм вычисления порога синхронизации работает
с орграфом непустых подмножеств состояний и в наихудшем случае время его работы
экспоненциально зависит от размера исходного автомата\footnote{Известно
(см.~\cite[теорема~4]{OU10}), что задача вычисления порога синхронизации
данного автомата полна для класса сложности $\mathsf{FP}^\mathsf{NP[log]}$ --
функционального аналога класса $\mathsf{P}^\mathsf{NP[log]}$ задач
распознавания, разрешимых за полиномиальное время на детерминированной машине
Тьюринга, которая может логарифмическое от размера задачи число раз обращаться
за подсказкой к оракулу для $\mathsf{NP}$-полной задачи.}. Однако на практике
порог синхронизации вычисляется довольно быстро, поскольку, как отмечалось в
\S1, для подавляющего большинства автоматов он мал.

Хотя задание автоматов с помощью канонических строк существенным образом
сокращает перебор (нетрудно понять, например, что при таком задании каждый
$n$-автомат с двумя входными буквами порождается не более $2n$ раз), его объем
все равно остается значительным. Так, при $n=9$ число автоматов, которые
пришлось проанализировать, составило 705\,068\,085\,303.  Тем не менее,
благодаря распараллеливанию, вычисления при $n=9$ заняли меньше суток.

Результатом вычислений являлся массив, в котором для каждого встретившегося
значения порога синхронизации указывалось число автоматов, реализующих это
значение. Наиболее значимая для нас часть результатов, относящаяся к медленно
синхронизируемым автоматам, была затем перепроверена с помощью пакета
TESTAS~\cite{Tr06}.

Табл.~\ref{automata} содержит фрагмент массива результатов, полученных в случае
$n=9$. Количество автоматов в ней указано с точностью до изоморфизма.
\begin{table}[ht]
\tabcolsep=4.8pt \caption{Пороги синхронизации 9-автоматов
с двумя входными буквами} \label{automata} {\small
\begin{tabular}{|p{2.9cm}||c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
\hline
\centering{$N$} & 64 & 63 & 62 & 61 & 60 & 59 & 58 & 57 & 56 & 55 & 54 & 53 & 52 & 51 \\
\hline \raggedright{Число автоматов с порогом синхронизации $N$}
&\raisebox{-11pt}{1} &\raisebox{-11pt}{0} &\raisebox{-11pt}{0}
&\raisebox{-11pt}{0} &\raisebox{-11pt}{0} &\raisebox{-11pt}{0}
&\raisebox{-11pt}{1} &\raisebox{-11pt}{2} &\raisebox{-11pt}{3}
&\raisebox{-11pt}{0} &\raisebox{-11pt}{0} &\raisebox{-11pt}{0}
&\raisebox{-11pt}{4} &\raisebox{-11pt}{4} \\
\hline
\end{tabular}}
\end{table}

Понятно, что единственный автомат в столбце, отвечающем $N=64$, -- это
9-автомат из серии Черни. Далее наблюдается разрыв: 9-автоматов с двумя
входными буквами и значением порога синхронизации от 59 до 63 не существует.
Данный разрыв уже упоминался в работах Трахтмана~\cite{Tr06,Tr06a}, где
отмечалось, что при $n=7,8,9,10$ его эксперименты не обнаружили ни одного
$n$-автомата с двумя входными буквами, порог синхронизации которого был бы
больше $n^2-3n+4$, но меньше $n^2-2n+1$. За разрывом следует <<остров>> из трех
значений, достигаемых на 6 автоматах, а за этим <<островом>> снова наблюдается
разрыв. Этот второй разрыв, насколько нам известно, ранее не отмечался в
литературе.

Описанное только что поведение исследуемой величины -- одинокое экстремальное
значение, за которым следуют разрыв, небольшой <<остров>> и еще один разрыв --
проявляется и для автоматов с б\'ольшим числом состояний. При этом размеры
<<острова>> зависят только от четности числа состояний, а размеры разрывов
растут вместе c числом состояний как линейные функции. Сходным образом ведет
себя другая величина, исследовавшаяся в дискретной математике, -- количество
примитивных орграфов с фиксированным числом вершин и данным значением
экспоненты. В следующем параграфе мы напомним соответствующие понятия и обсудим
указанное сходство подробнее.

\subsection{Примитивные орграфы и их экспоненты}

\emph{Орграф} (т.\,е. ориентированный граф) -- это пара $D=\langle V,E\rangle$,
где $V$ -- конечное множество и $E\subseteq V\times V$. Элементы множеств $V$ и
$E$ будем называть соответственно \emph{вершинами} и \emph{дугами}. Отметим,
что данное определение допускает петли, но исключает кратные дуги. Если
$v,v'\in V$ и $e=(v,v')\in E$, то дуга $e$ называется \emph{исходящей} из $v$.
Мы предполагаем, что читатель знаком с основными понятиями теории орграфов,
такими как маршрут (ориентированный путь), контур (ориентированный цикл),
изоморфизм и~т.\,д.

\emph{Матрица смежности} (или просто матрица) орграфа $D=\langle V,E\rangle$ --
это $V\times V$-матрица, в которой элемент в строке $v$ и столбце $v'$ равен 1,
если $(v,v')\in E$, и равен 0 в противном случае. Обратно, $n\times n$-матрице
$P=(p_{ij})$ с неотрицательными действительными элементами можно сопоставить
орграф $D(P)$ на множестве $\{1,2,\dots,n\}$, в котором пара $(i,j)$ будет
дугой, если и только если $p_{ij}>0$. Указанное соответствие между матрицами и
орграфами позволяет переформулировать на языке орграфов ряд важных понятий и
результатов, возникших в классической теории неотрицательных матриц (теории
Перрона--Фробениуса).

Орграф $D=\langle V,E\rangle$ называется  \emph{сильно связным}, если для
всякой пары $(v,v')\in V\times V$ найдется маршрут из $v$ в $v'$. Сильно
связный орграф $D$ называется \emph{примитивным}, если наибольший общий
делитель длин всех контуров в $D$ равен~1. В литературе такие орграфы иногда
называют \emph{апериодическими}. Наш выбор термина обусловлен тем, что орграф
обладает указанным свойством тогда и только тогда, когда его матрица примитивна
в смысле теории Перрона--Фробениуса, т.\,е.\ когда у этой матрицы есть
положительное собственное значение, строго большее модуля любого из ее
остальных собственных значений.

Под $t$-й \emph{степенью} орграфа $D=\langle V,E\rangle$ понимается орграф
$D^t$ с тем же множеством вершин $V$, в котором пара $(v,v')\in V\times V$
является дугой, если и только если в $D$ найдется маршрут из $v$ в $v'$ длины в
точности $t$. Нетрудно видеть, что если $M$ -- матрица орграфа $D$, то орграф
$D^t$ изоморфен орграфу $D(M^t)$, где $M^t$ -- обычная $t$-я степень матрицы
$M$. Известно (см., например, \cite[с.\,226]{ST00}), что если $D$ --
примитивный орграф, то для некоторого $t$ его степень $D^t$ есть полный орграф
с петлями, т.\,е.\ в $D^t$ все пары вершин являются дугами. На языке матрицы
орграфа это означает, что каждый элемент матрицы $M^t$ положителен. Наименьшее
число $t$ с таким свойством называется \emph{экспонентой} орграфа $D$ и
обозначается через $\gamma(D)$. Экспоненты орграфов служат объектом
интенсивного изучения на протяжении последних 60 лет, обзор накопленных в этой
области фактов см., например, в~\cite{BrRy91}. В данной работе потребуются лишь
несколько классических результатов, собранных в следующем утверждении. В нем (и
далее в работе) орграф с $n$ вершинами для краткости именуется
$n$-\emph{орграфом}.

\begin{theorem}
\label{dulmage} \emph{(a) (Теорема Виландта, см.\ \cite{Wi50,DM62,DM64})} Если
$D$ -- примитивный $n$-орграф, то $\gamma(D)\le(n-1)^2+1$.

\emph{(b) \cite[теорема~6 и следствие~4]{DM64}} Если $n>2$, то с точностью до
изоморфизма есть ровно один примитивный $n$-орграф с экспонентой $(n-1)^2+1$ и
ровно один примитивный $n$-орграф с с экспонентой $(n-1)^2$. Матрицы этих
орграфов суть соответственно
\begin{equation}
\label{wielandt}
\begin{pmatrix}
0 & 1 & 0 & \dots & 0 & 0\\
0 & 0 & 1 & \dots & 0 & 0\\
\hdotsfor{6}\\
0 & 0 & 0 & \dots & 0 & 1\\
1 & 1 & 0 & \dots & 0 & 0
\end{pmatrix} \text{ и }
\begin{pmatrix}
0 & 1 & 0 & \dots & 0 & 0\\
0 & 0 & 1 & \dots & 0 & 0\\
\hdotsfor{6}\\
1 & 0 & 0 & \dots & 0 & 1\\
1 & 1 & 0 & \dots & 0 & 0
\end{pmatrix}.
\end{equation}

\emph{(c) \cite[теорема~7]{DM64}} Если $n>4$ и $n$ четно, то нет ни одного
примитивного $n$-орграфа $D$, для которого $n^2-4n+6<\gamma(D)<(n-1)^2$. С
точностью до изоморфизма существуют ровно три, если $n$ кратно трем, или ровно
четыре, если $n$ не кратно трем, примитивных $n$-орграфа с экспонентой
$n^2-4n+6$.

\emph{(d) \cite[теорема~8]{DM64}} Если $n>3$ и $n$ нечетно, то нет ни одного
примитивного $n$-орграфа $D$, для которого $n^2-3n+4<\gamma(D)<(n-1)^2$. С
точностью до изоморфизма есть ровно один примитивный $n$-орграф с экспонентой
$n^2-3n+4$, ровно один примитивный $n$-орграф с экспонентой $n^2-3n+3$, и ровно
два примитивных $n$-орграфа с экспонентой $n^2-3n+2$. Матрицы этих орграфов
суть соответственно
\begin{gather}
\label{odd island}
\begin{pmatrix}
0 & 1 & 0 & \dots & 0 & 0\\
0 & 0 & 1 & \dots & 0 & 0\\
\hdotsfor{6}\\
0 & 0 & 0 & \dots & 1 & 0\\
0 & 0 & 0 & \dots & 0 & 1\\
1 & 0 & 1 & \dots & 0 & 0
\end{pmatrix},\quad
\begin{pmatrix}
0 & 1 & 0 & \dots & 0 & 0\\
0 & 0 & 1 & \dots & 0 & 0\\
\hdotsfor{6}\\
0 & 0 & 0 & \dots & 1 & 0\\
0 & 1 & 0 & \dots & 0 & 1\\
1 & 0 & 1 & \dots & 0 & 0
\end{pmatrix},\\
\label{odd island1}
\begin{pmatrix}
0 & 1 & 0 & \dots & 0 & 0\\
0 & 0 & 1 & \dots & 0 & 0\\
\hdotsfor{6}\\
1 & 0 & 0 & \dots & 1 & 0\\
0 & 1 & 0 & \dots & 0 & 1\\
1 & 0 & 1 & \dots & 0 & 0
\end{pmatrix}, \quad
\begin{pmatrix}
0 & 1 & 0 & \dots & 0 & 0\\
0 & 0 & 1 & \dots & 0 & 0\\
\hdotsfor{6}\\
1 & 0 & 0 & \dots & 1 & 0\\
0 & 0 & 0 & \dots & 0 & 1\\
1 & 0 & 1 & \dots & 0 & 0
\end{pmatrix}.
\end{gather}

\emph{(e) \cite[теорема~8]{DM64}} Если $n>3$ и $n$ нечетно, то нет ни одного
$n$-орграфа $D$, для которого $n^2-4n+6<\gamma(D)<n^2-3n+2$. С точностью до
изоморфизма существуют ровно три, если $n$ кратно трем, или ровно четыре, если
$n$ не кратно трем, примитивных $n$-орграфа с экспонентой $n^2-4n+6$.
\end{theorem}

В табл.~\ref{9 states} экспериментальные данные из табл.~\ref{automata}
сопоставлены с информацией, которую можно извлечь из теоремы~\ref{dulmage}.

\begin{table}[ht]
\caption{Экспоненты примитивных 9-орграфов
и пороги синхронизации 9-автоматов с двумя входными буквами} \label{9 states}
{\small
\begin{tabular}{|p{2.9cm}||c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|} \hline
\centering{$N$} & 65 & 64 & 63 & 62 & 61 & 60 & 59 & 58 & 57 & 56 & 55 & 54 & 53 & 52 & 51 \\
\hline \raggedright{Число орграфов с~экспонентой $N$} & \raisebox{-6pt}{1} &
\raisebox{-6pt}{1} & \raisebox{-6pt}{0} & \raisebox{-6pt}{0} &
\raisebox{-6pt}{0} & \raisebox{-6pt}{0} & \raisebox{-6pt}{0} &
\raisebox{-6pt}{1} & \raisebox{-6pt}{1} & \raisebox{-6pt}{2}
& \raisebox{-6pt}{0} & \raisebox{-6pt}{0} & \raisebox{-6pt}{0} & \raisebox{-6pt}{0} & \raisebox{-6pt}{3} \\
\hline \raggedright{Число автоматов с порогом синхронизации $N$}
&\raisebox{-11pt}{0} &\raisebox{-11pt}{1} &\raisebox{-11pt}{0}
&\raisebox{-11pt}{0} &\raisebox{-11pt}{0} &\raisebox{-11pt}{0}
&\raisebox{-11pt}{0} &\raisebox{-11pt}{1} &\raisebox{-11pt}{2}
&\raisebox{-11pt}{3}
&\raisebox{-11pt}{0} &\raisebox{-11pt}{0} &\raisebox{-11pt}{0} &\raisebox{-11pt}{4} &\raisebox{-11pt}{4} \\
\hline
\end{tabular}}
\end{table}

Сходство между второй и третьей строками табл.~\ref{9 states} очевидно.
Аналогичное сходство проявляется при сравнении данных для других размеров
автоматов/орграфов. Нам представляется, что обнаруженное сходство не случайно,
а напротив, отражает глубокие и, возможно, еще не до конца проясненные
взаимосвязи между примитивными орграфами и синхронизируемыми автоматами.
Некоторые из этих взаимосвязей были вскрыты при изучении так называемой
проблемы раскраски дорог. Напомним соответствующие понятия.

\emph{Орграфом} автомата $\mathrsfs{A}=\langle Q,\Sigma,\delta\rangle$ будем
называть орграф $D(\mathrsfs{A})$ со множеством вершин $Q$, в котором дугами
служат все такие пары $(q,q')\in Q\times Q$, что $q'=\delta(q,a)$ для некоторой
буквы $a\in\Sigma$. Легко видеть, что орграф $D$ изоморфен орграфу некоторого
автомата тогда и только тогда, когда любая вершина $D$ имеет хотя бы одну
исходящую дугу. В дальнейшем мы всегда будем предполагать, что рассматриваемые
орграфы удовлетворяют этому условию. Если $D$ -- орграф, то его
\emph{раскраской} называется всякий автомат $\mathrsfs{A}$ со свойством $D\cong
D(\mathrsfs{A})$. Любая раскраска орграфа $D=\langle V,E\rangle$ получается,
если зафиксировать некоторый конечный алфавит $\Sigma$ и приписать каждой дуге
из $E$ непустое множество букв из $\Sigma$ так, чтобы для каждой вершины $v\in
V$ множества, приписанные исходящим из $v$ дугам, составляли разбиение алфавита
$\Sigma$. На рис.\,\ref{fig:cerny} изображен орграф и две его раскраски при
помощи алфавита $\Sigma=\{a,b\}$.

\begin{figure}[ht]
 \begin{center}
  \unitlength=2.8pt
    \begin{picture}(18,30)(-65,-4)
    \gasset{Nw=6,Nh=6,Nmr=3}
    \node(A1)(0,18){$1$}
    \node(A2)(18,18){$2$}
    \node(A3)(18,0){$3$}
    \node(A4)(0,0){$4$}
    \drawloop[loopangle=135](A1){$a$}
    \drawloop[loopangle=45](A2){$b$}
    \drawloop[loopangle=-45](A3){$b$}
    \drawedge(A1,A2){$b$}
    \drawedge(A2,A3){$a$}
    \drawedge(A3,A4){$a$}
    \drawedge(A4,A1){$a,b$}
    \end{picture}
 \begin{picture}(18,30)(0,-4)
    \gasset{Nw=6,Nh=6,Nmr=3}
    \node(A1)(0,18){$1$}
    \node(A2)(18,18){$2$}
    \node(A3)(18,0){$3$}
    \node(A4)(0,0){$4$}
    \drawloop[loopangle=135](A1){$a$}
    \drawloop[loopangle=45](A2){$a$}
    \drawloop[loopangle=-45](A3){$a$}
    \drawedge(A1,A2){$b$}
    \drawedge(A2,A3){$b$}
    \drawedge(A3,A4){$b$}
    \drawedge(A4,A1){$a,b$}
    \end{picture}
 \begin{picture}(18,30)(65,-4)
    \gasset{Nw=6,Nh=6,Nmr=3}
    \node(A1)(0,18){$1$}
    \node(A2)(18,18){$2$}
    \node(A3)(18,0){$3$}
    \node(A4)(0,0){$4$}
    \drawloop[loopangle=135](A1){}
    \drawloop[loopangle=45](A2){}
    \drawloop[loopangle=-45](A3){}
    \drawedge(A1,A2){}
    \drawedge(A2,A3){}
    \drawedge(A3,A4){}
    \drawedge(A4,A1){}
    \end{picture}
 \end{center}
 \caption{Орграф и две его раскраски}
 \label{fig:cerny}
\end{figure}

Еще в 1977 г.\ Адлер, Гудвин и Вейс~\cite{AGW} отметили, что орграф каждого
сильно связного синхронизируемого автомата примитивен, и предположили,  что
каждый примитивный орграф имеет синхронизируемую раскраску -- в этом и состояла
гипотеза раскраски дорог, недавно доказанная Трахтманом~\cite{Tr09}. Нетрудно
указать и соотношение между порогом синхронизации сильно связного
синхронизируемого автомата и экспонентой его орграфа.

\begin{proposition}
\label{lower bound} Пусть $\mathrsfs{A}=\langle Q,\Sigma,\delta\rangle$ --
сильно связный синхронизируемый $n$-автомат с порогом синхронизации $t$. Тогда
\begin{equation}
\label{eq:lower bound} \gamma(D(\mathrsfs{A}))\le t+n-1.
\end{equation}
\end{proposition}

\begin{proof}
Пусть $w\in\Sigma^*$ -- синхронизирующее слово длины $t$ и пусть $p$ -- то
состояние, к которому $w$ синхронизирует автомат $\mathrsfs{A}$, т.\,е.
$\delta(q,w)=p$ для всех $q\in Q$. Возьмем теперь произвольную пару
$(q',q'')\in Q\times Q$ и укажем в орграфе $D(\mathrsfs{A})$ маршрут из $q'$ в
$q''$ длины в точности $t+n-1$. Поскольку орграф $D(\mathrsfs{A})$ сильно
связен, в нем существует маршрут из $p$ в $q''$. Пусть $\ell$ -- минимальная
длина такого маршрута. Так как маршрут минимальной длины не проходит ни через
одну вершину дважды, $\ell\le n-1$. Рассмотрим теперь произвольный маршрут
длины $n-1-\ell$, начинающийся из $q'$. Из конечной вершины этого маршрута
пройдем по маршруту длины $t$, вдоль которого в автомате $\mathrsfs{A}$
читается слово $w$. Поскольку $w$ -- синхронизирующее слово, такой маршрут
необходимо окончится в $p$. Теперь осталось пройти по маршруту  длины $\ell$ из
$p$ в $q''$, чтобы получить маршрут из $q'$ в $q''$ длины
$(n-1-\ell)+t+\ell=t+n-1$.
\end{proof}

Таким образом, раскраски примитивных орграфов с~большими экспонентами приводят
к автоматам с большими порогами синхронизации. Это наблюдение, однако, еще не
достаточно для того, чтобы полностью объяснить сходство между строками
табл.~\ref{9 states}, поскольку далеко не все автоматы, отвечающие ненулевым
позициям в третьей строке, могут быть получены как раскраски примитивных
орграфов с~большими экспонентами. В \S4 мы укажем еще один способ получения
медленно синхронизируемых автоматов из примитивных орграфов.

\subsection{Серии медленно синхронизируемых автоматов}

\paragraph*{4.1. Обзор.} Обсудим прежде всего, какими именно автоматами мы
интересуемся, другими словами, какой точный смысл вкладывается в выражения типа
<<медленно синхронизируемые автоматы>> или <<автоматы, с порогом синхронизации,
близким к квадрату числа состояний>>. Как отмечалось в \S1, порог синхронизации
$n$-автомата может достигать $(n-1)^2$ -- соответствующим примером служит
открытый Черни~\cite{Ce64} автомат $\mathrsfs{C}_n=\langle
\{1,2,\dots,n\},\{a,b\},\delta\rangle$, где буквы $a$ и $b$ действуют следующим
образом:
$$\delta(i,a)=\begin{cases}
i, &\text{если } i<n,\\
1, &\text{если } i=n;
\end{cases}\quad
\delta(i,b)=\begin{cases}
i+1, &\text{если } i<n,\\
1, &\text{если } i=n.
\end{cases}$$
Автомат $\mathrsfs{C}_n$ изображен слева на рис.\,\ref{fig:cerny-n} ниже.
Нетрудно понять, что если к автомату $\mathrsfs{C}_{n-1}$ добавить новое
состояние $q_0$, а затем всевозможными способами доопределять действие букв $a$
и $b$ на этом новом состоянии так, чтобы хотя бы одна из них не фиксировала
$q_0$, то можно получить $n^2-1$ неизоморфных достижимых $n$-автоматов с
порогами синхронизации от $(n-2)^2$ до $(n-2)^2+1$. Аналогичным образом можно
<<размножать>> до семейств $n$-автоматов и другие $(n-1)$-автоматы с порогом
синхронизации, близким к $(n-2)^2$. Поскольку мы хотим избежать рассмотрения
таких более или менее тривиальных модификаций, наше внимание сосредоточено на
$n$-автоматах с порогом синхронизации, заключенным в пределах от $(n-2)^2+2$ до
$(n-1)^2$. (В частности, именно из этих соображений выбирался диапазон значений
порога синхронизации в табл.~\ref{automata} и~\ref{9 states}.)

Наши эксперименты показывают, что в указанных пределах автоматов не слишком
много и что их распределение по возможным значениям порога синхронизации
устойчиво следует такому образцу: изолированное экстремальное значение --
разрыв -- небольшой <<остров>> -- разрыв -- <<материк>>, см.
табл.~\ref{automata} и обсуждение в конце \S2. Мы продемонстрируем, что исходя
из примитивных орграфов с большими экспонентами, представленных в
теореме~\ref{dulmage}, можно построить следующие серии автоматов над
двухбуквенным алфавитом:
\begin{itemize}
\item серию $\mathrsfs{C}_n$, отвечающую наблюдаемому экстремальному значению;
\item серии $\mathrsfs{W}_n$, $\mathrsfs{D}'_n$, $\mathrsfs{D}''_n$,
$\mathrsfs{E}_n$, а при нечетном $n$ -- еще и серии $\mathrsfs{B}_n$ и
$\mathrsfs{F}_n$, отвечающие всем наблюдаемым <<островным>> значениям;
\item серии $\mathrsfs{G}_n$ (при нечетном $n$) и $\mathrsfs{H}_n$,
отвечающие максимальным наблюдаемым <<материковым>> значениям.
\end{itemize}
Рис.~\ref{fig:relation} показывает, из каких именно орграфов получаются
перечисленные серии. (Для наглядности на рис.~\ref{fig:relation} вместо матриц
из теоремы~\ref{dulmage} изображены <<типичные представители>> соответствующих
серий орграфов.) Если от символа орграфа к букве, обозначающей серию автоматов,
проведена сплошная стрелка, то автоматы серии получены раскраской
соответствующих орграфов; штриховая стрелка указывает на другой способ
получения автомата из орграфа. Пунктирной рамкой объединены серии автоматов с
одинаковым значением порога синхронизации.
\begin{figure}[h]
\begin{center}
\includegraphics[width=12cm]{relation.eps}
\unitlength 0.86mm
\begin{picture}(1,1)(2,0)
\put(-132,45){\Large{$\mathrsfs{C}_n$}}
\put(-106,45){\Large{$\mathrsfs{D}'_n$}} \put(-92,45){\Large{$\mathrsfs{W}_n$}}
\put(-84,45){\Large{$\mathrsfs{F}_n$}} \put(-71,45){\Large{$\mathrsfs{E}_n$}}
\put(-64,45){\Large{$\mathrsfs{D}''_n$}} \put(-54,45){\Large{$\mathrsfs{B}_n$}}
\put(-23,45){\Large{$\mathrsfs{G}_n$}} \put(-10,45){\Large{$\mathrsfs{H}_n$}}
\put(-71,1){$\underbrace{\rule{6.1cm}{0pt}}_{\text{при нечетном $n$}}$}
\end{picture}
\caption{Связи между сериями примитивных орграфов с большими экспонентами и
сериями медленно синхронизируемых автоматов} \label{fig:relation}
\end{center}
\end{figure}

Итак, здесь мы докажем ряд утверждений о перечисленных на
рис.~\ref{fig:relation} сериях автоматов. (Два из этих утверждений -- о сериях
$\mathrsfs{C}_n$ и $\mathrsfs{B}_n$ -- встречались в литературе, но наши
доказательства являются существенно новыми.) Эти результаты будут объединены в
5 групп в соответствии с <<происхождением>> серий, т.\,е.\ с типом орграфов, из
которых получены автоматы серий.

\paragraph*{4.2. Автоматы, связанные с орграфами серии $W_n$.} Орграф $W_n$ -- это
$n$-орграф наибольшей экспоненты, отвечающий первой матрице в~\eqref{wielandt}.
Если обозначить вершины $W_n$ через $1,2,\dots,n$, то его дуги суть $(n,1)$,
$(n,2)$ и $(i,i+1)$ для $i=1,\dots,n-1$. Нетрудно видеть, что с точностью до
изоморфизма и переименования букв существует единственная раскраска орграфа
$W_n$ с помощью двух букв. Обозначим соответствующий автомат через
$\mathrsfs{W}_n$. Орграф $W_n$ и автомат $\mathrsfs{W}_n$ изображены на
рис.\,\ref{fig:anan}.

\begin{figure}[hb]
\begin{center}
\unitlength .5mm
\begin{picture}(72,60)(20,-67)
\gasset{Nw=16,Nh=16,Nmr=8} \node(n0)(36.0,-16.0){1} \node(n1)(4.0,-40.0){$n$}
\node(n2)(68.0,-40.0){2} \node(n3)(16.0,-72.0){$n{-}1$}
\node(n4)(56.0,-72.0){3} \drawedge[ELdist=2.0](n1,n0){}
\drawedge[ELdist=1.5](n2,n4){} \drawedge[ELdist=1.7](n0,n2){}
\drawedge[ELdist=1.7](n3,n1){} \drawedge[ELdist=2.0](n1,n2){}
\put(31,-73){$\dots$}
\end{picture}
\begin{picture}(72,60)(-20,-67)
\gasset{Nw=16,Nh=16,Nmr=8}
\node(n0)(36.0,-16.0){1}
\node(n1)(4.0,-40.0){$n$} \node(n2)(68.0,-40.0){2}
\node(n3)(16.0,-72.0){$n{-}1$} \node(n4)(56.0,-72.0){3}
\drawedge[ELdist=2.0](n1,n0){$b$} \drawedge[ELdist=1.5](n2,n4){$a, b$}
\drawedge[ELdist=1.7](n0,n2){$a, b$}
\drawedge[ELdist=1.7](n3,n1){$a, b$} \drawedge[ELdist=2.0](n1,n2){$a$}
\put(31,-73){$\dots$}
\end{picture}
\end{center}
\caption{Орграф $W_n$ и автомат $\mathrsfs{W}_n$}\label{fig:anan}
\end{figure}

\begin{theorem}
\label{theorem:anan} Автомат $\mathrsfs{W}_n$ синхронизируем, и его порог
синхронизации равен $n^2-3n+3$.
\end{theorem}

\begin{proof}
Нетрудно проверить, что слово $(ab^{n-2})^{n-2}a$ синхронизирует автомат
$\mathrsfs{W}_n$. Длина этого слова равна $(n-1)(n-2)+1=n^2-3n+3$. С другой
стороны, из теоремы~\ref{dulmage}(b) и предложения~\ref{lower bound} вытекает,
что порог синхронизации для $\mathrsfs{W}_n$ не может быть меньше чем
$((n-1)^2+1)-(n-1)=n^2-3n+3$.
\end{proof}

Серия автоматов $\mathrsfs{W}_n$ была обнаружена первым автором данной работы
в~2008 г. Его первоначальное доказательство теоремы~\ref{theorem:anan}
использовало теоретико-игровую технику из~\cite{AVZ} и было весьма трудоемким.

Теперь продемонстрируем, что и серия автоматов $\mathrsfs{C}_n$ тесно (хотя и
менее очевидным образом) связана с орграфами из серии $W_n$. Отметим, что хотя
автоматы $\mathrsfs{C}_n$ известны уже около 50 лет и многократно
переоткрывались, их родство с орграфами из серии $W_n$ ранее, по-видимому, не
отмечалось.
\begin{figure}[th]
\begin{center}
\unitlength .5mm
\begin{picture}(72,66)(25,-76)
\gasset{Nw=16,Nh=16,Nmr=8,loopdiam=10} \node(n0)(36.0,-16.0){1}
\node(n1)(4.0,-40.0){$n$} \node(n2)(68.0,-40.0){2}
\node(n3)(16.0,-72.0){$n{-}1$} \node(n4)(56.0,-72.0){3}
\drawedge[ELdist=2.0](n1,n0){$a,b$} \drawedge[ELdist=1.5](n2,n4){$b$}
\drawedge[ELdist=1.7](n0,n2){$b$} \drawedge[ELdist=1.7](n3,n1){$b$}
\drawloop[ELdist=1.5,loopangle=30](n2){$a$}
\drawloop[ELdist=2.4,loopangle=-30](n4){$a$}
\drawloop[ELdist=1.5,loopangle=-90](n0){$a$}
\drawloop[ELdist=1.5,loopangle=210](n3){$a$} \put(31,-73){$\dots$}
\end{picture}
\begin{picture}(72,66)(-25,-76)
\gasset{Nw=16,Nh=16,Nmr=8} \node(n0)(36.0,-16.0){1} \node(n1)(4.0,-40.0){$n$}
\node(n2)(68.0,-40.0){2} \node(n3)(16.0,-72.0){$n{-}1$}
\node(n4)(56.0,-72.0){3} \drawedge[ELdist=2.0](n1,n0){$b$}
\drawedge[ELdist=1.5](n2,n4){$b,c$} \drawedge[ELdist=1.7](n0,n2){$b,c$}
\drawedge[ELdist=1.7](n3,n1){$b,c$} \drawedge[ELdist=2.0](n1,n2){$c$}
\put(31,-73){$\dots$}
\end{picture}
\end{center}
\caption{Автомат $\mathrsfs{C}_n$ и автомат, определяемый действиями слов $b$ и
$c=ab$}\label{fig:cerny-n}
\end{figure}

Дадим новое простое доказательство классического результата Черни.
\begin{theorem}[\!\!{\mdseries\cite[лемма~1]{Ce64}}]
\label{theorem:cerny} Автомат $\mathrsfs{C}_n$ синхронизируем, и его порог
синхронизации равен $(n-1)^2$.
\end{theorem}

\begin{proof}
Легко проверить, что слово $(ab^{n-1})^{n-2}a$ синхронизирует автомат
$\mathrsfs{C}_n$. Длина этого слова равна $n(n-2)+1=(n-1)^2$.

Теперь воспользуемся следующим наблюдением, которое будет полезно и в других
доказательствах.

\begin{proposition}
\label{prop:simple idempotent} Пусть $\mathrsfs{A}=\langle
Q,\{a,b\},\delta\rangle$ -- синхронизируемый $n$-авто\-мат с порогом
синхронизации $t$, в котором буква $a$ фиксирует все состояния, кроме ровно
одного, а буква $b$ действует как перестановка множества $Q$. Рассмотрим
автомат $\mathrsfs{B}=\langle Q,\{b,c\},\zeta\rangle$, в котором
$\zeta(q,b)=\delta(q,b)$ и $\zeta(q,c)=\delta(q,ab)$ для всех $q\in Q$. Тогда
автомат $\mathrsfs{B}$ синхронизируем, и его порог синхронизации не превосходит
$t-n+2$.
\end{proposition}

\begin{proof}
Пусть $w$ -- некоторое синхронизирующее автомат $\mathrsfs{A}$ слово длины $t$.
Поскольку буква $b$ действует как перестановка множества $Q$, слово $w$ не
может оканчиваться на $b$ -- в противном случае, удалив последнюю букву из $w$,
мы получили бы более короткое синхронизирующее слово. Итак, $w=w'a$ для
некоторого слова $w'\in\{a,b\}^*$. Пусть $q_1\in Q$ -- то единственное
состояние, которое не фиксируется буквой $a$, и пусть $q_2=\delta(q_1,a)$. Из
минимальности длины слова $w$ вытекает, что образ множества $Q$ под действием
слова $w'$ равен $\{q_1,q_2\}$.

Поскольку слово $a^2$ действует на $Q$ точно так же, как буква $a$, это слово
не может появиться в $w$ в качестве фактора -- в противном случае, заменив
вхождение $a^2$ на $a$, мы получили бы более короткое синхронизирующее слово.
Поэтому после каждого вхождения $a$ в $w$, кроме последнего, следует вхождение
буквы $b$, а стало быть, слово $w'$ может быть переписано в слово $v$ над
алфавитом $\{b,c\}$ (где $c=ab$). Поскольку слова $w'$ и $v$ действуют на
множестве $Q$ одинаково, слово $vc$ является синхронизирующим для автомата
$\mathrsfs{B}$. Итак, автомат $\mathrsfs{B}$ синхронизируем; пусть $s$ -- его
порог синхронизации.

Поскольку $b$ лишь переставляет состояния, а каждое применение $c$ может
перевести в одно состояние лишь одну пару состояний, слово $vc$, переводящее
все состояния в одно, должно содержать по меньшей мере $n-1$ вхождение $c$.
Длина $v$ как слова над $\{b,c\}$ не меньше $s-1$ и $v$ содержит по меньшей
мере $n-2$ вхождения $c$. Поскольку каждое вхождение $c$ в $v$ отвечает
вхождению фактора $ab$ в $w'$, мы можем заключить, что слово $w'$ имеет длину
не меньше $(s-1)+(n-2)$. Поскольку длина слова $w=w'a$ равна $t$, получаем
$t-1\ge (s-1)+(n-2)$, откуда $s\le t-n+2$.
\end{proof}

Вернемся к доказательству теоремы~\ref{theorem:cerny}. Легко видеть, что для
автомата $\mathrsfs{C}_n$ автомат, определяемый действиями слов $b$ и $c=ab$,
изоморфен автомату $\mathrsfs{W}_n$, см. рис.\,\ref{fig:cerny-n}. По
теореме~\ref{theorem:anan} порог синхронизации для $\mathrsfs{W}_n$ есть
$n^2-3n+3$. Применяя предложение~\ref{prop:simple idempotent}, заключаем, что
порог синхронизации для $\mathrsfs{C}_n$ не может быть меньше чем
$(n^2-3n+3)+(n-2)=n^2-2n+1=(n-1)^2$.
\end{proof}

Следующая серия из семейства автоматов, связанных с орграфом $W_n$, состоит из
автоматов $\mathrsfs{E}_n=\langle\{1,2,\dots,n\},\{a,b\},\delta\rangle$, где
буквы $a$ и $b$ действуют следующим образом:
$$\delta(i,a)=\begin{cases}
2, &\text{если } i = 1,\\
3, &\text{если } i = 2,\\
i, &\text{если } i>2;
\end{cases}\quad
\delta(i,b)=\begin{cases}
i+1, &\text{если } i<n,\\
1, &\text{если } i=n.
\end{cases}$$
Автомат $\mathrsfs{E}_n$ изображен на рис.\,\ref{fig:e-n} слева.
\begin{figure}[hb]
\begin{center}
\unitlength .45mm
\begin{picture}(72,66)(25,-76)
\gasset{Nw=16,Nh=16,Nmr=8,loopdiam=10} \node(n0)(36.0,-16.0){2}
\node(n1)(4.0,-40.0){$1$} \node(n2)(68.0,-40.0){3} \node(n3)(16.0,-72.0){$n$}
\node(n4)(56.0,-72.0){4} \drawedge[ELdist=2.0](n1,n0){$a$}
\drawedge[ELdist=1.5](n2,n4){$b$} \drawedge[ELdist=1.7](n0,n2){$a,b$}
\drawedge[ELdist=1.7](n3,n1){$b$} \drawedge[ELdist=1.7](n1,n2){$b$}
\drawloop[ELdist=1.5,loopangle=30](n2){$a$}
\drawloop[ELdist=2.4,loopangle=-30](n4){$a$}
\drawloop[ELdist=1.5,loopangle=210](n3){$a$} \put(31,-73){$\dots$}
\end{picture}
\begin{picture}(72,66)(-25,-76)
\gasset{Nw=16,Nh=16,Nmr=8,loopdiam=10} \node(n0)(36.0,-16.0){2}
\node(n1)(4.0,-40.0){1} \node(n2)(68.0,-40.0){3} \node(n3)(16.0,-72.0){$n$}
\node(n4)(56.0,-72.0){4} \drawedge[ELdist=1.5](n2,n4){$b$}
\drawedge[ELdist=1.7](n0,n2){$b,c$} \drawedge[ELdist=1.7](n3,n1){$b$}
\drawedge[ELdist=2.0](n1,n2){$b,c$} \drawloop[ELdist=1.5,loopangle=30](n2){$c$}
\drawloop[ELdist=2.4,loopangle=-30](n4){$c$}
\drawloop[ELdist=1.5,loopangle=210](n3){$c$} \put(31,-73){$\dots$}
\end{picture}
\end{center}
\caption{Автомат $\mathrsfs{E}_n$ и автомат, определяемый действиями слов $b$ и
$c=aa$}\label{fig:e-n}
\end{figure}

\begin{theorem}
\label{thm:e-n} Автомат $\mathrsfs{E}_n$ синхронизируем, и его порог
синхронизации равен $n^2-3n+2$.
\end{theorem}

\begin{proof}
Несложно проверить, что слово $(a^2b^{n-2})^{n-3}a^2$ синхронизирует автомат
$\mathrsfs{E}_n$. Длина этого слова равна $n(n-3)+2=n^2-3n+2$.

Пусть теперь $w$ -- некоторое синхронизирующее $\mathrsfs{E}_n$ слово
минимальной длины. Заметим, что в $\mathrsfs{E}_n$ слова $bab$ и $b^2$
действуют одинаково и слова $a^3$ и $a^2$ тоже действуют одинаково. Поэтому
факторы $bab$ и $a^3$ не могут входить в слово $w$. Кроме того, $w$ не может
начинаться с $ab$. Действительно, образ множества всех состояний под действием
слова $ab$ равен $\{1,3,\dots,n\}$, что совпадает с образом буквы $b$. Поэтому
если бы слово $w$ начиналось с $ab$, то, заменив $ab$ на $b$, мы получили бы
более короткое синхронизирующее слово. Наконец, $w$ не может заканчиваться на
$ba$. Действительно, если $w=w'a$, то из минимальности $w$ следует, что образ
множества всех состояний под действием слова $w'$ равен $\{2,3\}$. Однако
последнее множество не принадлежит образу буквы $b$, т.\,е.\ $w'$ не может
оканчиваться на $b$. Итак, любое вхождение буквы $a$ в слово $w$ происходит
внутри фактора $a^2$ и никакие два вхождения таких факторов в $w$ не
перекрываются.

Положим $c=a^2$, тогда слово $w$ может быть переписано в слово $v$ над
алфавитом $\{b,c\}$. Действия $b$ и $c$ на множестве $\{1,2,\dots,n\}$
определяют автомат, изображенный на рис.\,\ref{fig:e-n} справа. Поскольку слова
$w$ и $v$ действуют на множестве $\{1,2,\dots,n\}$ одинаково, слово $v$
является синхронизирующим для этого автомата, а значит, и для его подавтомата с
множеством состояний $\{1,3,\dots,n\}$. Легко видеть, что этот подавтомат
изоморфен автомату $\mathrsfs{C}_{n-1}$. По теореме~\ref{theorem:cerny} длина
$v$ как слова над $\{b,c\}$ не меньше $(n-2)^2$ и $v$ содержит по меньшей мере
$n-2$ вхождения $c$. Поскольку каждое вхождение $c$ в $v$ отвечает вхождению
фактора $a^2$ в $w$, мы можем заключить, что слово $w$ имеет длину не меньше
$(n-2)^2+(n-2)=n^2-3n+2$.
\end{proof}

Доказательство теоремы~\ref{thm:e-n} показывает, что автомат $\mathrsfs{E}_n$
возникает из одной из той <<тривиальных>> модификаций автомата
$\mathrsfs{C}_{n-1}$, которые мы обсудили в п.\,4.1. Последняя серия медленно
синхронизируемых автоматов из семейства автоматов, связанных с орграфом $W_n$,
возникает из аналогичной модификации автомата $\mathrsfs{W}_{n-1}$. Она состоит
из автоматов $\mathrsfs{H}_n=\langle\{1,2,\dots,n\},\{a,b\},\delta\rangle$, где
буквы $a$ и $b$ действуют следующим образом:
$$\delta(i,a)=\begin{cases}
n, &\text{если } i=1,\\
i, &\text{если } 1<i<n,\\
1, &\text{если } i=n;
\end{cases}\quad
\delta(i,b)=\begin{cases}
i+1, &\text{если } i<n-1,\\
1, &\text{если } i=n-1,\\
3, &\text{если } i=n.
\end{cases}$$
Автомат $\mathrsfs{H}_n$ изображен на рис.\,\ref{fig:h-n} слева.

\begin{figure}[ht]
\unitlength .5mm
\begin{center}
\begin{picture}(72,72)(25,-75)
\gasset{Nw=16,Nh=16,Nmr=8,loopdiam=10}
\node[NLangle=0.0](n0)(24.25,-23.6){$n{-}1$}
\node[NLangle=0.0](n1)(52.25,-7.6){$1$}
\node[NLangle=0.0](n2)(80.25,-23.6){$2$}
\node[NLangle=0.0](n3)(24.25,-52){$n{-}2$}
\node[NLangle=0.0](n4)(55,-67.6){$4$} \node[NLangle=0.0](n6)(80.25,-52){$3$}
\drawedge(n1,n2){$b$} \drawedge(n2,n6){$b$} \drawedge(n0,n1){$b$}
\drawedge(n3,n0){$b$} \drawedge(n6,n4){$b$} \drawloop[loopangle=0.0](n6){$a$}
\drawloop[loopangle=270.0](n4){$a$} \drawloop[loopangle=180.0](n3){$a$}
\drawloop[loopangle=0.0](n2){$a$} \node[NLangle=0.0](n31)(52.0,-38){$n$}
\drawedge[ELside=r,ELdist=3.0,curvedepth=-5.0](n1,n31){$a$}
\drawedge[ELside=r,ELdist=3.0,curvedepth=-5.0](n31,n1){$a$}
\drawloop[loopangle=180.0](n0){$a$} \drawedge(n31,n6){$b$}
\put(31,-67){$\dots$}
\end{picture}
\begin{picture}(72,72)(-25,-75)
\gasset{Nw=16,Nh=16,Nmr=8,loopdiam=10}
\node[NLangle=0.0](n0)(24.25,-23.6){$n{-}1$}
\node[NLangle=0.0](n1)(52.25,-7.6){$1$}
\node[NLangle=0.0](n2)(80.25,-23.6){$2$}
\node[NLangle=0.0](n3)(24.25,-52){$n{-}2$}
\node[NLangle=0.0](n4)(55,-67.6){$4$} \node[NLangle=0.0](n6)(80.25,-52){$3$}
\drawedge[ELdist=0.7](n1,n2){$b$} \drawedge[ELpos=35, ELdist=0.5](n1,n6){$c$}
\drawedge(n2,n6){$b, c$} \drawedge(n0,n1){$b, c$} \drawedge(n3,n0){$b, c$}
\drawedge(n6,n4){$b,c$} \node[NLangle=0.0](n31)(50,-40){$n$}
\drawedge[ELpos=35,ELdist=0.7](n31,n6){$b$}
\drawedge[ELpos=35,ELdist=0.7](n31,n2){$c$} \put(31,-67){$\dots$}
\end{picture}
\end{center}
\caption{Автомат $\mathrsfs{H}_n$ и автомат, определяемый действиями слов $b$ и
$c=ab$}\label{fig:h-n}
\end{figure}

\begin{theorem}
\label{thm:h-n} Автомат $\mathrsfs{H}_n$ синхронизируем, и его порог
синхронизации равен $n^2-4n+6$.
\end{theorem}

\begin{proof}
Легко убедиться, что слово $b(ab^{n-2})^{n-3}ab$ синхронизирует автомат
$\mathrsfs{H}_n$. Длина этого слова равна $1+(n-1)(n-3)+2=n^2-4n+6$.

Пусть теперь $w$ -- некоторое синхронизирующее $\mathrsfs{H}_n$ слово
минимальной длины. Поскольку в $\mathrsfs{H}_n$ слово $a^2$ действует как
тождественное преобразование, оно не может входить в $w$ в качестве фактора.
Кроме того, слово $w$ не может ни начинаться, ни заканчиваться буквой $a$, так
как эта буква действует на множестве всех состояний как перестановка.

Положим $c=ab$, тогда слово $w$ может быть переписано в слово $v$ над алфавитом
$\{b,c\}$. Действия $b$ и $c$ на множестве $\{1,2,\dots,n\}$ определяют
автомат, изображенный на рис.\,\ref{fig:h-n} справа. Поскольку слова $w$ и $v$
действуют на множестве $\{1,2,\dots,n\}$ одинаково, слово $v$ является
синхронизирующим для этого автомата. Выше отмечено, что слово $w$ начинается с
буквы $b$, а значит, с нее начинается и $v$. Если записать $v=bv'$ для
некоторого $v'\in\{b,c\}^*$, то легко видеть, что слово $v'$ будет
синхронизирующим для подавтомата с множеством состояний $\{1,2,\dots,n-1\}$.
Поскольку этот подавтомат изоморфен автомату $\mathrsfs{W}_{n-1}$, по
теореме~\ref{theorem:anan} длина $v'$ как слова над $\{b,c\}$ не меньше
$(n-1)^2-3(n-1)+3$. Кроме того, $v'$ содержит по меньшей мере $n-2$ вхождения
$c$, поскольку $b$ лишь переставляет состояния из $\{1,2,\dots,n-1\}$, а каждое
применение $c$ может перевести в одно состояние лишь одну пару состояний.
Учитывая, что каждое вхождение $c$ в $v'$ отвечает вхождению фактора $ab$ в
$w$, мы можем заключить, что длина слова $w$ не может быть меньше чем
$1+((n-1)^2-3(n-1)+3)+(n-2)=n^2-4n+6$.
\end{proof}

\paragraph*{4.3. Автоматы, связанные с орграфами серии $D_n$.} Орграф $D_n$ -- это
$n$-орграф с экспонентой $(n-1)^2$, отвечающий второй матрице
в~\eqref{wielandt}. Он получается из орграфа $W_n$ добавлением дуги $(n-1,1)$.
Нетрудно видеть, что с точностью до изоморфизма и переименования букв
существуют ровно две раскраски орграфа $D_n$ с помощью двух букв. На
рис.\,\ref{fig:dulmage} изображен орграф $D_n$ и две его раскраски -- автоматы
$\mathrsfs{D}'_n$ и $\mathrsfs{D}''_n$.

\begin{figure}[hb]
\begin{center}
\unitlength .5mm
\begin{picture}(64,60)(30,-72)
\gasset{Nw=16,Nh=16,Nmr=8} \node(n0)(32.0,-16.0){1} \node(n1)(0,-40.0){$n$}
\node(n2)(64.0,-40.0){2} \node(n3)(12.0,-72.0){$n{-}1$}
\node(n4)(52.0,-72.0){3} \drawedge(n1,n0){} \drawedge(n2,n4){}
\drawedge(n0,n2){} \drawedge(n3,n0){} \drawedge(n3,n1){} \drawedge(n1,n2){}
\put(31,-73){$\dots$}
\end{picture}
\begin{picture}(64,60)(0,-72)
\gasset{Nw=16,Nh=16,Nmr=8} \node(n0)(32.0,-16.0){1} \node(n1)(0,-40.0){$n$}
\node(n2)(64.0,-40.0){2} \node(n3)(12.0,-72.0){$n{-}1$}
\node(n4)(52.0,-72.0){3} \drawedge[ELdist=2.0](n1,n0){$b$}
\drawedge[ELdist=1.5](n2,n4){$a, b$} \drawedge[ELdist=1.7](n0,n2){$a,b$}
\drawedge[ELpos=40,ELdist=1.7](n3,n0){$a$} \drawedge[ELdist=1.7](n3,n1){$b$}
\drawedge[ELdist=2.0](n1,n2){$a$} \put(31,-73){$\dots$}
\end{picture}
\begin{picture}(64,60)(-30,-72)
\gasset{Nw=16,Nh=16,Nmr=8} \node(n0)(32.0,-16.0){1} \node(n1)(0,-40.0){$n$}
\node(n2)(64.0,-40.0){2} \node(n3)(12.0,-72.0){$n{-}1$}
\node(n4)(52.0,-72.0){3} \drawedge[ELdist=2.0](n1,n0){$a$}
\drawedge[ELdist=1.5](n2,n4){$a, b$} \drawedge[ELdist=1.7](n0,n2){$a, b$}
\drawedge[ELpos=40,ELdist=1.7](n3,n0){$a$} \drawedge[ELdist=1.7](n3,n1){$b$}
\drawedge[ELdist=2.0](n1,n2){$b$} \put(31,-73){$\dots$}
\end{picture}
\end{center}
\caption{Орграф $D_n$ и его раскраски $\mathrsfs{D}'_n$ и $\mathrsfs{D}''_n$}\label{fig:dulmage}
\end{figure}

\begin{theorem}
\label{theorem:new series} Автоматы $\mathrsfs{D}'_n$ и $\mathrsfs{D}''_n$
синхронизируемы, и их пороги синхронизации равны $n^2-3n+4$ и $n^2-3n+2$
соответственно.
\end{theorem}

\begin{proof}
Нетрудно проверить, что слово $(ab^{n-2})^{n-2}ba$ синхронизирует автомат
$\mathrsfs{D}'_n$, а слово $(ba^{n-1})^{n-3}ba$ -- автомат $\mathrsfs{D}''_n$.
Длины этих слов равны $(n-1)(n-2)+2=n^2-3n+4$ и $n(n-3)+2=n^2-3n+2$
соответственно.

Из теоремы~\ref{dulmage}(b) и предложения~\ref{lower bound} вытекает, что порог
синхронизации для раскрасок орграфа $D_n$ не может быть меньше чем
$(n-1)^2-(n-1)=n^2-3n+2$. Это доказывает утверждение теоремы для автомата
$\mathrsfs{D}''_n$.

Займемся теперь автоматом $\mathrsfs{D}'_n$. Здесь будет полезен следующий
элементарный результат.
\begin{lemma}[\!\!{\mdseries\cite[Теорема 2.1.1]{RaAl05}}]
\label{sylvester} Если натуральные числа $k$ и $\ell$ взаимно просты, то
наибольшее натуральное число, не представимое в виде линейной комбинации чисел
$k$ и $\ell$ c целыми неотрицательными коэффициентами, равно $k\ell-k-\ell$.
\end{lemma}

Пусть теперь $w$ -- некоторое синхронизирующее автомат $\mathrsfs{D}'_n$ слово
минимальной длины. Поскольку 2 -- единственное состояние в $\mathrsfs{D}'_n$,
являющееся общим концом двух разных дуг с одинаковой меткой, из минимальности
$w$ следует, что под действием $w$ все состояния автомата переходят в~2. Если
предположить, что длина $w$ равна $n^2-3n+2$, то в $D_n$ найдется маршрут такой
длины из вершины~1 в вершину~2. Но вершина~1 имеет единственную исходящую дугу
$(1,2)$, следовательно, указанный маршрут состоит из этой дуги и контура длины
$n^2-3n+1$. В орграфе $D_n$ есть ровно три простых контура: один длины $n$ и
два длины $n-1$. Любой контур можно разбить на простые контуры, а потому число
$n^2-3n+1$ должно (как длина некоторого контура в $D_n$) быть линейной
комбинацией чисел $n$ и $n-1$ (длин простых контуров) c целыми неотрицательными
коэффициентами. Но это невозможно по лемме~\ref{sylvester}, поскольку
$n^2-3n+1=n(n-1)-n-(n-1)$.

Предположим теперь, что длина $w$ равна $n^2-3n+3$. Тогда в $D_n$ найдется
маршрут указанной длины из вершины~$n-1$ в вершину~2. Поскольку $b$ действует
как перестановка множества всех состояний автомата $\mathrsfs{D}'_n$, слово $w$
должно начинаться с буквы $a$. Состояние $n-1$ под действием $a$ переходит в
состояние~1. Поэтому в $D_n$ должен быть и маршрут  длины $n^2-3n+2$ из~1 в~2,
но в предыдущем абзаце показано, что это невозможно. Таким образом, длина $w$
не может быть меньше чем $n^2-3n+4$.
\end{proof}

Серия $\mathrsfs{D}'_n$ интересна тем, что при $n>6$ автоматы этой серии
обладают наибольшим порогом синхронизации среди всех известных автоматов за
исключением автоматов из серии Черни $\mathrsfs{C}_n$, а также наибольшим
порогом синхронизации среди всех известных автоматов без петель. У серии
$\mathrsfs{D}''_n$ также есть экстремальное свойство: автоматы этой серии
обладают наибольшим порогом синхронизации среди всех известных автоматов, в
которых ни одна буква не действует как перестановка множества состояний.

C орграфами $D_n$ связана еще одна серия $n$-автоматов с порогом синхронизации
$n^2-4n+6$. Мы не будем ее здесь приводить, поскольку одна серия с такими же
параметрами уже описана выше (см.\ теорему~\ref{thm:h-n}).

\paragraph*{4.4. Автоматы, связанные с орграфами серии $V_n$.} Орграф $V_n$ -- это
$n$-орграф, отвечающий первой матрице в~\eqref{odd island}. Если обозначить
вершины $V_n$ через $1,2,\dots,n$, то его дуги суть $(n,1)$, $(n,3)$ и
$(i,i+1)$ для $i=1,\dots,n-1$. Орграф $V_n$ примитивен только при нечетном $n$,
и в этом случае его экспонента равна $n^2-3n+4$. С орграфами серии $V_n$
связано семейство автоматов
$\mathrsfs{F}_n=\langle\{1,2,\dots,n\},\{a,b\},\delta\rangle$, в которых буквы
$a$ и $b$ действуют следующим образом:
$$\delta(i,a)=\begin{cases}
i, &\text{если } i<n,\\
2, &\text{если } i=n;
\end{cases}\quad
\delta(i,b)=\begin{cases}
i+1, &\text{если } i<n,\\
1, &\text{если } i=n.
\end{cases}$$
Автомат $\mathrsfs{F}_n$ изображен на рис.\,\ref{fig:f-n} слева.

\begin{figure}[th]
\begin{center}
\unitlength .5mm
\begin{picture}(72,86)(25,-76)
\gasset{Nw=16,Nh=16,Nmr=8,loopdiam=10} \node(n0)(36.0,-16.0){1}
\node(n1)(4.0,-40.0){$n$} \node(n2)(68.0,-40.0){2}
\node(n3)(16.0,-72.0){$n{-}1$} \node(n4)(56.0,-72.0){3}
\drawedge[ELdist=2.0](n1,n0){$b$} \drawedge[ELdist=1.5](n2,n4){$b$}
\drawedge[ELdist=1.7](n0,n2){$b$} \drawedge[ELdist=1.7](n3,n1){$b$}
\drawedge[ELdist=1.7](n1,n2){$a$} \drawloop[ELdist=1.5,loopangle=30](n2){$a$}
\drawloop[ELdist=2.4,loopangle=-30](n4){$a$}
\drawloop[ELdist=1.5,loopangle=210](n3){$a$}
\drawloop[ELdist=1.5,loopangle=90](n0){$a$} \put(31,-73){$\dots$}
\end{picture}
\begin{picture}(72,86)(-25,-76)
\gasset{Nw=16,Nh=16,Nmr=8} \node(n0)(36.0,-16.0){1} \node(n1)(4.0,-40.0){$n$}
\node(n2)(68.0,-40.0){2} \node(n3)(16.0,-72.0){$n{-1}$}
\node(n4)(56.0,-72.0){3} \drawedge[ELdist=1.5](n2,n4){$b,c$}
\drawedge[ELdist=1.7](n0,n2){$b,c$} \drawedge[ELdist=1.7](n3,n1){$b,c$}
\drawedge[ELdist=2.0](n1,n0){$b$} \drawedge[ELdist=2.0](n1,n4){$c$}
\put(31,-73){$\dots$}
\end{picture}
\end{center}
\caption{Автомат $\mathrsfs{F}_n$ и автомат, определяемый действиями слов $b$ и
$c=ab$}\label{fig:f-n}
\end{figure}


\begin{theorem}
\label{thm:f-n} Автомат $\mathrsfs{F}_n$ синхронизируем при нечетном $n>3$, и
его порог синхронизации равен $n^2-3n+3$.
\end{theorem}

\begin{proof}
Непосредственно проверяется, что при каждом нечетном $n>3$ слово
$(ab^{n-2})^{n-2}a$ синхронизирует автомат $\mathrsfs{F}_n$. Длина этого слова
составляет $(n-1)(n-2)+1=n^2-3n+3$.

Ясно, что автомат $\mathrsfs{F}_n$ удовлетворяет условиям
предложения~\ref{prop:simple idempotent}. Действия слов $b$ и $c=ab$ на
множестве $\{1,2,\dots,n\}$ определяют автомат, изображенный на
рис.\,\ref{fig:f-n} справа; обозначим этот автомат через $\mathrsfs{V}$. Ясно,
что автомат $\mathrsfs{V}$ изоморфен некоторой раскраске орграфа $V_n$. Из
теоремы~\ref{dulmage}(d) и предложения~\ref{lower bound} следует, что порог
синхронизации для раскрасок орграфа $V_n$ не может быть меньше чем
$(n^2-3n+4)-(n-1)=n^2-4n+5$. Применяя предложение~\ref{prop:simple idempotent},
заключаем, что порог синхронизации для $\mathrsfs{F}_n$ не может быть меньше
чем $(n^2-4n+5)+(n-2)=n^2-3n+3$.
\end{proof}

\paragraph*{4.5. Автоматы, связанные с орграфами серии $R_n$.} Орграф $R_n$ -- это
$n$-орграф, отвечающий второй матрице в~\eqref{odd island}. Он получается из
орграфа $V_n$ добавлением дуги $(n-1,2)$. Орграф $R_n$ примитивен только при
нечетном $n$, и в этом случае его экспонента равна $n^2-3n+3$. С орграфами
серии $R_n$ связано семейство автоматов
$\mathrsfs{B}_n=\langle\{1,2,\dots,n\},\{a,b\},\delta\rangle$, в которых буквы
$a$ и $b$ действуют следующим образом:
$$\delta(i,a)=\begin{cases}
i &\text{if } i<n-1,\\
1 &\text{if } i=n-1,\\
2 &\text{if } i=n;
\end{cases}\quad
\delta(i,b)=\begin{cases}
i+1 &\text{if } i<n,\\
1 &\text{if } i=n.
\end{cases}$$
Автомат $\mathrsfs{B}_n$ изображен на рис.\,\ref{fig:avz-n} слева.

\begin{figure}[ht]
\begin{center}
\unitlength .5mm
\begin{picture}(72,72)(30,-76)
\gasset{Nw=16,Nh=16,Nmr=8,loopdiam=10} \node(n1)(56.0,-16.0){1}
\node(n2)(68.0,-44.0){2} \node(n3)(56.0,-72.0){3}
\node(n4)(16.0,-72.0){$n{-}2$} \node(n5)(4.0,-44.0){$n{-}1$}
\node(n6)(16.0,-16.0){$n$} \drawedge[ELdist=1.7](n1,n2){$b$}
\drawedge[ELdist=1.7](n2,n3){$b$} \drawedge[ELdist=1.7](n4,n5){$b$}
\drawedge[ELdist=1.7](n5,n6){$b$} \drawedge[ELdist=1.7](n6,n1){$b$}
\drawedge[ELdist=1.7,ELpos=40](n5,n1){$a$}
\drawedge[ELdist=1.7,ELpos=60](n6,n2){$a$}
\drawloop[ELdist=1.5,loopangle=30](n1){$a$}
\drawloop[ELdist=1.5,loopangle=0](n2){$a$}
\drawloop[ELdist=1.5,loopangle=-30](n3){$a$}
\drawloop[ELdist=1.5,loopangle=210](n4){$a$} \put(31,-73){$\dots$}
\end{picture}
\begin{picture}(72,72)(-30,-76)
\gasset{Nw=16,Nh=16,Nmr=8} \node(n1)(56.0,-16.0){1} \node(n2)(68.0,-44.0){2}
\node(n3)(56.0,-72.0){3} \node(n4)(16.0,-72.0){$n{-}2$}
\node(n5)(4.0,-44.0){$n{-}1$} \node(n6)(16.0,-16.0){$n$}
\drawedge[ELdist=1.7](n1,n2){$b,c$} \drawedge[ELdist=1.7](n2,n3){$b,c$}
\drawedge[ELdist=1.7](n4,n5){$b,c$} \drawedge[ELdist=1.7](n5,n6){$b$}
\drawedge[ELdist=1.7](n6,n1){$b$} \drawedge[ELdist=1.7,ELpos=60](n5,n2){$c$}
\drawedge[ELdist=1.7,ELpos=35](n6,n3){$c$} \put(31,-73){$\dots$}
\end{picture}
\end{center}
\caption{Автомат $\mathrsfs{B}_n$ и автомат, определяемый действиями слов $b$ и
$c=ab$}\label{fig:avz-n}
\end{figure}

Серия $\mathrsfs{B}_n$ (при нечетном $n>3$) была опубликована в~\cite{AVZ} и до
недавнего времени оставалась единственной бесконечной серией медленно
синхронизируемых автоматов с двумя входными буквами, представленной в
литературе, помимо серии Черни. Ее связь с орграфами из серии $R_n$ ранее не
отмечалась.

Следующее утверждение, бывшее основным результатом статьи~\cite{AVZ},
доказывалось в ней теоретико-игровым методом. Здесь мы даем вполне элементарное
доказательство, сходное с доказательствами теорем~\ref{theorem:cerny}
и~\ref{thm:f-n}.

\begin{theorem}[\!\!{\mdseries\cite[теорема~1.1]{AVZ}}]
\label{theorem:avz} Если $n>3$ нечетно, то автомат $\mathrsfs{B}_n$
синхронизируем, и его порог синхронизации равен $n^2-3n+2$.
\end{theorem}

\begin{proof}
Нетрудно проверить, что при каждом нечетном $n>3$ слово
$(ab^{n-2})^{\frac{n-3}{2}}ab^{n-3}(ab^{n-2})^{\frac{n-3}{2}}a$ синхронизирует
автомат $\mathrsfs{B}_n$. Длина этого слова равна
$(n-1)\frac{n-3}{2}+n-2+(n-1)\frac{n-3}{2}+1=n^2-3n+2.$

Пусть $w$ -- некоторое синхронизирующее автомат $\mathrsfs{B}_n$ слово
минимальной длины $t$. Поскольку буква $b$ действует как перестановка множества
всех состояний, слово $w$ не может ни начинаться с $b$, ни оканчиваться на $b$.
В частности, $w=w'a$ для некоторого слова $w'\in\{a,b\}^*$. Из минимальности длины
слова $w$ вытекает, что образ множества всех состояний под действием слова $w'$
равен либо $\{1,n-1\}$, либо $\{2,n\}$.

Поскольку слово $a^2$ действует в $\mathrsfs{B}_n$ точно так же, как буква $a$,
это слово не может появиться в $w$ в качестве фактора. Далее, слово $b^n$ действует
в $\mathrsfs{B}_n$ как тождественное преобразование и, стало быть, также не может
быть фактором в синхронизирующем слове минимальной длины. Итак, мы заключаем,
что $w=ab^{k_1}ab^{k_2}a\cdots ab^{k_m}a$, где $1\le k_1,k_2,\dots,k_m\le n-1$.

Положим $c=ab$. Тогда слово $w'$ и слово $v=cb^{k_1-1}cb^{k_2-1}c\cdots
cb^{k_m-1}$ одинаково действуют на множестве $\{1,2,\dots,n\}$. Поэтому слово
$vc$ является синхронизирующим для автомата $\mathrsfs{R}$, определяемого
действиями слов $b$ и $c=ab$ и изображенного на рис.\,\ref{fig:avz-n} справа.
Ясно, что автомат $\mathrsfs{R}$ изоморфен некоторой раскраске орграфа $R_n$.
Из теоремы~\ref{dulmage}(d) и предложения~\ref{lower bound} следует, что порог
синхронизации для раскрасок орграфа $R_n$ не может быть меньше чем
$(n^2-3n+3)-(n-1)=n^2-4n+4$, откуда длина $v$ как слова над $\{b,c\}$, равная
$\sum_{i=1}^mk_i$, не меньше $n^2-4n+3$. Поскольку $k_i\le n-1$ для всех
$i=1,\dots,m$, имеем
\begin{equation}
\label{inequality} m(n-1)\ge\sum_{i=1}^mk_i\ge n^2-4n+3=(n-3)(n-1),
\end{equation}
откуда $m\ge n-3$. При этом равенство $m=n-3$ возможно только в случае, когда
все неравенства в~\eqref{inequality} обращаются в равенства, т.\,е.\ когда
$k_i=n-1$ для всех $i=1,\dots,m$. Тогда $vc=(cb^{n-2})^{n-3}c$, но последнее
слово не является синхронизирующим для $\mathrsfs{R}$ -- легко видеть, что оно
переставляет состояния~2 и~3. Значит, $m\ge n-2$.

Поскольку каждое вхождение $c$ в $v$ отвечает вхождению фактора $ab$ в $w'$,
можем заключить, что слово $w'$ имеет длину не меньше
$(n^2-4n+3)+(n-2)=n^2-3n+1$, откуда длина $w$ не меньше чем $n^2-3n+2$.
\end{proof}

\paragraph*{4.6. Автоматы, связанные с орграфами серии $G_n$.} Орграф $G_n$ -- это
$n$-орграф, отвечающий второй матрице в~\eqref{odd island1}. Он получается из
орграфа $V_n$ добавлением дуги $(n-2,1)$. Орграф $G_n$ примитивен только при
нечетном $n$, и в этом случае его экспонента равна $n^2-3n+2$. На
рис.~\ref{fig:aut:fat} изображен автомат  $\mathrsfs{G}_n$, являющийся одной из
возможных раскрасок орграфа $G_n$. Эта серия автоматов интересна для нас тем,
что при нечетном $n$ она реализует максимальное наблюдаемое <<материковое>>
значение порога синхронизации.

\begin{figure}[ht]
\begin{center}
\unitlength .5mm
\begin{picture}(100,95)(0,-95)
\gasset{Nw=16,Nh=16,Nmr=8} \node[NLangle=0.0](n0)(24.09,-24.01){$n{-}1$}
\node[NLangle=0.0](n1)(51.93,-12.0){$n$}
\node[NLangle=0.0](n2)(80.09,-24.01){$1$}
\node[NLangle=0.0](n3)(12.09,-48.01){$n{-}2$}
\node[NLangle=0.0](n4)(16.09,-76.01){$n{-}3$}
\node[NLangle=0.0](n5)(92.09,-48.01){$2$}
\node[NLangle=0.0](n6)(64.09,-92.01){$4$}
\node[NLangle=0.0](n7)(88.09,-76.01){$3$} \drawedge(n1,n2){$b$}
\drawedge(n2,n5){$a, b$} \drawedge(n5,n7){$a, b$} \drawedge(n7,n6){$a,b$}
\drawedge(n4,n3){$a, b$} \drawedge(n3,n0){$b$} \drawedge(n0,n1){$a,b$}
\drawedge(n1,n7){$a$} \drawedge(n3,n2){$a$} \put(33,-90){$\dots$}
\end{picture}
\end{center}
\caption{Автомат $\mathrsfs{G}_n$} \label{fig:aut:fat}
\end{figure}

\begin{theorem}
Если $n>3$ нечетно, то автомат $\mathrsfs{G}_n$ синхронизируем, и его порог
синхронизации равен $n^2-4n+7$.
\end{theorem}

\begin{proof}
Легко видеть, что при каждом нечетном $n>3$ слово $a^2(baba^{n-3})^{n-4}baba^2$
синхронизирует автомат $\mathrsfs{G}_n$. Длина этого слова равна
$2+n(n-4)+5=n^2-4n+7$.

Дальнейшие рассуждения вполне аналогичны аргументам из доказательства
теоремы~\ref{theorem:new series}. Из теоремы~\ref{dulmage}(d) и
предложения~\ref{lower bound} вытекает, что порог синхронизации для раскрасок
орграфа $G_n$ не может быть меньше чем $(n^2-3n+2)-(n-1)=n^2-4n+3$.

Пусть теперь $w$ -- некоторое синхронизирующее автомат $\mathrsfs{G}_n$ слово
минимальной длины. Поскольку 3 -- единственное состояние в $\mathrsfs{G}_n$,
являющееся общим концом двух разных дуг с одинаковой меткой, из минимальности
$w$ следует, что под действием $w$ все состояния автомата переходят в~3. Если
предположить, что длина $w$ равна $n^2-4n+3$, то в $D_n$ найдется маршрут такой
длины из вершины~2 в вершину~3. Но вершина~2 имеет единственную исходящую дугу
$(2,3)$, следовательно, указанный маршрут состоит из этой дуги и контура длины
$n^2-4n+2$. В орграфе $G_n$ есть ровно три простых контура: один длины $n$ и
два длины $n-2$. Любой контур можно разбить на простые контуры, а потому число
$n^2-4n+2$ должно -- как длина некоторого контура в $G_n$ -- быть линейной
комбинацией c целыми неотрицательными коэффициентами длин простых контуров,
т.\,е.\ чисел $n$ и $n-2$. (Отметим, что числа $n$ и $n-2$ взаимно просты, так
как $n$ нечетно.) Однако это невозможно по лемме~\ref{sylvester}, поскольку
$n^2-4n+2=n(n-2)-n-(n-2)$.

Допустим, что длина $w$ равна $n^2-4n+4$. Тогда в $G_n$ найдется маршрут такой
длины из вершины~1 в вершину~3. Вершина~1 имеет единственную исходящую дугу
$(1,2)$, следовательно, указанный маршрут состоит из этой дуги и маршрута длины
$n^2-4n+3$ из~2 в~3. В предыдущем абзаце показано, что в $G_n$ нет маршрута
из~2 в~3 с такой длиной.

Предположим, что длина $w$ равна $n^2-4n+5$. Подействовав словом $w$ на
состояние $n-2$, мы должны перейти в состояние~3. Для состояния $n-2$ есть две
исходящие дуги: $(n-2,1)$  с меткой $a$ и $(n-2,n-1)$ с меткой $b$. Поскольку
буква $b$ действует как перестановка множества всех состояний автомата
$\mathrsfs{G}_n$, слово $w$ начинается с буквы $a$. Поэтому первой дугой
маршрута из $n-2$ в~3, соответствующего действию слова $w$, необходимо будет
дуга $(n-2,1)$, за которой следует маршрут из вершины~1 в вершину~3 с длиной
$n^2-4n+4$. В предыдущем абзаце показано, что в $G_n$ нет маршрута из~1 в~3 с
такой длиной.

Пусть, наконец, длина $w$ равна $n^2-4n+6$. Подействовав словом $w$ на каждое
из состояний $n-3$ и $n-1$, мы должны перейти в состояние~3. Если вторая буква
слова $w$ есть $a$, то маршрут из $n-3$ в~3, соответствующий действию слова
$w$, начинается с дуг $(n-3,n-2)$ и $(n-2,1)$, за которыми должен следовать
маршрут из вершины~1 в вершину~3 с длиной $n^2-4n+4$, что невозможно. Если же
вторая буква слова $w$ есть $b$, то маршрут из $n-1$ в~3, соответствующий
действию слова $w$, начинается с дуг $(n-1,n)$ и $(n,1)$, за которыми снова
должен следовать невозможный маршрут из~1 в~3.

Итак, мы показали, что порог синхронизации автомата $\mathrsfs{G}_n$  не может
быть меньше чем $n^2-4n+7$.
\end{proof}


\subsection{Обсуждение и новые гипотезы}

\paragraph*{5.1. Две гипотезы.} Построения и результаты, изложенные в \S4,
свидетельствуют о наличии достаточно тесных связей между порогами синхронизации
автоматов с двумя входными буквами и экспонентами примитивных орграфов. Такой
вывод подтверждается и недавними результатами третьего
автора~\cite{Gu11}. Представляется перспективным дальнейшее исследование
этих связей. Чтобы придать такому исследованию конкретность, мы сформулируем
здесь одну весьма общую гипотезу в духе теоремы~\ref{dulmage}. Эта гипотеза
уточняет гипотезу Черни для случая автоматов с двумя входными буквами и
согласуется со всеми известными нам экспериментальными и теоретическими
результатами.

\begin{conjecture}
\label{general} \emph{(a) (Гипотеза Черни)} Порог синхронизации любого
синхронизируемого $n$-автомата с двумя входными буквами не превосходит
$(n-1)^2$.

\emph{(b)} Если $n>6$, то с точностью до изоморфизма есть ровно один
синхронизируемый $n$-автомат с двумя входными буквами и порогом синхронизации
$(n-1)^2$, а именно, автомат $\mathrsfs{C}_n$.

\emph{(c)} Если $n>6$ то нет ни одного синхронизируемого $n$-автомата с двумя
входными буквами, для которого порог синхронизации был бы больше $n^2-3n+4$, но
меньше $(n-1)^2$.

\emph{(d)} Если $n>7$ и $n$ нечетно, то с точностью до изоморфизма есть ровно
один синхронизируемый $n$-автомат с двумя входными буквами и порогом
синхронизации $n^2-3n+4$, а именно, автомат $\mathrsfs{D}'_n$, ровно два
синхронизируемых $n$-автомата с двумя входными буквами и порогом синхронизации
$n^2-3n+3$, а именно, автоматы $\mathrsfs{W}_n$ и $\mathrsfs{F}_n$, и ровно три
синхронизируемых $n$-автомата с двумя входными буквами и порогом синхронизации
$n^2-3n+2$, а именно, автоматы $\mathrsfs{E}_n$, $\mathrsfs{D}''_n$ и
$\mathrsfs{B}_n$. Нет ни одного синхронизируемого $n$-автомата с двумя входными
буквами, для которого порог синхронизации был бы больше $n^2-4n+7$, но меньше
$n^2-3n+2$.

\emph{(e)} Если $n>8$ и $n$ четно, то с точностью до изоморфизма есть ровно
один синхронизируемый $n$-автомат с двумя входными буквами и порогом
синхронизации $n^2-3n+4$, а именно, автомат $\mathrsfs{D}'_n$, ровно один
синхронизируемый $n$-автомат с двумя входными буквами и порогом синхронизации
$n^2-3n+3$, а именно, автомат $\mathrsfs{W}_n$, и ровно два синхронизируемых
$n$-автомата с двумя входными буквами и порогом синхронизации $n^2-3n+2$, а
именно, автоматы $\mathrsfs{E}_n$ и $\mathrsfs{D}''_n$. Нет ни одного
синхронизируемого $n$-автомата с двумя входными буквами, для которого порог
синхронизации был бы больше $n^2-4n+6$, но меньше $n^2-3n+2$.
\end{conjecture}

Сформулируем еще одну, более специальную, гипотезу, которую можно рассматривать
как количественную форму упоминавшейся в \S3 гипотезы раскраски дорог.
Поскольку теперь известно, что всякий примитивный орграф имеет синхронизируемую
раскраску~\cite{Tr09}, понятие порога синхронизации можно естественным образом
распространить на такие орграфы. А именно, назовем \emph{порогом синхронизации}
примитивного орграфа минимум среди длин синхронизирующих слов для всех его
синхронизируемых раскрасок. Немедленно возникает задача о том, как зависит
порог синхронизации примитивного орграфа от числа его вершин.

Заметим, что орграфы медленно синхронизируемых автоматов могут обладать
раскрасками с малым порогом синхронизации. Рис.~\ref{fig:cerny} иллюстрирует
это замечание: первая раскраска изображенного в левой части рисунка орграфа --
это автомат Черни $\mathrsfs{C}_4$, кратчайшее синхронизирующее слово которого
имеет длину~9, вторая же раскраска может быть синхронизирована словом $a^3$
длины~3. В~этой связи  интересна серия орграфов $W_n$, в которой каждый орграф
имеет единственную (с точностью до изоморфизма) раскраску. Тем самым, порог
синхронизации этой раскраски, установленный в теореме~\ref{theorem:anan},
совпадает с порогом синхронизации орграфа $W_n$ и дает нижнюю оценку в
предлагаемой задаче. Мы предполагаем, что эта оценка в действительности точна.

\begin{conjecture}
\label{hybrid} Порог синхронизации каждого примитивного $n$-орграфа не
превосходит $n^2-3n+3$. Если $n>3$, то с точностью до изоморфизма есть ровно
один примитивный $n$-орграф с порогом синхронизации $n^2-3n+3$, а именно,
орграф $W_n$.
\end{conjecture}

Гипотеза~\ref{hybrid} озвучивалась в нескольких докладах второго автора начиная
с 2008 г., и уже опубликованы некоторые первые частичные результаты в
направлении к ее доказательству~\cite{Carpi&D'Alessandro:2010,Steinberg:2011}.
Ясно, что гипотезу~\ref{hybrid} можно уточнять в духе гипотезы~\ref{general}:
например, единственным (с точностью до изоморфизма) примитивным $n$-орграфом с
порогом синхронизации $n^2-3n+2$ является, по-видимому, орграф $D_n$, и т.\,д.

\paragraph*{5.2. Влияние размера входного алфавита.} В наших экспериментах
рассматривались автоматы с двумя входными буквами. Это ограничение связано с
тем, что рост размера алфавита влияет на количество автоматов значительно
сильнее, чем рост числа состояний, и потому перебор автоматов с более чем двумя
входными буквами даже при небольшом числе состояний находится далеко за
пределами наших вычислительных ресурсов. Табл.~\ref{table:number of automata}
иллюстрирует это обстоятельство. (Данные в таблице рассчитаны по формуле
из~\cite{Lis69}.)

\begin{table}[ht]
\caption{Число достижимых автоматов с 2
и 3 входными буквами} \label{table:number of automata} {\footnotesize
\begin{tabular}{|p{2.5cm}||c|c|c|} \hline
Число состояний & 7 & 8 & 9  \\
\hline 2 входные буквы & \hfill 256\,182\,290 & \hfill 12\,665\,445\,248 & \hfill 705\,068\,085\,303\\
\hline 3 входные буквы &  500\,750\,172\,337\,212 &
572\,879\,126\,392\,178\,688 & 835\,007\,874\,759\,393\,878\,655 \\
\hline
\end{tabular}}
\end{table}

Тем не менее, есть некоторые основания полагать, что поведение исследовавшейся
нами величины (количества синхронизируемых автоматов с фиксированным числом
состояний как функции от значения порога синхронизации) не слишком сильно
зависит от размера алфавита. Например, в экспериментах Трахтмана, о результатах
которых сообщается в~\cite{Tr06,Tr06a}, не было обнаружено ни одного 7-автомата
с 3 или 4 входными буквами, порог синхронизации которого был бы больше 32, но
меньше 36. Таким образом, величина разрыва между максимальным и следующим за
ним возможным значениями порога синхронизации здесь такая же, как для
7-автоматов с двумя входными буквами.

Отметим еще наблюдение, впервые сделанное, по видимому, в~\cite{Be10}: если
имеется верхняя оценка вида $\Theta(n^2)$ для порогов синхронизации
синхронизируемых $n$-автоматов с двумя входными буквами, то оценка такого же
порядка (возможно, с худшей константой) существует для порогов синхронизации
синхронизируемых $n$-автоматов с любым фиксированным размером входного
алфавита.

%-----------------------Медленно синхронизируемые эйлеровы автоматы---------------------------------------------------------------------------------
\newpage
\section{Медленно синхронизируемые эйлеровы автоматы}
\label{ch:euler}

В этой главе для всякого нечтного $n\ge 5$ мы приводим синхронизируемый эйлеров автомат 
с $n$ состояниями для которого порог синхронизации равен $\frac{n^2 - 3n
+ 4}{2}$. Также мы раскрываем некоторые взаимосвязи между порогом синхронизации 
синхронизируемого автомата и последовательностью экспонент автомата.

\subsection{Введение}
\label{intro}

Напомним результат Яркко Кари~\cite{Ka03}, поскольку он послужил отправной точкой 
для данной главы.

Кари~\cite{Ka03} показал, что всякий синхронизируемый эйлеров автомат с $n$
состояниями обладает синхронизирующим словом длины не более $n^2 -3n + 3$. Несмотря на то,
что данный результат подтверждает гипотезу Черни для класса эйлеровых автоматов, мы не можем
похвастаться глубоким пониманием вопроса синхронизации эйлеровых автоматов, поскольку 
соответствующей нижней оценки так и не было найдено. Для получения данной нижней оценки
нам нужно построить серию эйлеровых автоматов с большим порогом синхронизации.

Первая попытка состояла в применении техники из главы~\ref{ch:slow_synch}.
Эйлеровы орграфы с большой экспонентой были охарактеризованы Шенем в работе~\cite{Shen00}. 
Но оказалось, что таким образом мы не можем получить результаты, близкие к тем, что дают
вычислительные эксперименты. Поэтому, потребовалось некоторое усовершенствование
техники главы~\ref{ch:slow_synch}. В качестве демонстрации нового подхода мы приводим
серию синхронизируемых эйлеровых автоматов, порог синхронизации которых в два раза больше,
чем у той, что получена прямым применением техники главы~\ref{ch:slow_synch}.

\subsection{Предварительные сведения}
\label{ch:euler:preliminaries}

Given a DFA $\mathrsfs{A}=\langle Q,\Sigma\rangle$, its \emph{underlying graph}
$D(\mathrsfs{A})$ has $Q$ as the vertex set and has an edge $e_\tau$ with
$t(e_\tau)=q$, $h(e_\tau)=q\cdot a$ for each transition $\tau=(q,a,q\cdot a)$
of $\mathrsfs{A}$. We stress that if two transitions have a common source and a
common target (but different labels), then they give rise to different edges
(with a common tail and a common head). It is easy to see that a graph $D$ is
isomorphic to the underlying graph of some DFA if and only if each vertex of
$D$ serves as the tail for the same number of edges (the number is called the
\emph{outdegree} of $D$). In the sequel, we always consider only graphs
satisfying this property. Every DFA $\mathrsfs{A}$ such that $D\cong
D(\mathrsfs{A})$ is called a \emph{coloring} of $D$. Thus, every coloring of
$D$ is labeling its edges of by letters from some alphabet whose cardinality is
equal to the outdegree of $D$ such that edges with a common tail get different
colors. Fig.\,\ref{fig:two colorings} shows a graph and two of its colorings by
$\Sigma=\{a,b\}$.
\begin{figure}[ht]
 \begin{center}
  \unitlength=2.4pt
    \begin{picture}(18,30)(-70,-4)
    \gasset{Nw=6,Nh=6,Nmr=3}
    \node(A1)(0,18){$1$}
    \node(A2)(18,18){$2$}
    \node(A3)(18,0){$3$}
    \node(A4)(0,0){$4$}
    \drawloop[loopangle=135](A1){$a$}
    \drawloop[loopangle=45](A2){$b$}
    \drawloop[loopangle=-45](A3){$b$}
    \drawedge(A1,A2){$b$}
    \drawedge(A2,A3){$a$}
    \drawedge(A3,A4){$a$}
    \drawedge[curvedepth=3](A4,A1){$a$}
    \drawedge[curvedepth=-3,ELside=r](A4,A1){$b$}
    \end{picture}
 \begin{picture}(18,30)(0,-4)
    \gasset{Nw=6,Nh=6,Nmr=3}
    \node(A1)(0,18){$1$}
    \node(A2)(18,18){$2$}
    \node(A3)(18,0){$3$}
    \node(A4)(0,0){$4$}
    \drawloop[loopangle=135](A1){$a$}
    \drawloop[loopangle=45](A2){$a$}
    \drawloop[loopangle=-45](A3){$a$}
    \drawedge(A1,A2){$b$}
    \drawedge(A2,A3){$b$}
    \drawedge(A3,A4){$b$}
    \drawedge[curvedepth=3](A4,A1){$a$}
    \drawedge[curvedepth=-3,ELside=r](A4,A1){$b$}
    \end{picture}
 \begin{picture}(18,30)(70,-4)
    \gasset{Nw=6,Nh=6,Nmr=3}
    \node(A1)(0,18){$1$}
    \node(A2)(18,18){$2$}
    \node(A3)(18,0){$3$}
    \node(A4)(0,0){$4$}
    \drawloop[loopangle=135](A1){}
    \drawloop[loopangle=45](A2){}
    \drawloop[loopangle=-45](A3){}
    \drawedge(A1,A2){}
    \drawedge(A2,A3){}
    \drawedge(A3,A4){}
    \drawedge[curvedepth=3](A4,A1){}
    \drawedge[curvedepth=-3](A4,A1){}
    \end{picture}
 \end{center}
 \caption{A graph and two of its colorings}
 \label{fig:two colorings}
\end{figure}

A graph $D=\langle V,E\rangle$ is said to be \emph{strongly connected} if for
every pair $(v,v')\in V\times V$, there exists a path from $v$ to $v'$. A graph
is \emph{Eulerian} if it is strongly connected and each of its vertices serves
as the tail and as the head for the same number of edges. A DFA is said to be
\emph{Eulerian} if so is its underlying graph. More generally, we will freely
transfer graph notions (such as path, cycle, etc) from graphs to automata they
underlie.

A graph $D=\langle V,E\rangle$ is called \emph{primitive} if there exists a
positive integer $t$ such that for every pair $(v,v')\in V\times V$, there
exists a path from $v$ to $v'$ of length precisely $t$. The least $t$ with this
property is called the \emph{exponent} of the digraph $D$ and is denoted by
$\exp(D)$. 
%FIX
Varios facts concearning this classical notions can be found
in~\cite{BrRy91}.

Let $w$ be a word over the alphabet $\Sigma = \{a_1, a_2, \ldots, a_k\}$. We
say that a word $u\in\Sigma^*$ \emph{occurs $\ell$ times as a factor of $w$} if
there are exactly $\ell$ different words $x_1, \ldots, x_\ell \in \Sigma^*$
such that for each $i$, $1 \leq i \leq \ell$, there is a word $y_i \in
\Sigma^*$ for which $w$ decomposes as $w = x_iuy_i$. The number $\ell$ is
called the \emph{number of occurrences of $u$ in $w$} and is denoted by
$|w|_u$. The vector $(|w|_{a_1}, |w|_{a_2}, \ldots,
|w|_{a_k})\in\mathbb{N}^k_0$ is called the \emph{Parikh vector} of the word
$w$; here $\mathbb{N}_0$ stands for the set of non-negative integers.

Now suppose that $\mathrsfs{A}=\langle Q,\Sigma\rangle$ is a DFA and $\alpha$
is a path in $\mathrsfs{A}$ labelled by a word $w\in\Sigma^*$. If a vector
$\mathsf{v}\in\mathbb{N}^k_0$ is equal to the Parikh vector of $w$, then we say
that $\mathsf{v}$ is the \emph{Parikh vector} of the path $\alpha$. We refer to
any path that has $\mathsf{v}$ as its Parikh vector as a
$\mathsf{v}$-\emph{path}.

\subsection{Основные результаты}
\label{sea}

Вначале мы приведем переосмысленный вариант техники, а также расширим ее.

Рассмотрим произвольный синхронизируемый автомат $\mathrsfs{A} = \langle Q, \Sigma
\rangle$. Пусть $w$ -- синхронизирующее слово автомата $\mathrsfs{A}$, которое переводит
автомат в состояние $r \in Q$, т.е., $p\cdot w=r$ для всякого $p\in Q$. Тогда, для 
всякого состояния $p \in Q$, слово $w$ помечает путь из $p$ в $r$. Таким образом, для
всякого состояния $p \in Q$ найдется путь длины $|w|$ из $p$ в $r$ в орграфе $D(\mathrsfs{A})$. 
Это приводит нас к следующему понятию. Мы назовем сильно связный автомат граф $D=(V,E)$ 
0-\emph{примитивным}, если найдутся целое число $k > 0$ и вершина $r \in V$ такие, что для 
всякой вершины $p\in V$ существует путь длины $k$ из $p$ в $r$. Наименьшее число $k$
с таким свойством (over all possible choices of $r$) называется 0-\emph{экспонентой} орграфа 
$D$ и обозначается $\exp_0(D)$. Для простоты обозначений мы будем писать $\exp_0(\mathrsfs{A})$
вместо $\exp_0(D(\mathrsfs{A}))$. Нетрудно видеть, что всякий сильно связный синхронизируемый 
автомат $\mathrsfs{A}$ 0-примитивен и справедливо следующее неравенство:
\begin{equation}
\label{first inequality} 
\rt(\mathrsfs{A})\geq \exp_0(\mathrsfs{A}).
\end{equation}

Легко понять, что понятия 0-примитивности и примитивности эквивалентны. В самом деле,
всякий примитивный орграф по определению является 0-примитивным. В обратную сторону, 
пусть $D$ -- это 0-примитивный орграф на $n$ вершинах. По определению, найдутся пути 
длины $\exp_0(D)$ из всякой вершины до некоторой фиксированной вершины $r$. Рассмотрим две 
произвольные вершины $p$ и $q$ орграфа $D$. Поскольку $D$ сильно связен, то существует путь $\alpha$
длины не более $n - 1$ из $r$ до $q$. Пусть $\beta$ -- некоторый путь длины $n - 1 - |\alpha|$
из вершины $p$, и пусть $s$ -- заключительная вершина пути $\beta$. По определению 0-экспоненты найдется
путь $\gamma$ длины $\exp_0(D)$ из $s$ в $r$. Тогда путь $\beta\gamma\alpha$ ведет из $p$ в $q$ 
(через $s$ и $r$), причем $|\beta\gamma\alpha|=n - 1 + \exp_0(D)$. Таким образом, орграф $D$ 
примитивен, и более того, справедливо следующее неравенство:
\begin{equation}
\label{second inequality} \exp_0(D) + n - 1 \geq \exp(D).
\end{equation}

Также очевидно, что $\exp(D) \geq \exp_0(D)$. Следовательно, $\exp(D)$ и $\exp_0(D)$ отличаются на 
величину линейно зависящую от $n$.

Покажем, как можно использовать понятие 0-экспоненты для построения эйлеровых автоматом с
довольно большим порогом синхронизации. В качестве основы нам необходимы эйлеровы орграфы с 
максимальной экспонентой (или 0-экспонентой) среди всех примитивных эйлеровых орграфов на $n$ 
вершинах. Такие орграфы были классифицированы Шенем~\cite{Shen00}.

Для всякого нечетного $n \geq 5$, рассмотрим автомат $\mathrsfs{D}_n$ со множеством состояний
$Q=\{1,2,\dots,n\}$ и входными буквами $a$ и $b$, которые действуют на $Q$
следующим образом:

$ 1 \cdot a = 2$, $1 \cdot b = 3$; $(n - 1) \cdot a = 2$, $(n - 1) \cdot b =
1$; $n \cdot a = 1$, $n \cdot b = 3$; и для всякого $1 < k < n - 1$
$$k \cdot a=\begin{cases}
k + 2 &\text{если } k \text{ четно},\\
k + 1 &\text{если } k \text{ нечетно};
\end{cases}\quad
k \cdot b=\begin{cases}
k + 3 &\text{если } k \text{ четно},\\
k + 2 &\text{если } k \text{ нечетно}.
\end{cases}$$

Автомат $\mathrsfs{D}_n$ изображен на Рис.\,\ref{fig:d}. Мы будем обозначать орграф автомата 
$\mathrsfs{D}_n$ через $\mathcal{D}_n$.

\begin{figure}[h]
  \begin{center}
    \unitlength=4pt
    \begin{picture}(75, 35)(0,-7)
    \gasset{curvedepth=0}
    \thinlines
    \node(A0)(0,7){$1$}
    \node(A1)(12,15){$2$}
    \node(A2)(12,0){$3$}
    \node(A3)(27,15){$4$}
    \node(A4)(27,0){$5$}
    \node(A5)(43,15){$6$}
    \node(A6)(43,0){$7$}
    \node(An3)(60,15){$n{-}3$}
    \node(An2)(60,0){$n{-}2$}
    \node(An1)(75,15){$n{-}1$}
    \node(An)(75,0){$n$}
    \drawedge(A0,A1){$a$}
    \drawedge[ELpos=45](A0,A2){$b$}
    \drawedge[ELpos=45](A1,A3){$a$}
    \drawedge[ELpos=30](A1,A4){$b$}
    \drawedge[ELpos=30](A2,A3){$a$}
    \drawedge[ELpos=45](A2,A4){$b$}
    \drawedge[ELpos=45](A3,A5){$a$}
    \drawedge[ELpos=30](A3,A6){$b$}
    \drawedge[ELpos=30](A4,A5){$a$}
    \drawedge[ELpos=45](A4,A6){$b$}
     \put(50,0){$\ldots$}
     \put(50,15){$\ldots$}
    \drawedge[ELpos=45](An3,An1){$a$}
    \drawedge[ELpos=30](An3,An){$b$}
    \drawedge[ELpos=30](An2,An1){$a$}
    \drawedge[ELpos=45](An2,An){$b$}
    \drawcurve(72.7,17)(60,19)(27,19)(14.2, 17)
    \drawcurve(74.5,18)(60,22)(27,23)(10,20)(0, 10)
    \put(39,24){$b$}
    \put(45,20){$a$}
    \drawcurve(72.7,-2)(60,-4)(27,-4)(14.2, -2)
    \drawcurve(74.5,-3)(60,-7)(27,-7)(10,-5)(0, 4)
    \put(39,-9){$a$}
    \put(45,-6.5){$b$}
    \end{picture}
  \end{center}
  \caption{Автомат $\mathrsfs{D}_n$}
  \label{fig:d}
\end{figure}


\begin{proposition}
\label{shen} Если $\mathcal{G}$ -- примитивный эйлеров орграф со степенью исхода
$2$ на $n$ вершинах, $n \geq 8$, то $\exp(\mathcal{G}) \leq \frac{(n - 1)^2}{4}
+ 1$. Более того, равенство достигается только на орграфе $\mathcal{D}_n$.
\end{proposition}

Из предложения~\ref{shen} и неравенств \eqref{first inequality} и
\eqref{second inequality} следует, что всякая синхронизируемая раскраска орграфа
$\mathcal{D}_n$ обладает порогом синхронизации порядка $\frac{n^2}{4} + o(n^2)$. В частности,
мы можем доказать следующий результат:

\begin{proposition}
Порог синхронизации автомата $\mathrsfs{D}_n$ равен $\frac{n^2 - 4n +
11}{4}$.
\end{proposition}

\begin{proof}
Прежде всего, оценим $\exp_0(\mathrsfs{D}_n)$. Заметим, что для всякой $\ell
\geq \exp_0(\mathrsfs{D}_n)$ найдется цикл длины $\ell$ в
$\mathrsfs{D}_n$. Действительно, пусть $r$ такое состояние, что для всякого
$p \in Q$ найдется путь длины $\exp_0(\mathrsfs{D}_n)$ из $p$ в $r$. Рассмотрим
теперь произвольный путь $\alpha$ длины $\ell - \exp_0(\mathrsfs{D}_n)$ из $r$.
Пусть $s$ -- конец пути $\alpha$. По выбору $r$, найдется также путь $\beta$ длины 
$\exp_0(\mathrsfs{D}_n)$ из $s$ в $r$. Таким образом, путь $\alpha\beta$ образует
цикл длины $\ell$.

Рассмотрим теперь разбиение $\pi$ множества $Q$ на $\frac{n+1}{2}$ классов
$V_i$, $0\le i \le \frac{n - 1}{2}$, где $V_0 = {1}$ и $V_i = \{2i,2i+1\}$
для всякого $0 < i \le \frac{n - 1}{2}$. Определим оргаф $\mathcal{G}_n$ с фактор-множеством
$Q/\pi$ как множеством вершин и с ребрами индуцированными ребрами $\mathcal{D}_n$ 
следующим образом: существует ребро $e'$ в $\mathcal{G}_n$ с
$t(e') = V_i$ и $h(e) = V_j$  тогда и только тогда, когда существует ребро $e$ в
$\mathcal{D}_n$ с $t(e)\in V_i$ и $h(e) \in V_j$. Тогда всякий цикл в
$\mathcal{D}_n$ порождает цикл той же длины в $\mathcal{G}_n$. В частности, для
всякого $\ell \ge \exp_0(\mathrsfs{D}_n)$ найдется цикл длины $\ell$ в $\mathcal{G}_n$.
Легко видеть, что орграф
$\mathcal{G}_n$ содержит в точности два простых цикла: один длины $\frac{n -
1}{2}$, а другой длины $\frac{n + 1}{2}$. Мы можем заключить, что всякое $\ell\ge
\exp_0(\mathrsfs{D}_n)$ выражается в виде неотрицательной линейной комбинации
$\frac{n - 1}{2}$ и $\frac{n + 1}{2}$.

Тут мы напомним следующий известный результат из арифметики.

\begin{lemma}[{\mdseries\cite[Теорема 2.1.1]{RaAl05}}]
\label{sylvester} Если $k_1,k_2$ взаимно просты, то $k_1k_2-k_1-k_2$
является наибольшим натуральным числом, которое не выражается в виде неотрицательной
линейной комбинации $k_1$ и $k_2$.
\end{lemma}

Применяя лемму~\ref{sylvester} мы заключаем, что $\exp_0(\mathrsfs{D}_n) \geq
\frac{n^2 -4n + 3}{4}$ и не существует цикла длины $\frac{n^2 -4n - 1}{4}$
в $\mathcal{G}_n$. Неравенство~\ref{first inequality} влечет
$\rt(\mathrsfs{D}_n) \geq \frac{n^2 -4n + 3}{4}$, и нам осталось исключить два случая:
$\rt(\mathrsfs{D}_n)= \frac{n^2 -4n + 3}{4}$ и $\rt(\mathrsfs{D}_n) =
\frac{n^2 -4n + 7}{4}$. Это не представляет трудности.

Пусть $w$ -- это кратчайшее синхронизирующее слово для $\mathrsfs{D}_n$. Обозначим через
$r \in V_i$ то состояние, в которое $w$ переводит $\mathrsfs{D}_n$. Заметим, что $i \neq 0$
(иначе слово, полученное удалением последней буквы $w$, будет более коротким синхронизирующим
словом, что невозможно).

Если $|w|=\frac{n^2 -4n + 3}{4}$, то пусть $w = xw'$ для некоторой буквы $x$ и
применим слово $w$ к некоторому состоянию в $V_{i - 1}$. Ясно, что $w'$ порождает
цикл из $V_i$ в $V_i$ в $\mathcal{G}_n$. Этот цикл имеет длину $\frac{n^2 -4n - 1}{4}$, 
что невозможно.

Предположим наконец, что длина $w$ равна $\frac{n^2 -4n + 7}{4}$. Если $i \neq
1$, то рассуждая как ранее мы приходим к противоречию. 
(Мы применяем $w$ к состоянию из $V_{i - 2}$.)  Если $i = 1$,
то пусть $w = xyw'$ для некоторых букв $x$ и $y$. В зависимости от $x$, либо $n \cdot
xy \in V_1$, либо $(n - 1) \cdot xy \in V_1$. В обоих случаях $w'$ порождает цикл из
$V_1$ в $V_1$ в $\mathcal{G}_n$ длины $\frac{n^2 -4n - 1}{4}$, что невозможно.

Таким образом мы можем заключить, что порог синхронизации автомата $\mathrsfs{D}_n$ по меньшей мере
$\frac{n^2 -4n + 11}{4}$. Поскольку слово $aa(ba^{\frac{n - 1}{2}})^\frac{n -
5}{2}bb$ синхронизирует автомат $\mathrsfs{D}_n$, мы заключаем, что полученная оценка точна.
\end{proof}

Наши вычислительные эксперименты показывают, что наибольший порог синхронизации
среди всех синхронизируемых раскрасок $\mathcal{D}_n$ равен $\frac{(n - 1)^2}{4} +
1$. Поэтому, $\frac{n^2}{4} + o(n^2)$ является наилучшей нижней оценкой на порог синхронизации
синхронизируемого эйлерового автомата с $n$ состояниями, которая может быть получена из эйлеровых 
орграфов с большой экспонентой. Однако, основной результат этой главы (теорема~\ref{th:matr} ниже)
гласит, что для всякого нечетного $n$ существует эйлеров автомат с $n$ состояниями и порогом 
синхронизации $\frac{n^2 -3n + 4}{2}$. Это указывает на то, что понятие 0-экспоненты недостаточно
сильно для выделения примеров эйлеровых автоматов с наибольшим порогом синхронизации. 
Причина кроется в том, что мы отбросили слишком много информации при переходе от синхронизируемости
к 0-примитивности. Мы утратили всю информацию о путях, соответствующих кратчайшему синхронизирующему
слову, кроме их длины. Таким образом, мы применяем другое понятие, которое сохраняет больше информации,
а именно вектора Париха путей.


Рассмотрим детерминированный конечный автомат $\mathrsfs{A} = \langle Q, \Sigma \rangle$ с $|\Sigma| = k$
и зафиксируем некоторый порядок на буквах в $\Sigma$. Мы определим подмножество
$\mathrm{E}_1(\mathrsfs{A})$ множества $\mathbb{N}^{k}_0$ следующим образом: вектор
$\mathsf{v} \in \mathbb{N}^{k}_0$ принадлежит $\mathrm{E}_1(\mathrsfs{A})$ тогда и только тогда, 
когда найдется состояние $r \in Q$ такое, что для всякого $p \in Q$, существует
$\mathsf{v}$-путь из $p$ в $r$. Если же множество $\mathrm{E}_1(\mathrsfs{A})$ не пусто, то мы
называем автомат $\mathrsfs{A}$ \emph{$1$-примитивным}. Минимальное значение суммы $i_1 + i_2 + \dots +
i_k$ среди всех $k$-векторов $(i_1, i_2, \ldots, i_k)$ из
$\mathrm{E}_1(\mathrsfs{A})$ назовем \emph{$1$-экспонентой} автомата
$\mathrsfs{A}$ и будем обозначать $\exp_1(\mathrsfs{A})$. Необходимо отметить, что очень близкое понятие
для мультиграфов с раскрашенными ребрами изучалось в работах
\cite{ShSu03,OlShDr02}. Ясно, что всякий синхронизируемый автомат $\mathrsfs{A}$
1-примитивный и справедливо неравенство:
\begin{equation}
\label{third inequality} \rt(\mathrsfs{A})\geq \exp_1(\mathrsfs{A}).
\end{equation}

Для того, чтобы продемонстрировать как понятие $1$-экспоненты может быть применено, мы докажем одно 
утверждение, касающиеся автомата Черни $\mathrsfs{C}_n$ (это утверждение будет использовано в 
доказательстве главного результата этой главы). 

Для напоминания, автомат $\mathrsfs{C}_n$ при $n = 7$ изображен на рис.~\ref{fig:cerny}.

\begin{figure}[ht]
\begin{center}
\unitlength .5mm
\begin{picture}(50,80)(-20,-80)
\gasset{Nw=14,Nh=14,Nmr=7,loopdiam=10}
\node(n0)(0,-5){1}
\node(n1)(-30,-20){7} \node(n2)(30,-20){2}
\node(n3)(-35,-50){6} \node(n4)(35,-50){3}
\node(n5)(-17,-75){5} \node(n6)(17,-75){4}
\drawedge[ELdist=2.0](n1,n0){$b$}
\drawedge[ELdist=1.5](n2,n4){$b$}
\drawedge[ELdist=1.7](n0,n2){$a, b$}
\drawedge[ELdist=1.7](n3,n1){$b$}
\drawedge[ELdist=1.7](n4,n6){$b$}
\drawedge[ELdist=1.7](n6,n5){$b$}
\drawedge[ELdist=1.7](n5,n3){$b$}
\drawloop[ELdist=1.5,loopangle=25](n2){$a$}
\drawloop[ELdist=1.5,loopangle=150](n1){$a$}
\drawloop[ELdist=2.4,loopangle=340](n4){$a$}
\drawloop[ELdist=1.5,loopangle=200](n3){$a$}
\drawloop[ELdist=1.5,loopangle=300](n6){$a$}
\drawloop[ELdist=1.5,loopangle=240](n5){$a$}
\end{picture}
\end{center}
\caption{Автомат $\mathrsfs{C}_n$ при $n = 7$} \label{fig:cerny}
\end{figure}


\begin{proposition}
\label{th:cerny} Всякое синхронизирующее слово автомата $\mathrsfs{C}_n$ содержит не
менее $n^2 - 3n + 2$ вхождений буквы $b$ и не менее $n - 1$
вхождения буквы $a$.
\end{proposition}

\begin{proof}
Поскольку автомат $\mathrsfs{C}_n$ синхронизируем, то множество
$\mathrm{E}_1(\mathrsfs{C}_n)$ не пусто. Мы воспользуемся следующим простым
свойством автомата $\mathrm{E}_1(\mathrsfs{C}_n)$: если $\mathsf{v} = (\alpha,
\beta) \in \mathrm{E}_1(\mathrsfs{C}_n)$, тогда для всякого $t \in \mathbb{N}$
справедливо $(\alpha, \beta + t) \in \mathrm{E}_1(\mathrsfs{C}_n)$. В самом деле, 
пусть $r$ -- это такое состояние, что для всякого $p \in Q$ найдется $\mathsf{v}$-путь
из $p$ в $r$. Мы хотим показать, что существует также $(\alpha, \beta + t)$-путь из 
произвольного состояния $p$ в $r$. Пусть $q = p\cdot b^{t}$, тогда по определению $r$
найдется $\mathsf{v}$-путь из $q$ в $r$. Дополняя этот путь с начала путем из $p$, помеченным
$b^t$, мы получаем $(\alpha,\beta + t)$-путь из $p$ в $r$.

Заметим теперь, что существует $\mathsf{v}$-путь из $r$ в $r$. Этот путь является циклом и он
может быть разложен в комбинацию простых циклов автомата $\mathrsfs{C}_n$. Простыми циклами в $\mathrsfs{C}_n$
являются петли помеченные буквой $a$ с вектором Париха $(1,0)$, цикл
$$1\xrightarrow{a}2\xrightarrow{b}3\xrightarrow{b}\dots\xrightarrow{b}n-1\xrightarrow{b}n\xrightarrow{b}1$$
с вектором Париха $(1,n-1)$ и цикл
$$1\xrightarrow{b}2\xrightarrow{b}3\xrightarrow{b}\dots\xrightarrow{b}n-1\xrightarrow{b}n\xrightarrow{b}1$$
с вектором Париха $(1,n-1)$. Поэтому, найдутся $x, y, z \in
\mathbb{N}_0$ такие, что выполнено следующее равенство:
$$(\alpha,\beta) = x (1,0) + y (1, n - 1) + z(0,n).$$
Отсюда немедленно следует, что $\beta = y(n - 1) + zn$. Поскольку для всякого $t \in
\mathbb{N}$ вектор $(\alpha, \beta + t)$ также принадлежит
$\mathrm{E}_1(\mathrsfs{C}_n)$, мы получаем, что $\beta + t$ также представимо
в виде неотрицательной линейной комбинации $n$ и $n - 1$.
Лемма~\ref{sylvester} влечет, что $\beta\ge n(n-1)-n-(n-1)+1=n^2-3n+2$. Если $w$ -- синхронизирующее
слово автомата $\mathrsfs{C}_n$, то вектор Париха $w$ принадлежит $\mathrm{E}_1(\mathrsfs{C}_n)$,
поскольку $w$ содержит по меньшей мере $n^2 - 3n + 2$ вхождений буквы $b$.

Остается показать, что $w$ содержит по меньшей мере $n - 1$ вхождение буквы $a$. 
Заметим, что для всякого множества состояний $S$, мы получаем $|S\cdot b|=|S|$ и
$|S\cdot a|\ge|S|-1$. Таким образом, чтобы уменьшить мощность с $n$ до 1, необходимо
применить $a$ по меньшей мере $n-1$ раз, и всякое слово $w$ со свойством $|Q\cdot w|=1$
должно содержать по меньшей мере $n - 1$ вхождение слова $a$.
\end{proof}

Как следствие, мы немедленно получаем результат Черни~\cite[Lemma~1]{Ce64} о том, что 
$\rt(\mathrsfs{C}_n)=(n - 1)^2$. Действительно, предложение~\ref{th:cerny} влечет, что 
порог синхронизации по меньшей мере $(n - 1)^2$. Нетрудно проверить, что слово
$(ab^{n - 1})^{n - 2}a$ длины $(n - 1)^2$ является синхронизирующим для $\mathrsfs{C}_n$. 
Также, мы можем заключить, что синхронизирующее слово $w$ автомата $\mathrsfs{C}_n$ наименьшей 
длины определяется единственным образом. Действительно, $w$ не может оканчиваться или начинаться
на $b$, поскольку $b$ действует как циклическая перестановка. Поэтому, $w = aua$ и слово $u$ содержит $n^2 -
3n + 2$ вхождения буквы $b$ и $n - 3$ вхождения буквы $a$. Заметим, что $b^n$
не может быть фактором $u$, поскольку $b^n$ является тождественным преобразованием.
Ясно, что существует лишь один способ поместить $n - 3$ буквы $a$ в слово
$b^{n^2-3n+2}$ таким образом, что полученное слово не содержит $b^n$ в качестве фактора. Несмотря на то, что
серия $\mathrsfs{C}_n$ очень хорошо изучена, кажется, что данный результат сообщается впервые.

Заметим, что $\exp_0(\mathrsfs{C}_n)=n-1$ и мы не можем получить точную по порядку нижнюю оценку
на порог синхронизации $\rt(\mathrsfs{C}_n)$ с использованием неравенства~\eqref{second
inequality}. В первой главе точная нижняя оценка на $\rt(\mathrsfs{C}_n)$ была получена
с помощью трюка и сведения к орграфам с наибольшей 0-экспонентой из \cite{Wi50}. Здесь же,
предложение~\ref{th:cerny} влечет, что $\exp_1(\mathrsfs{C}_n)$ близка к
$(n-1)^2$, поэтому неравенство~\eqref{third inequality} сразу дает довольно сильную оценку.
%FIX
В действительности, $\exp_1(\mathrsfs{C}_n) = \rt(\mathrsfs{C}_n)$. Таким образом,
неравенство~\eqref{third inequality} на самом деле дает точную нижнюю оценку. Но нам потребуются дополнительные
усилия, чтобы это доказать.

\begin{proposition}
Для всякого $n \geq 2$ 1-экспонента автомата $\mathrsfs{C}_n$ равна $(n - 1)^2$.
\end{proposition}

\begin{proof}
Рассмотрим слова $u_1$, $u_2, \ldots, u_n$ с одним и тем же вектором Париха $(\alpha, \beta)$, 
такие, что $i \cdot u_i = 1$. Позднее мы увидим, что такие слова существуют. 
Путь, помеченный $u_i$ может быть разделен естественным образом на две части: 
путь из состояния $i$ до первого появления состояния $1$, и
цикл, проходящий через состояние $1$. Представляя вторую часть пути тем же образом, что
и в доказательстве предложения~\ref{th:cerny} мы получаем следующее равенство:
$$(\alpha,\beta) = (s_i, n - i + 1) + x_i (1,0) + y_i (1, n - 1) + z_i (0,n),$$
где $s_i, x_i, y_i, z_i$ неотрицательные числа. Мы хотим показать, что для некоторого 
$i$ справедливо $y_i \geq n - 1$. 
%Firstly, let us focus on amount of letters $b$ only.
%For every $i$ we have $ \beta = n - i + 1 + y_i(n - 1) + z_in.$ It is enough for us
%to consider this equalities by modulo $n$ only. So, $\beta \equiv -i + 1 - y_i\ (mod\ n)$.
%And after simplyf
Рассмотрим число букв $b$ по модулю $n$.
Для всякого $i$ мы имеем $ \beta \equiv n - i + 1 + y_i(n - 1) + z_in\ (mod\ n).$
%So, $\beta \equiv -i + 1 - y_i\ (mod\ n)$.
Тогда, легко понять, что:
$$ y_i \equiv 1 - i - \beta\ (mod\ n).$$
Поскольку это равенство справедливо для всякого $i \in \{1,2, \ldots, n\}$ мы заключаем, что 
найдется $j$ такое, что $y_j \equiv n - 1\ (mod\ n)$. Неравенство $y_j \geq 0$ влечет
$y_j \geq n - 1$. Таким образом, мы получаем $|u_j| \geq ny_j \geq n(n - 1)$.

Пусть $v_1, v_2, \ldots, v_n$ это те слова, на которых достигается 1-экспонента $\mathrsfs{C}_n$,
%and $1 \cdot v_1 = \ldots = n \cdot v_n = r$.
и $r$ -- это то состояние, в котором мы оказываемся после их применения к соответствующим 
состояниям. Пусть $w$ -- это кратчайший путь из $r$ в 1. Заметим, что $|w| \leq n - 1$. Тогда слова
$v_1w, v_2w, \ldots, v_nw$  имеют общий вектор Париха и переводят соответствующие состояния в состояние 1. 
По первой части доказательства мы имеем
$\exp_1(\mathrsfs{C}_n) + n - 1 \geq n(n - 1)$. Таким образом, 
$\exp_1(\mathrsfs{C}_n) \geq (n - 1)^2$. 
Неравенство~\ref{third inequality} и тот факт, что $\rt(\mathrsfs{C}_n) = (n - 1)^2$ 
влекут за собой то, что указанная оценка точна.
\end{proof}
%ENDFIX


Теперь мы готовы к доказательству основного результата данной главы. Определим автомат
$\mathrsfs{M}_n$ (от слова Matricaria) на множестве состояний $Q=\{1,2,\dots,n\}$, где
$n \geq 5$ нечетно, где буквы $a$ и $b$ действуют следующим образом:
$$k \cdot a=\begin{cases}
k &\text{if } k \text{ is odd},\\
k + 1 &\text{if } k \text{ is even};
\end{cases}\quad
k \cdot b=\begin{cases}
k + 1 &\text{if } k \neq n \text{ is odd},\\
k &\text{if } k \text{ is even},\\
1 &\text{if } k = n.
\end{cases}$$
Заметим, что автомат $\mathrsfs{M}_n$ эйлеров. Автомат $\mathrsfs{M}_n$ при
$n = 7$ изображен на рис.~\ref{fig:matr} слева.
\begin{figure}[ht]
\begin{center}
\unitlength .5mm
\begin{picture}(50,100)(40,-88)
\gasset{Nw=14,Nh=14,Nmr=7,loopdiam=10}
\node(n0)(0,-5){1}
\node(n1)(-30,-20){7} \node(n2)(30,-20){2}
\node(n3)(-35,-50){6} \node(n4)(35,-50){3}
\node(n5)(-17,-75){5} \node(n6)(17,-75){4}
\drawedge[ELdist=2.0](n1,n0){$b$}
\drawedge[ELdist=1.5](n2,n4){$a$}
\drawedge[ELdist=1.7](n0,n2){$b$}
\drawedge[ELdist=1.7](n3,n1){$a$}
\drawedge[ELdist=1.7](n4,n6){$b$}
\drawedge[ELdist=1.7](n6,n5){$a$}
\drawedge[ELdist=1.7](n5,n3){$b$}
\drawloop[ELdist=1.5,loopangle=90](n0){$a$}
\drawloop[ELdist=1.5,loopangle=25](n2){$b$}
\drawloop[ELdist=1.5,loopangle=150](n1){$a$}
\drawloop[ELdist=2.4,loopangle=340](n4){$a$}
\drawloop[ELdist=1.5,loopangle=200](n3){$b$}
\drawloop[ELdist=1.5,loopangle=300](n6){$b$}
\drawloop[ELdist=1.5,loopangle=240](n5){$a$}
\end{picture}

\begin{picture}(1,1)(-65,-96)
\gasset{Nw=14,Nh=14,Nmr=7,loopdiam=10}
\node(n0)(0,-5){1}
\node(n1)(-30,-20){7} \node(n2)(30,-20){2}
\node(n3)(-35,-50){6} \node(n4)(35,-50){3}
\node(n5)(-17,-75){5} \node(n6)(17,-75){4}
\drawedge[ELdist=2.0](n1,n0){$b,c$}
\drawedge[ELdist=1.5,ELside=r](n2,n6){$c$}
\drawedge[ELdist=1.5](n0,n2){$b,c$}
\drawedge[ELdist=1.7,ELside=r](n3,n0){$c$}
\drawedge[ELdist=1.7](n4,n6){$b,c$}
\drawedge[ELdist=1.7,ELside=r](n6,n3){$c$}
\drawedge[ELdist=1.7](n5,n3){$b,c$}
\drawloop[ELdist=1.5,loopangle=25](n2){$b$}
\drawloop[ELdist=1.5,loopangle=200](n3){$b$}
\drawloop[ELdist=1.5,loopangle=300](n6){$b$}
\end{picture}
\end{center}
\caption{Автомат $\mathrsfs{M}_n$ для $n=7$ и автомат порожденный действием
букв $b$ и $c=ab$} \label{fig:matr}
\end{figure}

\begin{theorem}
\label{th:matr} Если $n \geq 5$ нечетно, то тогда автомат $\mathrsfs{M}_n$ 
синхронизируем и его порог синхронизации равен $\frac{n^2 -3n + 4}{2}$.
\end{theorem}

\begin{proof}
Пусть $w$ -- кратчайшее синхронизирующее слово автомата $\mathrsfs{M}_n$. Заметим,
что действие $aa$ совпадает с действием $a$. Поэтому, $aa$ не может быть фактором
$w$. Иначе, заменив данный фактор на $a$ мы получим синхронизирующее слово меньшей
длины. Таким образом, после всякого вхождения буквы $a$, быть может за исключением
последнего, следует вхождение буквы $b$. Если мы положим $c = ab$, то $w$ или
$wb$ (если $w$ оканчивается на $a$) может быть представлено как слово $u$ над
алфавитом $\{b,c\}$. Действия букв $b$ и $c$ определяют новый автомат на множестве
состояний автомата $\mathrsfs{M}_n$ (такой автомат изображен слева на рис.~\ref{fig:matr}
справа. Нетрудно видеть, что в обоих случаях слово $u$ синхронизирует построенный автомат. 
После применения первой буквы $u$ необходимо синхронизировать подавтомат на множестве 
состояний $S =\{1\} \cup \{2k \mid 1 \leq k \leq \frac{n - 1}{2}\}$, который изоморфен
$\mathrsfs{C}_{\frac{n + 1}{2}}$.

Предположим $u = u'c$ для некоторого слова $u'$ над алфавитом $\{b,c\}$. Поскольку действие 
$c$ на всяком подмножестве $S$ не может уменьшить его мощность,  то мы заключаем, что $u'$ также
синхронизирующее слово автомата, порожденного $a$ и $c$. Но $c$ является последней буквой $u$
лишь в случае, когда $w = w'a$ и $w'$ было представлено как $u'$. Поэтому, $w'$ также синхронизирующее
слово $\mathrsfs{M}_n$, что невозможно.
%ADD
Таким образом, $w$ было представлено как $u$, а не $wb$.

Если $u = xu'$ для некоторой буквы $x$, то по предложению~\ref{th:cerny} мы заключаем,
что $u'$ содержит не менее $(\frac{n + 1}{2})^2 - 3(\frac{n + 1}{2}) + 2 =
\frac{n^2 - 4n + 3}{4}$ вхождений $c$ и не менее $\frac{n - 1}{2}$
вхождений $b$. Поскольку всякое вхождение $c$ в $u'$ соответствует вхождению
фактора $ab$ в $w$, мы заключаем, что длина $w$ не меньше 
$1 + 2\frac{n^2 - 4n + 3}{4} + \frac{n - 1}{2} = \frac{n^2 - 3n + 4}{2}$.

Нетрудно проверить, что слово $b(b(ab)^{\frac{n - 1}{2}})^{\frac{n - 3}{2}}b$ является
синхронизирующим для автомата $\mathrsfs{M}_n$, а значит полученная оценка точна.
\end{proof}

Нетрудно видеть, что $\exp_0(\mathrsfs{M}_n)=n-1$ и 
$\exp_1(\mathrsfs{M}_n)$ линейны относительно $n$. Поэтому, как 0-экспонента, так и 
1-экспонента недостаточны для получения хорошей оценки на порог синхронизации автомата
$\mathrsfs{M}_n$. Именно поэтому, точная нижняя оценка на порог синхронизации 
$\rt(\mathrsfs{M}_n)$ была получена сведением к автомату с большой 1-экспонентой
(а именно, к $\mathrsfs{C}_{\frac{n + 1}{2}}$). Чтобы устранить необходимость таких
сведений, мы сейчас введем понятие, которое позволит легко получить хорошую оценку для
$\mathrsfs{M}_n$.


Заметим, что по сути, доказательство теоремы~\ref{th:matr} сводится к оценке
числа вхождений фактора $ab$ в синхронизирующее слово. На самом деле, грубую оценку
можно получить довольно просто. Пусть $w$ -- это синхронизирующее слово, переводящее автомат
$\mathrsfs{M}_n$ в состояние 2 и $k=|w|_{ab}$. Рассмотрим цикл, проходящий через состояние 2
в точности один раз. Все такие пути задаются языком $L=b^*(a^+b^+)^{\frac{n - 1}{2}}ba^*b$. 
Таким образом, $w$ может быть разделено на несколько блоков, каждый из которых принадлежит языку $L$. 
Поскольку каждый блок содержит 
$\frac{n - 1}{2}$ или $\frac{n+1}{2}$ вхождения фактора $ab$, можно заключить, что
$k$ представимо в виде неотрицательной линейной комбинации $\frac{n-1}{2}$ и $\frac{n+1}{2}$. 
Заметим, что $(ab)^tw$, где $t \in \mathbb{N}$, также является синхронизирующим словом, переводящим
автомат $\mathrsfs{M}_n$ в состояние 2. Поскольку $ab$ встречается $k + t$ раза как фактор в $(ab)^tw$, 
то $k + t$ также представимо в виде неотрицательной линейной комбинации $\frac{n-1}{2}$ и
$\frac{n+1}{2}$. Применяя лемму~\ref{sylvester} можно заключить, что $k \geq
\frac{n^2 - 4n + 3}{4}$. Таким образом, длина слова $w$ не менее $\frac{n^2 - 4n +
3}{2}$.

Рассуждения, приведенные выше, приводят нас к следующему обобщению понятия экспоненты.
Пусть $\mathrsfs{A} =
\langle Q, \Sigma \rangle$ детерминированный конечный автомат со множеством состояний 
$Q=\{1,2,\dots,n\}$ и пусть $k$ некоторое неотрицательное число. Будем говорить, что
автомат $\mathrsfs{A}$ \emph{$k$-примитивный}, если найдутся слова $u_1,u_2,\dots,u_n$ такие, что $1\cdot
u_1=2\cdot u_2=\dots=n\cdot u_n$ и для всякого слова $v$, длина которого не превосходит $k$
справедлива $|u_1|_v = |u_2|_v = \ldots = |u_n|_v$. Заметим, что последнее условие
влечет, что слова $u_1,u_2,\dots,u_n$ имеют одну и ту же длину. Минимальная возможная
длина слов $u_1,u_2,\dots,u_n$ для $k$-примитивного автомата $\mathrsfs{A}$ называется
\emph{$k$-экспонентой} автомата $\mathrsfs{A}$ и обозначается $\exp_k(\mathrsfs{A})$.
Заметим, что грубая оценка, полученная в предыдущем абзаце показывает, что
$\exp_2(\mathrsfs{M}_n)$ близка к $\rt(\mathrsfs{M}_n)$.

Рассмотрим теперь произвольный синхронизируемый автомат $\mathrsfs{A}$. Ясно, что
$\mathrsfs{A}$ является $k$-примитивный для всякого $k$  и $\rt(\mathrsfs{A}) \geq
\exp_k(\mathrsfs{A})$. Таким образом, мы получаем следующую неубывающую последовательность:
\begin{equation}
\label{sequence}
\exp_0(\mathrsfs{A}) \leq \exp_1(\mathrsfs{A}) \leq \dots \leq
\exp_k(\mathrsfs{A}) \leq \exp_{k + 1}(\mathrsfs{A}) \leq \dotsc.
\end{equation}
Заметим, что на каждом шаге слова $u_1,u_2,\dots,u_n$ становятся все более похожими
друг на друга. Значит, в некоторый момент эти слова станут равны синхронизирующему слову
и последовательность стабилизируется при $\rt(\mathrsfs{A})$.
Таким образом, мы надеемся, что изучение этой последовательности поможет лучше понять гипотезу
Черни и трудности, возникающие при ее решении.

\newpage
%-----------------------------------Синхронизация автоматов ограниченного ранга------------------------------------------------------------------------
\section{Синхронизация автоматов ограниченного ранга}
\label{ch:rank}
В этой главе мы сводим задачу синхронизации автомата на $n$ состояниях и буквами ранга $r < n$ к задаче синхронизации 
автомата на $r$ состояниях с ограничениями, задаваемыми регулярным языком. Используя данную технику мы строим серии 
синхронизируемых автоматов на $n$ состояниях и буквами ранга $r < n$ и чей порог синхронизации не менее $r^2 -r - 1$. Более того, если $r >
\frac{n}{2}$, то тогда приведенный автомат сильно связен.

\subsection{Введение}

%\emph{Rank} of a letter $\ell$ of automaton $\A$ with set of states $Q$ has  $\rk(\ell)$ if cardinality of image of the set $Q$ under
%the action of the letter $\ell$.
In the present paper we approach the following question: how does the reset threshold of an automaton $\A$ depend on the ranks of letters
in $\A$? More formally, consider a synchronizing $n$-state automaton $\A$ with $k$ letters and let $r_1, r_2, \ldots, r_k$ be their ranks.
What is the upper bound on the reset threshold of $\A$ in terms of $n$ and $r_1, r_2, \ldots, r_k$? In full generality, this question
appears to be very hard. In this paper we focus on examples with ``large'' reset threshold and bounded rank. There have already been some
related results in the literature. Synchronizing automata with a letter of deficiency 2 were considered in~\cite{AVZ} while in~\cite{AGV10} a
series of slowly synchronizing automata in which all letters deficiency 2 was reported.

We say that an automaton $\A$ is \emph{of bounded rank} $r$ if every letter of $\A$ has rank at most $r$. We present a uniform approach to
deal with such automata. We illustrate this approach by constructing a series of automata of bounded rank $r$ with reset threshold at least
$r^2 -r - 1$.

\subsection{Предварительные сведения}

Пусть $\A = (Q, \Sigma)$ полный детерминированный автомат. Здесь $\Sigma$ is an \emph{input alphabet} and $Q$ is a \emph{set of states}.
For an arbitrary state $q \in Q$ and a letter $a_{\ell} \in \Sigma$ we denote by $q \cdot a_\ell$ the image of the state $q$ under the action 
of the letter $a_\ell$. Let $S \cdot a_\ell = \bigcup_{q \in S} \; q \cdot a_\ell$ for any $S \subseteq Q$.
The \emph{rank} of a letter $a_\ell$ denoted by $\rk(a_\ell)$ is the cardinality of the set $Q \cdot a_\ell$. The \emph{defect} of a letter $a_\ell$ 
is equal to $|Q| - \rk(a_\ell)$, where $|Q|$ is the cardinality of $Q$.

Let us fix some orderings of $Q = \{q_1, q_2, \ldots q_n\}$ and
$\Sigma = \{a_1, \ldots, a_k\}$. We associate with an arbitrary letter $a_\ell$ a square $(0,1)$-matrix $M(a_\ell)$ of order $n$ by
the following rule: $M(a_\ell)[i,j] = 1$ if $q_i\cdot a_{\ell} = q_j$, otherwise $M(a_\ell)[i,j] = 0$. We call the set $\langle M(a_1),
\ldots, M(a_{k})\rangle$ the \emph{matrix representation} of the automaton $\A$ and write $\A = \langle M(a_1), \ldots, M(a_{k})\rangle$.
We can uniquely extend the domain of mapping the $M(\cdot )$ from $\Sigma$ to $\Sigma^{*}$ in accordance with the equation $M(uv) =
M(u)M(v)$, where $u,v \in \Sigma^*$. It is not hard to see the following important property of the matrix representation: for every word
$w$ we have $M(w)[i,j] = 1$ if $q_i \cdot w = q_j$, otherwise $M(w)[i,j] = 0$. This immediately implies that a word $w$ is a reset word of
$\A$ if and only if $M(w)$ has a column of 1's. 

We will denote the rank of a matrix $M$ by $\rk(M)$. Note that the rank of a letter $a_\ell$ 
and the rank of the corresponding matrix $M(a_\ell)$ are equal,
i.e. $\rk(a_\ell) = \rk(M(a_\ell))$. Throughout the paper we also make use of the following notation. Let $\mathrsfs{M}$ be a
set of square matrices. Then define
$\mathrsfs{M}^{k} = \{ \; M_1 \cdot M_2 \cdot \ldots \cdot M_k \; | \; M_i \in \mathrsfs{M} \text{ for } 1 \leq i \leq k \}$ 
and $\mathrsfs{M}^* = \bigcup_{k = 1}^{\infty} \mathrsfs{M}^k$.

Let us introduce the matrix representation of the \v{C}ern\'{y} automaton $\mathrsfs{C}_n = \langle A_n, B_n \rangle$ of order $n$.
We denote the $i$-th row of the matrix $A_n$ by $A_n[i,.]$. Let
$e_i$ denote the row vector whose only non-zero entry is equal to 1 and is located in position $i$.
$$ A_n[i,.] =
\begin{cases}
e_2, &\text{if } i = 1\\
e_i, &\text{if } i \neq 1\\
\end{cases},\quad
B_n[i,.] =
\begin{cases}
e_{i+1}, &\text{if } i \neq n\\
e_1, &\text{if } i = n\\
\end{cases}.
$$
The matrix $A_n$ corresponds to the action of the letter $a$, 
the matrix $B_n$ corresponds to the action of the letter $b$. Later on we will need the following
statement concerning reset words of $\mathrsfs{C}_n$ (Proposition 3 in~\cite{Gu11}).

\begin{proposition}
\label{th:cerny} Every reset word of the automaton $\mathrsfs{C}_n$ contains at least $n^2 - 3n + 2$ occurrences of the letter $b$ and at
least $n - 1$ occurrences of the letter $a$.
\end{proposition}

\subsection{Основные результаты}
Для удобства представления результатов в данной главе мы будем рассматривать только автоматы с 
двумя входными буквами. Все определения и предложения могут быть легко продолжены на общий случай.
Рассмотрим  $n$-автомат $\A$ задаваемый парой матриц $A$ и $B$. Будем говорить, что множество пар матриц
$\sigma = \langle(X,Y), (\G,\D)\rangle$ является \emph{разложением} автомата $\A$, если:
\begin{enumerate}[(i)]
\item $X, \G$ суть $(0,1)$-матрицы размера $n$ на $r$
\item $Y, \D$ суть $(0,1)$-матрицы размера $r$ на $n$
\item $A = XY$, $B = \G\D$
\item во всякой строке $X,Y,\G,\D$ содержится лишь одна 1.
\end{enumerate}
Будем называть разложение \emph{насыщенным}, если всякий столбец $X$ и $\G$ содержит не менее одной 1.


%It easily follows from the definition that $r \geq max\{\rk(A),$ $\rk(B)\}$. For any such $r$ we can easily construct some decomposition.
Для всякого разложения $r \geq max\{\rk(A), \; \rk(B)\}$, что легко следует из определения.
Более того, для всякого такого $r$ существует некоторое разложение.
Например, возьмем в качестве $Y$ матрицу, составленную из различных строк матрицы $A$
в некотором порядке (допустим, лексикографическом). Число строк матрицы $Y$ будет равно $\rk(A)$.
Если $r > \rk(A)$, то для получения нужного размера повторим последнюю строку в $Y$ нужное число
раз. Пусть $j$ -- это номер $i$-й строки матрицы $A$ в лексикографическом порядке.
Тогда $i$-я строка $X$ равна $e_j$. Легко проверить, что определив матрицы $\G$ и $\D$ аналогичным образом,
мы получаем разложение автомата $\A$. Более того, если $r = \rk(A) = \rk(B)$, то данное разложение
является насыщенным. Заметим, что даже в случае $r = \rk(A) = \rk(B)$ может существовать несколько различных
разложений.

Пусть $\sigma = \langle(X,Y), (\G,\D)\rangle$ -- это некоторое разложение автомата $\A$, где $X$ имеет 
размер $n$ на $r$. Сейчас мы введем понятие \emph{приведенного автомата} $\AD$, которое является ключевым 
в данной главе. Множество состояний автомата $\AD$ равно $\{1,\ldots,
r\}$. Действие входного алфавита $\Sigma' = \{ y\g, yx, \dl x, \dl\g \}$ (для удобства, буквы мы выражаем 
двумя символами) задается соответствующими $(0,1)$-матрицами $\mathcal{M} =\{ Y\G , YX, \D X, \D\G \}$ размера $r$ на $r$. 
Заметим, что всякая строка матриц $X, Y, \G, \D$ содержит ровно одно вхождение 1, более того, их произведения 
обладают тем же свойством. Таким образом, автомат $\AD$ детерминированный и полный.

\begin{example}
\label{ex} Пусть $\mathrsfs{D}$ -- это автомат изображенный на рис.~\ref{fig:d5} слева ( этот автомат уже встречался в 
главе~\ref{first part} как $\mathrsfs{D}''_5$). Определим два разложение автомата $\mathrsfs{D}$ следующим образом:
$$
\sigma_1:\;\;
A =
\left(
\begin{smallmatrix}
1&0&0&0\\
0&1&0&0\\
0&0&1&0\\
0&0&0&1\\
1&0&0&0
\end{smallmatrix}
\right)
\left(
\begin{smallmatrix}
0&1&0&0&0\\
0&0&1&0&0\\
0&0&0&1&0\\
0&0&0&0&1
\end{smallmatrix}
\right),\;
B =
\left(
\begin{smallmatrix}
1&0&0&0\\
1&0&0&0\\
0&1&0&0\\
0&0&1&0\\
0&0&0&1
\end{smallmatrix}
\right)
\left(
\begin{smallmatrix}
0&0&1&0&0\\
0&0&0&1&0\\
0&0&0&0&1\\
1&0&0&0&0
\end{smallmatrix}
\right);
$$


$$
\sigma_2:\;\;
A =
\left(
\begin{smallmatrix}
1&0&0&0\\
0&1&0&0\\
0&0&1&0\\
0&0&0&1\\
1&0&0&0
\end{smallmatrix}
\right)
\left(
\begin{smallmatrix}
0&1&0&0&0\\
0&0&1&0&0\\
0&0&0&1&0\\
0&0&0&0&1
\end{smallmatrix}
\right),\;
B =
\left(
\begin{smallmatrix}
0&1&0&0\\
0&1&0&0\\
0&0&1&0\\
0&0&0&1\\
1&0&0&0
\end{smallmatrix}
\right)
\left(
\begin{smallmatrix}
1&0&0&0&0\\
0&0&1&0&0\\
0&0&0&1&0\\
0&0&0&0&1
\end{smallmatrix}
\right).
$$
Приведенный автомат $\mathrsfs{D}_{\sigma_1}$ изображен в середине рис.~\ref{fig:d5}. Буква $y \g$ не изображена, поскольку она действует
как тождественное преобразование. Действие буквы $\dl \g$ совпадает с действием $yx$. Приведенный автомат $\mathrsfs{D}_{\sigma_2}$ изображен
на рис.~\ref{fig:d5} справа. Поскольку действия букв $yx, y\g, \dl \g$ совпадают, то на рисунке изображено действие только $yx$.
\begin{figure}[ht]
 \begin{center}
  \unitlength=2.8pt
    \begin{picture}(18,26)(14,-24)
    \gasset{Nw=6,Nh=6,Nmr=3}
    \node(n0)(0,0){2}
    \node(n1)(-13,-9){1}
    \node(n2)(13,-9){3}
    \node(n3)(-8,-23){5}
    \node(n4)(8,-23){4}
    \drawedge(n1,n0){$a$} \drawedge(n2,n4){$a,b$}
    \drawedge(n0,n2){$a,b$} \drawedge[ELpos=35](n3,n0){$a$}
    \drawedge(n3,n1){$b$} \drawedge[ELpos=25](n1,n2){$b$}
    \drawedge(n4,n3){$a,b$}
    \end{picture}
 \begin{picture}(18,26)(-45,-2)
    \gasset{Nw=6,Nh=6,Nmr=3, loopdiam=5}
    \node(A1)(0,18){$1$}
    \node(A2)(18,18){$2$}
    \node(A3)(18,0){$3$}
    \node(A4)(0,0){$4$}
    %sigma 2 second on a picture
    \drawloop[loopangle=135](A1){$\dl x$}
    \drawedge(A1,A2){$yx$}
%    \drawedge(A2,A3){}
%    \drawedge(A3,A4){}
%    \drawedge(A4,A1){}
    \drawedge(A2,A3){$\dl x, yx$}
    \drawedge(A3,A4){$\dl x, yx$}
    \drawedge(A4,A1){$\dl x, yx$}
    \end{picture}
 \begin{picture}(18,26)(15,-2)
    \gasset{Nw=6,Nh=6,Nmr=3}
    \node(A1)(0,18){$1$}
    \node(A2)(18,18){$2$}
    \node(A3)(18,0){$3$}
    \node(A4)(0,0){$4$}
    %sigma 1 first on a picture
    \drawedge(A1,A2){$yx$}
    \drawedge(A2,A3){$yx$}
    \drawedge(A3,A4){$yx$}
    \drawedge[curvedepth=2.5, ELside=r, ELpos=35, ELdist=0.3](A1,A3){$\dl x$}
    \drawedge[ELpos=25, ELside=r](A2,A4){$\dl x$}
    \drawedge[curvedepth=2.5](A3,A1){}
    \drawedge(A4,A1){$\dl x, yx$}
    \end{picture}
 \end{center}
 \caption{Автоматы $\mathrsfs{D}$, $\mathrsfs{D}_{\sigma_1}$ и $\mathrsfs{D}_{\sigma_2}$}
 \label{fig:d5}
\end{figure}

Данный пример показывает, что приведенные автоматы могут существенно различаться.
\end{example}

\emph{Матрицей перестановки} называется квадратная $(0,1)$-матрица, которая содержит ровно один ненулевой элемент в каждой строке и каждом столбце.
Нетрудно видеть, что всякая матрица перестановки $P$ удовлетворяет соотношению $PP^T = I$, где $P^T$ -- транспонированная матрица, и
$I$ -- единичная матрица.
Следующее простое предложение позволяет получить несколько разложений по данному. Доказательство его тривиально.

\begin{proposition}
Пусть $\langle(X,Y),$ $(\G,\D)\rangle$ есть некоторое разложение автомата $\A$. Тогда для всякой пары матриц перестановок $P$ и $Q$
подходящих размеров, $\langle(XP,P^{T}Y), (\G Q,Q^{T}\D)\rangle$ также является разложением автомата $\A$.
\end{proposition}
Следующее предложение проясняет причину нашего интереса к автомату $\AD$. Оказывается, что приведенный автомат сохраняет важные 
свойства исходного автомата $\A$.

\begin{proposition}
\label{th:1} Пусть синхронизируемый автомат $\A$ задается парой матриц $A$ и $B$. Тогда для всякого разложения $\sigma =
\langle(X,Y), (\G,\D)\rangle$ приведенный автомат $\AD$ синхронизируем и $\rt(\AD) \leq \rt(\A) + 1$. Более того, если разложение
$\sigma$ насыщенно, то $\rt(\AD) \leq \rt(\A)$.
\end{proposition}

\begin{proof}
Поскольку автомат $\A$ синхронизируем, то существует матрица $W \in \{A, B\}^{\rt(\A)}$, содержащая столбец из единиц. Мы можем представить
$W$ как произведение матриц $X,Y,\G,\D$ в соответствии с разложением $\sigma$. Таким образом, $W = SW'T$, где $S \in \{X,\G\}$, $T \in \{Y,\D\}$
и $W' \in \mathcal{M}^{\rt(\A) - 1}$. Заметим, что матрица $YWX$ имеет размер $r \times r$ и содержит столбец из 1. Более того, матрица $YWX$ может быть 
представлена как произведение матриц из $\mathcal{M}$ длины $\rt(\A) + 1$. Следовательно, автомат $\AD$ синхронизируем и его порог синхронизации
не превосходит $\rt(\A) + 1$. Если же разложение насыщенно, то тогда уже матрица $W'T$ содержит единичный столбец. Поэтому $W'TX \in
\mathcal{M}^{\rt(\A)}$ может играть роль синхронизирующего слова. Таким образом, неравенство $\rt(\AD) \leq \rt(\A)$ выполнено.
\end{proof}


\begin{proposition}
Пусть сильно связный автомат $\A$ задан парой матриц $A$ и $B$. Тогда для всякого насыщенного разложения $\sigma =
\langle(X,Y),(\G,\D)\rangle$ приведенный автомат $\AD$ также сильно связен.
\end{proposition}

\begin{proof}
Рассмотрим произвольные $i,j \in \overline{1,r}$ и построим маршрут из $i$ в $j$ в автомате $\AD$. Поскольку всякая строка $Y$
содержит единицу, то найдется такое $i'$, что $Y[i,i'] = 1$. Поскольку разложение $\sigma$ насыщенно, то существует $j'$ со свойством $X[j',j]
= 1$. Поскольку автомат $\A$ сильно связен, то найдется матрица $W \in \{A,B\}^*$ такая, что $W[i',j'] = 1$. Ясно, что $YWX[i,j] = 1$.
Заметим, что $YWX \in \mathcal{M}^*$. Значит автомат $\AD$ сильно связен.
\end{proof}

Пока доказанные предложения позволяют получать лишь нижние оценки на $\rt(\A)$ используя $\rt(\AD)$. Для того, чтобы получать также и верхние
оценки мы введем новое понятие. Пусть $\langle \A , \mathrsfs{F} \rangle$ некоторая пара автоматов, где $\mathrsfs{F}$ обладает входным
и выходными состояниями. Будем говорить, что автомат $\A$ \emph{синхронизируем с ограничением} $\mathrsfs{F}$, если найдется слово $w$,
являющееся синхронизирующим для автомата $\A$ и принимаемое автоматом $\mathrsfs{F}$. Будем называть наименьшую возможную длину такого слова
$w$ \emph{порогом синхронизации с ограничением} $\mathrsfs{F}$ и обозначать $\rtc(\A, \mathrsfs{F})$. Обычно мы будем опускать явное указание автомата
$\mathrsfs{F}$, если он ясен из контекста.

Отметим следующий несложный факт. Порог синхронизации с ограничением может расти экспоненциально от числа состояний в автомате $\A$ 
даже если автомат ограничений $\mathrsfs{F}$ остается неизменным. Такой пример может быть получен с помощью небольшой модификации 
трех буквенного автомата $\mathrsfs{A}^3_{pfa}(n)$ из работы~\cite{Mart}. 
Рассмотрим автомат $\A(k) = (Q_k, \Sigma)$. Входной алфавит $\Sigma$ равен $\{a,b,c\}$.
%We are to introduce automaton $\A(k)$ over alphabet $\{a,b,c\}$. 
Пусть $p_i$ -- это $i$-е простое число($p_1 = 2$). Тогда $Q_k = \{(i,j) \; | \; 1 \leq i \leq k, \; 0 \leq j \leq p_i - 1\}$. 
Действия букв определяются следующим образом:
$$(i,j) \cdot a = 
\begin{cases}
(i,j+1), & j < p_i - 1,\\
(i,0), & j = p_i - 1;
\end{cases}
\quad
(i,j) \cdot b = (i,0);
$$

$$(i,j) \cdot c = 
\begin{cases}
(i,j), & j < p_i - 1,\\
(1,1), & j = p_i - 1.
\end{cases}
$$
Пусть $\mathrsfs{F}$  -- это минимальный автомат языка $ba^*c$. Нетрудно понять, что порог синхронизации $\A(k)$ с ограничением 
$\mathrsfs{F}$ растет экспоненциально с ростом числа состояний в автомате $\A(k)$.

Пусть $ba^\ell c$ -- это кратчайшее синхронизирующее слово с ограничением.
Заметим, что $Q_k \cdot b = \{(i,0) \; | \; 1 \leq i \leq k\}$. Действие буквы $a$ не изменяет первую компоненту любого состояния.
Тогда, $Q_k \cdot ba^\ell = \{(i, x_i) \; | \; 1 \leq i \leq k \}$, где $x_i$ определяется однозначно. Поскольку $|Q_k \cdot ba^\ell c| = 1$,
то справедливо $x_i = p_i - 1$. Легко понять, что $(i,0) \cdot ba^\ell = (i, p_i - 1)$ тогда и только тогда, когда $\ell \equiv p_i - 1 \; (\text{mod } p_i)$.
Поэтому, $\ell$ -- это минимальное неотрицательное решение следующей системы сравнений:
$\ell \equiv p_i - 1 \; (\text{mod } p_i)$ для всех $1 \leq i \leq k$. По китайской теореме об остатках мы получаем, что 
$\ell = p_1p_2\ldots p_k - 1$. Поскольку $\A(k)$ содержит лишь $p_1 + p_2 + \ldots p_k$ состояний, то мы получаем
экспоненциальный рост. Более точная оценка порядка роста приведена в~\cite{Mart}.

%Letter $c$ in the modified new automaton will act as identity mapping on previously undefined
%states. All defined actions of letters will remain the same. If we take the minimal automaton of the language $ba^*c$ as $\mathrsfs{F}$,
%then constrained reset words coincide with carefully synchronizing words of the original automaton.

Пусть $\R$ -- это автомат изображенный на рис.~\ref{fig:r}. Его множество состояний равно $\{S, YX, Y\G , \D X,$ $\D \G, Z\}$ . Нулевое состояние 
$Z$ не представлено на рисунке для сохранения ясности. Для всех букв $\ell \in \Sigma'$ справедливо $Z \cdot \ell = Z$. Если действие буквы
$\ell$ на состояние $q$ не отображено на рисунке, значит $q \cdot \ell = Z$. Состояние $S$ является начальным состоянием автомата
$\R$, а состояния $YX, Y\G , \D X, \D \G$ являются заключительными. Впредь, автомат $\R$ будет единственным автоматом ограничений, который мы будем
рассматривать.

\begin{figure}[ht]
\begin{center}
 \unitlength=2.8pt
   \begin{picture}(18,26)(-7,-2)
   \gasset{Nw=7,Nh=6,Nmr=3,loopdiam=5}
   \node[linewidth=0.3](A1)(0,18){$YX$}
   \node[linewidth=0.3](A2)(18,18){$Y\G$}
   \node[linewidth=0.3](A3)(18,0){$\D\G$}
   \node[linewidth=0.3](A4)(0,0){$\D X$}
   \node[Nmarks=i](AS)(-28,9){$S$}
   \drawedge(AS,A1){$yx$}
   \drawedge[ELpos=40,ELside=l,ELdist=0.5,curvedepth=-1.5](AS,A2){$y\g$}
   \drawedge[ELpos=40,ELside=r,ELdist=0,curvedepth=1.5](AS,A3){$\dl \g$}
   \drawedge[ELside=r](AS,A4){$\dl x$}
   \drawloop[loopangle=135](A1){$yx$}
   %\drawloop[loopangle=45](A2){$b$}
   \drawloop[loopangle=-45](A3){$\dl \g$}
   %\drawloop[loopangle=-135](A4){$b$}
   \drawedge[curvedepth=2,ELpos=45](A4,A2){$y \g$}
   \drawedge[curvedepth=2,ELpos=45](A2,A4){$\dl x$}
   \drawedge(A1,A2){$y\g$}
   \drawedge(A2,A3){$\dl \g$}
   \drawedge(A3,A4){$\dl x$}
   \drawedge(A4,A1){$yx$}
   \end{picture}
\end{center}
\caption{Автомат $\R$}
\label{fig:r}
\end{figure}

\begin{proposition}
\label{th:2} Пусть автомат $\A$ задается парой матриц $A$ и $B$. Тогда для всякого разложения $\sigma = \langle(X,Y),
(\G,\D)\rangle$ автомат $\AD$ синхронизируем с ограничением $\R$ тогда и только тогда, когда автомат $\A$ синхронизируем. 
Более того, $\rtc(\AD) - 1 \leq \rt(\A) \leq \rtc(\A) + 1$. Если разложение $\sigma$ насыщено, тогда $\rtc(\AD) \leq \rt(\A)$.
\end{proposition}

\begin{proof}
Если автомат $\A$ синхронизируем, то синхронизируемость автомата $\AD$ с ограничением $\R$ и нижняя оценка на порог синхронизации
автомата $\A$ немедленно следуют из доказательства предложения~\ref{th:1}. Представления построенных матриц $YWX$ и $W'TX$ в виде произведения 
матриц из $\mathcal{M}$ удовлетворяют ограничению $\R$.

Пусть теперь матрица $W = SW'P$ -- это матрица, соответствующая некоторому синхронизирующему слову $w$ с ограничением автомата $\AD$, где  $S \in \{Y, \D\}$, а $P \in \{
X, \G\}$. Заметим, что $W$ может быть представлена как произведение матриц из $\mathcal{M}$, которое автомат $\R$ принимает. Тогда нетрудно видеть, что
матрица $S'WP'$ содержит столбец из единиц и может быть представлена в виде произведения матриц $A$ и $B$, где $S',P'$ определены
следующим образом:
$$
S' =
\begin{cases}
X,\;& \mbox{if } S = Y,\\
\G,\;& \mbox{if } S = \D;
\end{cases}\;\;\;
P' =
\begin{cases}
Y,\;& \mbox{if } P = X,\\
\D,\;& \mbox{if } P = \G.
\end{cases}
$$
Поэтому, $S'WP'$ может играть роль синхронизирующего слова для автомата $\A$ и справедливо $\rt(\A) \leq \rtc(\A) + 1$.
\end{proof}

Предложение~\ref{th:2} немедленно влечет, что существует функция $f(r)$ такая, что $\rt(\A) \leq f(r)$ для всякого двух буквенного автомата $\A$
ограниченного ранга $r$. Заметим, что автомата $\A$ может иметь сколь угодно много состояний.
Предложение~\ref{th:2} может также быть использовано для того, чтобы дать точные оценки на порог синхронизации автомата ограниченного ранга. 
Определим автомат $\mathrsfs{E}_n$
следующим образом:
$$i\cdot a=\begin{cases}
2, &\text{if } i = 1,\\
3, &\text{if } i = 2,\\
i, &\text{if } i>2;
\end{cases}\quad
i \cdot b =\begin{cases}
3, &\text{if } i = 1,\\
i+1, &\text{if } 1<i<n,\\
1, &\text{if } i=n.
\end{cases}$$
Автомат $\mathrsfs{E}_5$ изображен на рис.~\ref{fig:e}.
\begin{figure}[hb]
\begin{center}
\unitlength .45mm
\begin{picture}(72,66)(25,-76)
\gasset{Nw=16,Nh=16,Nmr=8,loopdiam=10} \node(n0)(36.0,-16.0){2}
\node(n1)(4.0,-40.0){$1$} \node(n2)(68.0,-40.0){3} \node(n3)(16.0,-72.0){$5$}
\node(n4)(56.0,-72.0){4} \drawedge[ELdist=2.0](n1,n0){$a$}
\drawedge[ELdist=1.5](n2,n4){$b$} \drawedge[ELdist=1.7](n0,n2){$a,b$}
\drawedge[ELdist=1.7](n3,n1){$b$} \drawedge[ELdist=1.7](n1,n2){$b$}
\drawedge[ELdist=1.7](n4,n3){$b$}
\drawloop[ELdist=1.5,loopangle=30](n2){$a$}
\drawloop[ELdist=2.4,loopangle=-30](n4){$a$}
\drawloop[ELdist=1.5,loopangle=210](n3){$a$}
%\put(31,-73){$\dots$}
\end{picture}
\begin{picture}(72,66)(-25,-76)
\gasset{Nw=16,Nh=16,Nmr=8,loopdiam=10}
\node(n1)(10.0,-27.0){1} \node(n2)(60.0,-27.0){2} \node(n3)(10.0,-72.0){4}
\node(n4)(60.0,-72.0){3} \drawedge[ELdist=1.5](n2,n4){$\dl x$}
\drawedge[ELdist=1.7](n3,n1){$\dl x$} \drawedge[ELdist=1.7](n4,n3){$\dl x$}
\drawedge[ELdist=2.0](n1,n2){$\dl x, yx$} \drawloop[ELdist=1.5,loopangle=30](n2){$yx$}
\drawloop[ELdist=2.4,loopangle=-30](n4){$yx$}
\drawloop[ELdist=1.5,loopangle=210](n3){$yx$}
%\put(31,-73){$\dots$}
\end{picture}
\end{center}
\caption{Автомат $\mathrsfs{E}_5$ и его приведенный автомат} \label{fig:e}
\end{figure}

Пусть $\langle A,B\rangle$ -- это матричное представление автомата $\mathrsfs{E}_n$ (в соответствии с указанным порядком). Определим разложение
$\sigma_n$ следующим образом: матрица $Y$ получается из $A$ удалением второй строки, а матрица $\D$ получается из $B$ удалением первой строки.
Матрицы $X, \G$ однозначно определяются $Y$ и $\D$. Например, при $n = 5$ мы получаем:
$$\sigma_5: \;\;
A =
\left(
\begin{smallmatrix}
1&0&0&0\\
0&1&0&0\\
0&1&0&0\\
0&0&1&0\\
0&0&0&1\\
\end{smallmatrix}
\right)
\left(
\begin{smallmatrix}
0&1&0&0&0\\
0&0&1&0&0\\
0&0&0&1&0\\
0&0&0&0&1
\end{smallmatrix}
\right),\;
B =
\left(
\begin{smallmatrix}
1&0&0&0\\
1&0&0&0\\
0&1&0&0\\
0&0&1&0\\
0&0&0&1
\end{smallmatrix}
\right)
\left(
\begin{smallmatrix}
0&0&1&0&0\\
0&0&0&1&0\\
0&0&0&0&1\\
1&0&0&0&0
\end{smallmatrix}
\right).
$$
Нетрудно видеть, что $YX = A_{n - 1}$, $Y\G = I_{n - 1}$, $\D X = \D\G = B_{n - 1}$, где $I_{n - 1}$ -- это единичная матрица размера
$n - 1 \times n - 1$. Приведенный автомат для автомата $\mathrsfs{E}_5$ изображен справа на рис.~\ref{fig:e}. Мы опустили действия букв
$y\g, \dl \g$ для ясности изображения. Заметим, что $\langle YX, \D\G\rangle$ -- это матричное представление автомата $\mathrsfs{C}_{n
- 1}$. Мы можем использовать этот факт и предложение~\ref{th:cerny} для того, чтобы оценить порог синхронизации с ограничением. 
Пусть $w \in \Sigma'$ -- это синхронизируемое слово с ограничением минимальной длины для $\mathrsfs{E}_{\sigma_n}$. 
По предложению~\ref{th:cerny} $w$ содержит не менее $(n - 1)^2 - 3(n - 1) + 2 = n^2 - 5n + 6$ вхождений $\dl x, \dl \g$ и не менее $n - 2$ 
вхождений буквы $yx$. Заметим, что $(yx)^2$ не является фактором слова $w$, в противном случае, заменив $(yx)^2$ на $yx$ мы бы получили
более короткое слово. Поэтому, после всякого вхождения $yx$, быть может кроме последнего, следует вхождение $\dl x$, $\dl \g$ или $y \g$. 
Поскольку $w$ принимается автоматом $\R$ мы можем заключить, что после $yx$ следует $y\g$. Таким образом, мы получаем $|w| \geq n^2 - 5n 
+ 6 + n - 2 + n - 3 = n^2 -3n + 1$. Предложение~\ref{th:2} влечет, что $n^2 -3n + 1 \leq
\rt(\mathrsfs{E}_n) \leq n^2 -3n + 2$.

Напомним, что другой способ определить порог синхронизации автомата $\mathrsfs{E}_n$ был представлен в главе~\ref{ch:1}.

Теперь мы используем серию $\mathrsfs{E}_n$ в качестве основы, для двух буквенного автомата ограниченного ранга $r$ с <<большим>> порогом 
синхронизации. Автомат $\mathrsfs{E}_n$ был выбран по следующей причине. Вычислительные эксперименты, описанные в главе~\ref{ch1} показывают,
что для небольшого числа состояний $n$, порог синхронизации автомата $\mathrsfs{E}_n$ равный $n^2 -3n +2$ является наибольшим среди всех 
двух буквенных автоматов ограниченного ранга $n - 1$. Таким образом, мы надеемся, что обобщения серии $\mathrsfs{E}_n$ будут иметь порог
синхронизации, близкий к оптимальному.

\begin{proposition}
Для всякого $r < n$ существует синхронизируемый двух буквенный $n$-автомат ограниченного ранга $r$ с порогом синхронизации не менее
$r^2 -r - 1$. Если $r > \frac{n}{2}$, то автомат будет сильно связен.
\end{proposition}

Зафиксируем число состояний $n$, ранг $r$ и дефект $d = n - r$. Сутью доказательства для автомата $\mathrsfs{E}_n$ было сведение к автомату
$\mathrsfs{C}_{n - 1}$. Теперь мы обратим данный прием. Будем искать такой автомат, что его приведенный равен $\mathrsfs{C}_r$. Сформулируем
более формально, рассмотрим некоторое решение $X,Y,\G,\D$ следующей системы матричных уравнений: $YX = A_{r}$, $Y\G = I_{r}$, $\D X = \D \G =
B_{r}$ со свойствами:
\begin{enumerate}[(i)]
\item $X,\G$ -- это $(0,1)$-матрицы размера $n$ на $r$
\item $Y,\D$ -- это $(0,1)$-матрицы размера $r$ на $n$
\item всякая строка $X, Y, \G, \D$ содержит лишь одну единицу
\item всякий столбец $X$ и $\G$ содержит не менее одной единицы.
\end{enumerate}
Рассуждая как в доказательстве предложения~\ref{}, можно заключить, что $\rtc(YX, Y\G, \D X, \D \G) \geq r^2 - r - 1$. 
Рассмотрим автомат $\A = \langle XY, \G\D \rangle$. В нем $n$ состояний и ранг каждой буквы ограничен $r$. 
Поскольку $\langle (X,Y), (\G, \D) \rangle$ является насыщенным разложением автомата $\A$, то по предложению~\ref{th:2} 
автомат $\A$ синхронизируем. Более того, его порог синхронизации не менее $r^2 - r - 1$. Простое решение легко получить
в следующем виде:

$$
X =
\left(
\begin{array}{c}
X' \\
e_1 \\
A_r
\end{array}
\right),\;
Y =
\left(
\begin{array}{c}
0_{r,d} \mid I_r
\end{array}
\right),\;
\G =
\left(
\begin{array}{c}
\G' \\
e_1 \\
I_r
\end{array}
\right),\;
\D =
\left(
\begin{array}{c}
0_{r-1,d + 1} \mid I_{r-1}\\ \hline
e_d
\end{array}
\right),
$$
где $X', \G'$ произвольные  $(0,1)$-матрицы размера $d-1$ на $r$ с ровно одной единицей в каждой строке.
Здесь $0_{r,d}$ обозначает матрицы из нулей размера $r$ на $d$. Таким образом, первая часть утверждения доказана.

Нам потребуется более сложное решение, чтобы получить сильно связный автомат. Если $r = n - 1$, то тогда автомат $\mathrsfs{E}_n$
удовлетворяет условиям предложения. Пусть теперь $r \neq n - 1$. Тогда искомое решение следующее:
$$
X =
\left(
\begin{array}{c}
M \\
e_1 \\
A_r
\end{array}
\right),
Y =
\left(
\begin{array}{c}
0_{r,d} \mid I_r
\end{array}
\right),
\G =
\left(
\begin{array}{c}
M \\
e_1 \\
I_r
\end{array}
\right),
\D =
\left(
\begin{array}{c}
I_{d - 1} \mid 0_{d-1,r + 1} \\ \hline
\textbf{\,\,\,} 0_{r-d,2d} \mid I_{r - d} \\ \hline
e_d
\end{array}
\right),
$$
где $M =
\left(
\begin{smallmatrix}
e_2\\
e_3\\
\ldots\\
e_d
\end{smallmatrix}\right)$ матрица размера $d - 1$ на $r$.
Доказательство того факта, что автомат $\langle XY, \G\D\rangle$ является сильно связным довольно простое, но крайне техническое. МЫ ЕГО ОПУСТИМ.

\subsection{Заключение и обсуждение}
В данной главе был предложен метод изучения взаимосвязи между порогом синхронизации автомата и рангами его букв. Мы надеемся, что он
приведет к лучшему пониманию данной взаимосвязи. Он может быть также полезен для получения новых серий автоматов, или изучения уже известных.
Хочется упомянуть несколько вопросов, касающихся данного подхода. Во-первых, нетрудно видеть из примера~\ref{ex}, что приведенный автомат
определяется неоднозначно. Существует ли некоторый <<канонический автомат>>, или наиболее <<удобный>>?
Во-вторых, различные автоматы могут иметь один и тот же автомат в качестве своего приведенного. Более формально, автомат $\A$ 
эквивалентен автомату $\mathrsfs{B}$, если $\mathrsfs{A}_{\sigma} =
\mathrsfs{B}_{\sigma'}$ для некоторых разложений $\sigma, \sigma'$. По сути, это означает, что проблема синхронизации автомата $\A$
совпадает с проблемой синхронизации автомата $\mathrsfs{B}$. Существует ли ясная характеризация таких классов эквивалентности?


\section{Непокрывающие множества и гипотеза Рестиво}
\label{non-complete}

%\begin{abstract}
%A finite set $S$ of words over the alphabet $\Sigma$ is called non-complete if $\Fact(S^*)\ne\Sigma^*$. A word $w\in\Sigma^*\setminus\Fact(S^*)$ is said to be uncompletable.  We present a series of non-complete sets $S_k$ whose minimal uncompletable words have length $5k^2 - 17k + 13$, where $k\ge 4$ is the maximal length of words in $S_k$. This is an infinite series of counterexamples to Restivo's conjecture, which states that any non-complete set possesses an uncompletable word of length at most $2k^2$.
%\end{abstract}

\subsection{Введение}
Пусть $\Sigma$ -- это конечный алфавит. Конечное множество $S$ слов над алфавитом $\Sigma$ называется \emph{покрывающим}, если $\Fact(S^{*})=\Sigma^*$, 
т.е. всякое слово над алфавитом $\Sigma$ является фактором слова из $S^{*}$. Если $S$ не является покрывающим, то $\Sigma^{*}\setminus \Fact(S^{*})$ 
не пусто и кратчайшее слово в данном множестве называется \emph{кратчайшим непокрываемым словом} (относительно
непокрывающего множества $S$). Его длину мы будем обозначать $uwl(S)$.

Проблема поиска кратчайших непокрываваемых слов и анализа их длин была предложена Рестиво в 1981.

В своей статье~\cite{Rest81} он выдвинул гипотезу о том, что непокрывающее множество $S$ всегда обладает непокрываемым словом $w$
длины не более $2k^2$, где $k$ -- это длина самого длинного слова в $S$, и $w$ имеет вид $w=uv_1uv_2\ldots uv_{k-1}u$, где $u\notin S$, $|u|=k$
и $|v_i|\le k$ для всех $i=1,2,\ldots,k-1$. Пример, дающий нижнюю оценку $k^2 + k - 1$ на длину кратчайшего непокрываемого
слова был представлен в~\cite{Prib09}. Однако, гипотеза Рестиво была опровергнута представлением контрпримера в работе~\cite{FiciPribSakar10}.
А именно, пусть $k>6$ и $R_k=\Sigma^k\setminus \{a^{k-2}bb\} \cup \Sigma ba^{k-4}\Sigma \cup \Sigma ba \cup b^{4}\cup J_{k}$,
где $J_{k}=\bigcup_{i=1}^{k-3}(ba^{i}\Sigma \cup a^{i}b)$. В работе~\cite{FiciPribSakar10} авторы вычислили, что при $7\leq k\leq 12$ 
длина кратчайшего непокрываемого слова для $R_k$ равна $3k^2 - 9k + 1$, но они не смогли показать это при любом $k$.


В данной главе мы представляем новую серию непокрывающих множеств $S_k$ с длиной кратчайшего непокрываемого слова
$5k^2 - 17k + 13$ for $k \ge 4$.

Касательно верхней оценки, только тривиальная экспонента известна. А именно, длина кратчайшего непокрываемого слова не превосходит
$2^{\|S\|-m+1}$, где $m$ -- это число слов в $S$ и через $\|S\|$ обозначена сумма длин всех элементов в $S$. 
Она получена исходя из связи между синхронизируемыми автоматами и некрывающими множествами, которая была представлена в~\cite{Prib09}. 
Однако, данная оценка скорее всего не точна. УЛУЧШИ ОЦЕНКУ, ВПИШИ АЛГОРИТМ.

An interesting related question of deciding whether a given regular language $L$ satisfies one of the properties 
$\Sigma^*=\Fact(L)$, $\Sigma^*=\Pref(L)$, $\Sigma^*=\Suff(L)$ has been recently considered by Rampersad et al.\ in \cite{RamSha09}, 
where the computational complexity of the aforementioned problems in case $L$ is represented by a deterministic or 
non-deterministic finite automaton is studied. In particular case $L=S^{*}$ for $S$ being a finite set of words the 
authors mention that the complexity of deciding whether or not $\Sigma^*=\Fact(S^{*})$ is still an open problem.

\subsection{Множество $S_k$}

Для того, чтобы зафиксировать обозначения, приведем некоторые базовые определения из
комбинаторики слов.
Через $|w|$ мы обозначаем \emph{длину} слова $w$. Длина \emph{пустого слова} $\varepsilon$ равна нулю.
Через $\Sigma^+$ мы обозначаем множество всех непустых слов над алфавитом $\Sigma$;
через $\Sigma^k$ -- множество всех слов длины $k$ над $\Sigma$ и через $\Sigma^{\le k}$ -- множество всех слов длины не более $k$ над $\Sigma$.
Слово $u\in \Sigma^+$ является \emph{фактором} $w$ (\emph{префиксом} или \emph{суффиксом} соответственно) если $w$ 
может быть представлено как $w=xuy$ ($w=uy$ или $w=xu$ соответственно)
для некоторых $x,y\in \Sigma^*$. Фактор (префикс, суффикс) $u$ слова $w$ называется \emph{собственным} если $u\ne w$.
Для слова $u=a_1a_2\cdots a_n\in \Sigma^+$ через $u[i\ldots j]$ при
$1\le i,j\le n$ мы обозначим фактор $a_ia_{i+1}\cdots a_{j}$, если $i\le j$, 
и пустое слово, если $i>j$. Более того, мы полагаем $u[0]=\varepsilon$.


Пусть $\Sigma=\{a,b\}$. Рассмотрим множество
$$S_k=\left(\Sigma^k\setminus\{ba^{k-1},b^{k-1}a\}\right)\cup\left(\Sigma^{k-1}\setminus\{a^{k-1},b^{k-1}\}\right).$$
В разделе~\ref{upper} мы покажем, что это множество является непокрывающим при $k\ge4$ и существует
непокрываемое слово длины $5k^2-17k+13$. В разделе~\ref{lower} мы покажем, что данная верхняя оценка точна.
Наши рассуждения существенно опираются на понятие \emph{запрещенной позиции} в слове. Это понятие впервые
было сформулировано в работе~\cite{Prib09}. Рассмотрим некоторое непокрывающее множество $S$
и непокрываемое им слово $w$. Будем говорить, что $0\le j\le |w|-1$ является запрещенной позицией в $w$
относительно $S$, если $w[j+1,\ldots,|w|]\notin\Pref(S^*)$, т.е. суффикс слова $w$, начинающийся в позиции
$j$ не является префиксом никакого слова в $S^*$. Если из контекста ясно о каком множестве $S$ идет речь,
мы будем опускать явное указание на $S$. Заметим, что если $S\subseteq\Sigma^{\le k}$ и позиции
$0,1,\ldots,k-1$ запрещены в некотором слове $w$, то $w$ является непокрываемым относительно $S$.
Таким образом, для доказательства того, что множество $S\subseteq\Sigma^{\le k}$ является непокрывающим
достаточно найти некоторое слово, первые $k$ позиций которого, запрещены.

\begin{lemma}\label{FP_struct} Пусть $j\ge k$ -- это запрещенная позиция в слове $w$ относительно 
$S_k$. Тогда позиция $j-k$  запрещена в $w$ относительно $S_k$ тогда и только тогда, когда 
$j-1$ запрещена или $w[j-k+1,\ldots,j-1]\in\{a^{k-1},b^{k-1}\}$.
\end{lemma}

\begin{proof} Пусть позиция $j-k$ запрещена в $w$. Тогда по определению 
$w[j-k+1,\ldots,|w|]\notin\Pref(S_k^*)$. 
Пусть теперь позиция $j-1$ не запрещена в $w$, т.е. $w[j,\ldots,|w|]=x\in\Pref(S^*_k)$. 
Если фактор $y=w[j-k+1,\ldots,j-1]$ длины $k-1$ лежит в $S_k$, то $w[j-k+1,\ldots,|w|]=yx\in\Pref(S_k^*)$,
что невозможно. Таким образом $y\in\Sigma^{k-1}\setminus S_k=\{a^{k-1},b^{k-1}\}$.

Обратно, рассуждая от противного предположим, что $j-k$ не является запрещенной позицией.
Тогда исходя из того, что длина суффикса $w[j-k+1,\ldots,|w|]$ не менее $k$, мы заключаем, что данный
суффикс может быть факторизован как $xy$, где $x\in S_k$ и $y\in\Pref(S^*_k)$. Случай $|x|=k$
противоречит тому, что позиция $j$ запрещена, поскольку мы получаем $w[j+1,\ldots,|w|]=y\in\Pref(S^*_k)$. 
Поэтому, $|x|=k-1$. Поскольку $x\in S_k$ можно заключить, что $x$ отлично как от $a^{k-1}$, так и 
$b^{k-1}$. Но тогда позиция $j-1$ не запрещена, что ведет к противоречию.

%\begin{figure}[ht]
%\begin{center}
%\label{fig_j}
%  \unitlength=1pt
% \begin{picture}(120,15)(0,5)
% \put(0,0){\line(1,0){120}}
% \put(50,-10){$w$}
% \put(20,0){\line(0,1){5}}
% \put(90,0){\line(0,1){5}}
% \put(100,0){\line(0,1){5}}
% \put(60,25){$k$}
% \put(50,8){$k-1$}
% \put(0,0){\line(0,1){5}}
% \put(120,0){\line(0,1){5}}
% %\put(20,7){\oval(40,30)[t]}
% \put(60,7){\oval(80,30)[t]}
% \put(55,7){\oval(70,20)[t]}
% %\put(140,7){\oval(40,30)[t]}
% \end{picture}
% \end{center}
%  \caption{The word $w$ does not contain $u$ as a factor.}
%\end{figure}

\end{proof}

До конца этой главы будут строго соблюдаться следующие обозначения:
$u=ba^{k-1}$ и $v=b^{k-1}a$. Также мы будем рассматривать запрещенные позиции
только во вхождениях $u$ и $v$ в слове $w$. В каждом таком вхождении для удобства мы
будем нумеровать позиции локально от $0$ до $k-1$.

\begin{example}
Рассмотрим следующее слово: 
$$w=\underbrace{'b'a'a}\limits_{\{0,1,2\}}\, a'b\,
\lefteqn{\underbrace{\phantom{'bb'a}}\limits_{\{0,2\}}}'b\overbrace{b'a a}\limits^{\{1\}}a\,
\underbrace{'bba}\limits_{\{0\}}.$$


Используя определение и лемму~\ref{FP_struct} нетрудно вычислить, что множество запрещенных 
позиций относительно $S_3$ равно $\{0,1,2,4,5,7,10\}$.
Всего слово содержит два вхождения слова $u$ и два вхождения слова $v$ в $w$ (первое вхождение
слова $v$ перекрывается со вторым вхождением слова $u$).
Локально занумерованные множества запрещенных позиций следующие: $\{0,1,2\}$ в первом вхождении
слова $u$, $\{1\}$ во втором, $\{0,2\}$ в первом вхождении слова $v$, и $\{0\}$ во втором. 
Заметим, что слово является непокрываемым относительно $S_3$, поскольку первые три позиции
запрещены в $w$.
\end{example}

Позиция $0$ может быть как запрещенной, так и не запрещенной во вхождении $u$. 
Следующие утверждение разграничивает эти два случая. Оно является довольно простым следствием
леммы~\ref{FP_struct}.

\begin{lemma}
\label{FP_zero}
Позиция $0$ запрещена во вхождении слова $u$ в слове $w$ тогда и только тогда, когда
позиция $k - 1$ запрещена в том же вхождении слова $u$.
Позиция $0$ запрещена во всяком вхождении слова $v$ в $w$.
\end{lemma}

Два вхождения $p,q\in \{u,v\}$ в слове $w$ называются \emph{последовательными}, если 
они перекрываются, или являются единственными вхождениями из 
$\{u,v\}$ в факторе $pxq$ слова $w$.

\begin{lemma}
\label{FP_tranform}
Пусть $p,q\in \{u,v\}$ -- это два последовательных вхождения, которые не перекрываются, в слове 
$w$, и $pxq$ -- это соответствующий фактор слова $w$, где $|x|\ge0$. Пусть $F_p$ и $F_q$ -- это
множества запрещенных позиций в $p$ и $q$ соответственно. Тогда $$F_{p}\subseteq\{j+|x|\mod k\mid j\in F_q\}\cup\{0\}.$$
\end{lemma}

\begin{proof}
Рассмотрим некоторую запрещенную позицию $i$ в $p$ такую, что $i\ne0$ и рассмотрим фактор 
$y$, длина которого кратна $k$ из позиции $i$ в $p$ до некоторой позиции $j$ в $q$ ($0\le j<k$). 
Этот фактор принадлежит $S_k^+$, поскольку $p$ и $q$ являются последовательными вхождениями
слов из $\Sigma^k \setminus S_k$. Таким образом, если позиция $j\notin F_q$, тогда и позиция $i$
не является запрещенной. С одной стороны, справедливо $|y|\equiv0\mod k$, с другой
$|y|=k-i+|x|+j$, поэтому $i\equiv j+|x|\mod k$.
\end{proof}

Заметим, что два слова из $\Sigma^k \setminus S_k$ могут перекрываться только в случае 
$v$ и $u$. А именно, две последние буквы $v$ перекрываются с последними двумя буквами 
$u$, образуя слово $b^{k - 1}a^{k - 1}$. Следующее утверждение можно легко показать рассуждая
как в предыдущей лемме.

\begin{lemma}
\label{FP_transform_overlap}
Пусть $v$ и $u$ -- это два последовательных вхождения в слове $w$, и пусть $F_v$ и $F_u$ --
это соотвествующие множества запрещенных позиций. Тогда 
$$F_{v}\subseteq\{j - 2\mod k\mid j\in F_u\}\cup\{0\}.$$
\end{lemma}

Вышеприведенные леммы позволяют сделать следующее важное наблюдение. Пусть $p, q \in \{u,v\}$ 
-- это два последовательных вхождения в $w$. Тогда запрещенные позиции в $p$, за исключением
$0$, получены из запрещенных позиций в $q$, а позиция $0$ может появиться в $F_p$ согласно 
лемме~\ref{FP_zero}. В наших доказательствах мы будем отслеживать изменение запрещенных позиций
между вхождениями слов из $\Sigma^k \setminus S_k$ начиная с последнего и двигаясь к началу слова.
Заметим, что число запрещенных позиций может увеличиться лишь на единицу.

\subsection{Верхняя оценка на $uwl(S_k)$}
\label{upper}

В этом разделе мы покажем, что множество $S_k$ является непокрывающим. Для этой цели, мы приведем 
непокрываемое слово $w$ длины $5k^2-17k+13$ для всякого $k\ge 4$.

\begin{theorem}
\label{non-complete}
При $k\ge4$ множество $S_k$ непокрывающее и существует непокрываемое слово длины $5k^2-17k+13$.
\end{theorem}

\begin{proof} Для ясности, обозначим через $r$ перекрывающиеся вхождения $v$ and $u$, т.е. $r=b^{k-1}a^{k-1}$. Рассмотрим слово $\omega=u\dt\prod\limits_{i=1}^{k-3}(ra^i\dt b^{k-2-i}r\dt)v$, где $\dt$ может 
быть заменено всякой буквой из алфавита $\Sigma$. Занумеруем вхождения слова $v$ в обратном порядке
начиная с последнего(первое вхождение слова $v$ в данном порядке будет иметь номер $0$). Через 
$F_{v}^i \subseteq \{0, \ldots, k - 1\}$ мы обозначим множество запрещенных позиций 
в $i$-ом вхождении слова $v$. Вхождения $u$ считаются тем же образом(но начиная с $1$, а не с $0$) и
$F_u^i$ определяется аналогичным образом. Заметим, что $F_v^0 = \{0\}$. Тогда используя вышеприведенные
леммы нетрудно видеть, что $F_u^1=\{1\}$ и $F_v^1=\{0,k-1\}$. По лемме~\ref{FP_tranform} мы получаем, что
$F_u^2\subseteq\{0,k-2,k-1\}$ и по леммам~\ref{FP_struct}~и~\ref{FP_zero} заключаем $F_u^2=\{0,k-2,k-1\}$.
Рассуждая аналогичным образом имеем $F_v^2=\{0,k-3,k-2\}$.
Проведем рассуждения по индукции. Предположим, что $F_v^{2i}=\{0,k-i-2,\ldots,k-2\}$, 
$1\le i\le k-4$, и покажем, что $F_v^{2(i+1)}=\{0,k-i-3,\ldots,k-2\}$. Применяя шаг за шагом
леммы~\ref{FP_struct}-\ref{FP_transform_overlap} мы получим следующие множества запрещенных
позиций: $$\begin{array}{l}
                        F_u^{2i+1}=\{0,1,k-i,\ldots,k-1\},\\
                        F_v^{2i+1}=\{0,k-i-1,\ldots,k-1\}, \\
                        F_u^{2i+2}=\{0,k-i-2,\ldots,k-1\},\\
                        F_v^{2i+2}=\{0,k-i-3,\ldots,k-2\}.
                       \end{array}
$$
Таким образом, при $i=k-3$ мы имеем $F_v^{2(k-3)}=\{0,1,\ldots,k-2\}$. Отсюда можно заключить, что
множество запрещенных позиций в последнем вхождении $u$ равно $F_u^{2(k-3)+1}=\{0,1,\ldots,k-1\}$, 
что влечет непокрываемость слова $\omega$. Его длина равна $5k^2-17k+13$.
\end{proof}

\subsection{Нижняя оценка на $uwl(S_k)$}
\label{lower}

Сначала мы покажем несколько свойств, которым должно удовлетворять кратчайшее непокрываемое
слово из $S_k$.

\begin{theorem}
\label{minimal_border}
Пусть $w$ -- это кратчайшее непокрываемое слово относительно $S_k$. Тогда $u$ -- это префикс $w$,
а $v$ -- его суффикс.
\end{theorem}

\begin{proof}
Слово $w$ содержит $u$ или $v$ в качестве фактора, поскольку иначе $w \in \Pref((S_k \cap \Sigma^{k})^*)$.
Пусть $w = w'x$, где $|x| = k$, и предположим $x \ne v$. Пусть $x = x'z$, где $z \in \Sigma$. Поскольку
$w$ -- это кратчайшее непокрываемое слово, мы получаем $w'x' \in \Fact(S_k^*)$. А последнее равенство
означает, что $rw'x' = qy$, для некоторых $q \in S_k^*$ и $|y| \leq k - 1$. Если $|y| < k - 1$, то
$yz \in \Pref(S_k)$, поскольку любое слово длины не более $k - 1$ является префиксом некоторого
слова в $S_k$. Если $|y| = k - 1$, то $yz = x$. Если $x \ne u$, то $yz \in S_k$, и $qyz = rw \in S_k^*$. 
Если $x = u$, то $y = ba^{k - 2}$, $z = a$ и мы получаем например $rwa^{k - 1} \in S_k^*$. 
В любом случае, возникает противоречие с тем, что $w$ является непокрываемым словом. 
Таким образом, $w$ содержит $v$ в качестве суффикса.

Покажем теперь, что непокрываемые слова $S_k$ обладают некоторой симметрией.
Легко понять, что зеркальный образ $\overleftarrow{S}$ непокрывающего множества $S$ также 
является непокрывающим множеством. Более того, зеркальные образы $\overleftarrow{w}$ 
непокрываемых слов $w$ относительно $S$ являются непокрываемыми относительно $\overleftarrow{S}$. Тому же
свойству удовлетворяет и следующий морфизм: $\varphi(a) = b$ и $\varphi(b) = a$. Применяя данные 
утверждения к нашему множеству мы получаем $T_k = \overleftarrow{S_k} = \varphi(S_k)$, где
$$T_k=\left(\Sigma^k\setminus\{a^{k-1}b,ab^{k-1}\}\right)\cup\left(\Sigma^{k-1}\setminus
\{a^{k-1},b^{k-1}\}\right).$$ Таким образом, если $w$ является непокрываемым словом относительно 
$S_k$, то $\varphi(\overleftarrow{w})$ также является непокрываемым относительно $S_k$. Мы уже
показали, что всякое кратчайшее непокрываемое слово имеет $v$ в качестве суффикса. Из
вышеприведенной симметричности мы получаем, что всякое такое слово также имеет $u$ в качестве префикса.
\end{proof}

Суффикс $v$ кратчайшего непокрываемого слова $w$ содержит лишь одну запрещенную позицию, а именно,
$0$, а в префиксе $u$ слова $w$ все позиции от $0$ до $k - 1$ являются запрещенными. Таким образом, 
нам нужно проанализировать, как запрещенные позиции меняются при переходе от одного вхождения 
слова из $\Sigma^k \setminus S_k$ к другому.

Рассмотрим произвольное вхождение слова из $\Sigma^k \setminus S_k$ в $w$. Пусть $F$ -- это множество
его запрещенных позиций	. Представим теперь $F$ следующим образом: $$F = [f_{1,1}, f_{1, 2}, \ldots, 
f_{1, m_1}; f_{2,1}, \ldots, f_{2,m_2}; \ldots; f_{n, 1}, \ldots, f_{n, m_n}],$$ где 
$f_{i, j + 1} \equiv f_{i,j} + 1 \mod k$, $f_{i + 1, 1} > f_{i, m_i}$ и $n\ge 1$. 
Иначе говоря, мы разбиваем множество $F$ на блоки последовательных (относительно циклического
порядка) запрещенных позиций.

\begin{example}
Рассмотрим слово $ba^{10}$, и пусть $F = \{0,1,2,5,6,8,10\}$ -- это множество запрещенных позиций 
относительно $S_{11}$. Тогда согласно новому представлению $F = [5,6; 8; 10,0,1,2]$.
\end{example}


\begin{theorem}
\label{increase}
Пусть $p$ и $q$ -- это два последовательных вхождения слов из $\{u,v\}$ в кратчайшем непокрывающем 
слове $w$. Пусть $F_p$ и $F_q$ -- это множества запрещенных позиций в $p$ и $q$ соответственно. 
Если $|F_p| > |F_q|$, тогда справедливо одно из следующих утверждений:
\begin{enumerate}
\item[(i)] $p = q = u$, $F_p = \{0, k - j, \ldots, k - 1\}$ и $F_q = \{1, \ldots, j\}$, где
$1 \leq j \leq k - 2$;
\item[(ii)] $p = v$, $q = u$, эти вхождения перекрываются, $F_p=\{0,k-1\}$ и $F_q = \{1\}$;
\item[(iii)] $p = u$, $q = v$, $F_p = \{0, j - i - 1, \ldots, k - 1\}$, $F_q = \{0, \ldots, 
i, j, \ldots, k - 1\}$, где $j \not\equiv i + 1\mod k$ и между этими вхождениями находится
$k - 1 - i \mod k$ букв;
\end{enumerate}
\end{theorem}

\begin{proof}
Пусть $F_q = [f_{1,1},  \ldots, f_{1, m_1}; \ldots; f_{n, 1}, \ldots, f_{n, m_n}]$. Предположим
сначала, что $p$ и $q$ не перекрываются, пусть $pxq$ -- это соответствующий фактор $w$.

\emph{Случай 1.}
Пусть $p = q = u$. Рассмотрим случай $n \geq 2$. Тогда найдется $1 \leq i \leq n$ такой, что $f_{i, 1}
\geq 2$. Если $f_{i,1} > 2$, тогда по лемме~\ref{FP_struct} позиция $f_{i,1} + |x| \notin F_p$. Если 
$f_{i,1} = 2$, тогда по той же лемме $f_{i,1} + |x| \in F_p$ имеем $x = x'b^{k - 2}$. Но тогда $v$
является фактором $pxq$, что противоречит тому факту, что $p$ и $q$ являются последовательными
вхождениями из $\{u,v\}$. Таким образом, $f_{i,1} + |x|$ не может быть запрещенной в $p$. По
лемме~\ref{FP_tranform} мы заключаем, что $F_p \subseteq\{j+|x|\mod k\mid j\in F_q\}\cup\{0\}$,
а значит $|F_p| \leq |F_q|$, противоречие. Следовательно, $n = 1$ и $F_q = [f_{1,1}, \ldots, f_{1, m}]$.
Если $f_{1,1} \geq 2$, тогда повторяя рассуждения приведенные выше, мы получаем $|F_p| \leq |F_q|$,
откуда $f_{1,1} \in \{0,1\}$. Заметим, что при $f_{1,1} = 0$, по лемме~\ref{FP_zero} мы получаем
$k - 1 \in F_q$. А это означает, что $F_q = \{0,1, \ldots, k - 1\}$. Но это противоречит тому, что
$w$ кратчайшее. Таким образом, мы заключаем $f_{1,1} = 1$. Если $f_{1,m} = k - 1$, тогда из 
леммы~\ref{FP_zero} следует, что $0 \in F_q$ и в данном случае $f_{1,1}$ не может быть равен $1$. 
Таким образом, $f_{1,m} \leq k - 2$.
Осталось показать, что $F_p$ имеет вид, описанный в $(i)$. Поскольку $|F_p| > |F_q|$, то $0 \in F_p$. 
Но тогда по лемме~\ref{FP_zero} мы получаем, что $k - 1$ также лежит в $F_p$. Следовательно, найдется 
позиция $i \in F_q$ удовлетворяющая сравнению $i + |x| \equiv k - 1 \mod k$. Если $i < f_{1,m}$, то 
$i + 1 + |x| \equiv 0 \mod k$, а значит и $|F_p| \leq |F_q|$. Поэтому $i = f_{1,m}$, $|x| \equiv 
k - f_{1,m} - 1 \mod k$ и по лемме~\ref{FP_tranform} мы заключаем $F_p = \{0, k - f_{1,m}, 
\ldots, k - 1\}$.

\emph{Случай 2.}
Пусть $p = v$, $q = u$. Мы покажем, что либо $f_{1,1} + |x|$ не запрещена в $p$, либо $f_{1,1} + |x|
\equiv 0 \mod k$. В обоих случаях $|F_p| \leq |F_q|$. Это справедливо при $f_{1,1} \geq 2$ по рассуждениям
как в предыдущем случае. Заметим, что $f_{1,1} \ne 0$, иначе по лемме~\ref{FP_zero} позиция $k - 1 \in F_q$,
что противоречит нашему представлению множества запрещенных позиций. Поэтому, $f_{1,1} = 1$. Предположим,
что $1 + |x| \equiv i \mod k$. Если $0 < i < k - 1$, тогда по лемме~\ref{FP_struct} позиция $i$ не
является запрещенной в $p$. Если $i = 0$, тогда лемма~\ref{FP_tranform} влечет $|F_p| \leq |F_q|$. Если
$i = k - 1$, тогда по лемме~\ref{FP_struct} мы заключаем, что $i \in F_p$ только в случае, когда 
$a^{k - 2}$ является префиксом слова $x$, но тогда $p$ и $q$ не являются последовательными вхождениями
слов из $\{u,v\}$.

\emph{Случай 3.}
Пусть $p = u$, $q = v$. Предположим, что $n\ge 2$, и рассмотрим произвольные позиции $f_{i, 1} < 
f_{j, 1}\in F_q$. Мы покажем, что либо $f_{i, 1}+|x|\mod k\notin F_p$, либо $f_{j,1}+|x|\mod k\notin F_p$.
Рассуждая от противного, предположим, что обе позиции являются запрещенными в $p$. Тогда по
лемме~\ref{FP_struct} слово $x$ должно иметь суффикс $b^{k-f_{j, 1}}$ (если $|x|< k-f_{j,1}$, то
$f_{j,1}+|x|\mod k\notin F_p$ по лемме~\ref{FP_struct}). Аналогичным образом, $b^{k-f_{i,1}}$ должно
быть суффиксом $x$, и если $|x|< k-f_{i,1}$, то $f_{i,1}+|x|\mod k \notin F_p$ по лемме~\ref{FP_struct}.
Но тогда по той же лемме слово $x$ оканчивается на $k+(k-f_{j,1})$ букву $b$. Продолжая эти рассуждения
мы получим, что слово $x$ оканчивается на $\ell k - f_{j,1}$ букв $b$ для всякого положительного числа
$\ell$. Это означает, что не может существовать такого конечного слова $x$, что обе позиции 
$f_{i,1}+|x|\mod k$ и $f_{j,1}+|x|\mod k$ являются запрещенными в $p$. Поэтому, $n=1$, и 
$F_q = [f_{1,1}, \ldots, f_{1,m}]$. Поскольку $|F_p| > |F_q|$, то по леммам~\ref{FP_tranform} 
и~\ref{FP_zero} не существует такого $j$, что $f_{1,j} + |x| \equiv 0 \mod k$. Кроме того, 
$f_{1, i} + |x| \equiv k - 1 \mod k$ для некоторого $i$. Если $i < m$, тогда $f_{1, i + 1} + 
|x| \equiv 0 \mod k$, что невозможно. Поэтому, $i = m$. Более того, $|x| \equiv k - 1 - f_{1,m} \mod k$. 
Поскольку $0$ всегда является запрещенной позицией в $v$, то мы можем представить $F_q$ в виде 
$\{0, \ldots i, j, \ldots, k - 1\}$ для некоторого $0 \leq i < j \leq k - 1$. Тогда по 
лемме~\ref{FP_tranform} мы имеем $F_p = \{0, j - i - 1, \ldots, k - 1\}$.

\emph{Случай 4.}
Пусть $p = v$, $q = v$. Если $f_{1,1} + |x| \not\in F_p$ тогда $|F_p| \leq |F_q|$. Иначе по 
лемме~\ref{FP_struct} справедливо $f_{1,1} + |x| \equiv 0 \mod k$ или $f_{1,1} + |x| \equiv k - 1 \mod k$. 
В первом случае по лемме~\ref{FP_tranform} мы заключаем, что $|F_p| \leq |F_q|$. А во втором, 
лемма~\ref{FP_struct} влечет, что слово $a^{k - 2}$ является префиксом $x$, что противоречит тому факту,
что $p$ и $q$ являются последовательными вхождениями.

Предположим теперь, что $p = v$, $q = u$, и они перекрываются. Если существует $i$ такой, что $f_{i,1} > 2$,
то по леммам~\ref{FP_struct} и~\ref{FP_transform_overlap} позиция $f_{i,1} - 2 \not\in F_p$, поэтому 
$|F_p| \leq |F_q|$. Отметим, что $f_{1,1} \ne 0$, иначе по лемме~\ref{FP_zero} позиция $k - 1 \in F_q$
что противоречит нашему представлению множества запрещенных позиций. Поэтому, для всех $i$ мы имеем
$f_{i, 1} \in \{1,2\}$. Это немедленно влечет, что $n = 1$. Если $f_{1,j} = 2$ для некоторого $j$ тогда
по лемме~\ref{FP_transform_overlap} мы получаем, что $f_{1,j} - 2$ равно $0$ и $|F_p| \leq |F_q|$. 
Поэтому $F_q = \{1\}$ и $F_p = \{0, k - 1\}$.
\end{proof}


\begin{lemma}
\label{uu=}
Пусть $p$ и $q$ -- это два последовательных вхождения $u$ в слове $w$, а $F_p$ и $F_q$ суть соответствующие
множества запрещенных позиций. Если $F_q = \{0,i,\ldots, k - 1\}$ и $|F_p| = |F_q|$, то $F_p = F_q$.
\end{lemma}

\begin{proof}
Если $i=1$, тогда утверждение леммы очевидно верно. Поэтому мы можем считать $i>1$. Пусть $pxq$ --
это соответствующий фактор $w$. Тогда по лемме~\ref{FP_tranform} мы получаем $F_p\subseteq\{0,|x|\mod k, 
i+|x|\mod k, i+1+|x|\mod k,\ldots,k-1+|x|\mod k\}$. И по лемме~\ref{FP_struct} позиция $i+|x|\mod 
k\notin F_p$. Таким образом, если $|F_p|=|F_q|$, то необходимо выполняется $0\in F_p$ и 
$j+|x|\not\equiv 0\mod k$ для всех $i+1\le j\le k$. Лемма~\ref{FP_zero} влечет $k-1\in F_p$. Это означает,
что $j+|x|\equiv k-1\mod k$ для некоторого $i+1\le j\le k$. А тогда, $j=k$, $|x|\equiv k-1\mod k$ и
$F_p=\{0,i,i+1,\ldots,k-1\}=F_q$.
\end{proof}

\begin{lemma}
\label{vu=}
Пусть $p$ и $q$ -- это последовательные вхождения $v$ и $u$ соответственно в кратчайшем непокрываемом
слове $w$. Пусть $F_p$ и $F_q$ -- это соответствующие множества запрещенных позиций. Если $F_q = 
\{0,i,\ldots, k - 1\}$ и $|F_p| = |F_q|$, тогда данные вхождения перекрываются и 
$F_p = \{0, i - 1, \ldots, k - 2\}$.
\end{lemma}

\begin{proof}
Если $i=1$, тогда $w$ не является кратчайшим непокрываемым словом, поэтому $i > 1$.
Предположим, что $p$ и $q$ не перекрываются, тогда существует $x$, такой, что $pxq$ является фактором $w$.
По лемме~\ref{FP_tranform} мы получаем $F_p\subseteq\{0,|x|\mod k, i+|x|\mod k, i+1+|x|\mod k,\ldots,
k-1+|x|\mod k\}$ и лемма~\ref{FP_struct} влечет, что либо $i+|x|\notin F_p$ или $i+|x|\equiv 0\mod k$.
Более того, если $j+|x|\equiv 0\mod k$ для некоторых $i+1\le j\le k$, тогда мы немедленно получаем
$|F_p|<|F_q|$. Таким образом, мы можем считать, что $j+|x|\not\equiv 0\mod k$ для всех $i+1\le j\le k$. 
Во-первых, пусть $|x|>k-(i+1)$. Тогда из леммы~\ref{FP_struct} следует, что если позиция $i+1+|x|\mod k$
является запрещенной в $p$, то либо $i+1+|x|\equiv 0\mod k$ либо $i+1+|x|\equiv k-1\mod k$. Первый
случай противоречит нашему предположению. Во-втором же $x = a^{k - 2}x'$, но это противоречит тому, что
$p$ и $q$ являются последовательными вхождениями. Поэтому, оба случая невозможны. Итак, 
$0\le |x|\le k-(i+1)$, но тогда мы имеем $i+1\le j=k-|x|\le k$. Это означает, что $j\mod k$ является 
запрещенной позицией в $q$ и $j+|x|\equiv 0\mod k$, что также противоречит нашему предположению о том,
что $j+|x|\not\equiv 0\mod k$ для всех $i+1\le j\le k$.
Таким образом, вхождения $p$ и $q$ перекрываются. По леммам~\ref{FP_struct} и \ref{FP_transform_overlap}
мы получаем $F_{p}=\{0, i-1,\ldots, k-2\}$.
\end{proof}

\begin{lemma}
\label{vv-}
Пусть $p$ и $q$ -- это два последовательных вхождения слова $v$ в кратчайшее непокрываемое слово $w$,
и пусть $F_p$ и $F_q$ -- это соответствующие множества запрещенных позиций. Если $F_q = \{0,i,
\ldots, k - 2\}$ тогда $|F_p| < |F_q|$.
\end{lemma}

\begin{proof}
Рассмотрим фактор $pxq$ слова $w$. По лемме~\ref{FP_tranform} мы получаем $F_{p}\subseteq\{0,|x|\mod k,
i+|x|\mod k, i+1+|x|\mod k,\ldots, k-2+|x|\mod k\}$. Мы покажем, что $|x| \mod k$ не является запрещенной
в $p$. Легко получить из леммы~\ref{FP_struct}, что позиция $|x| \mod k \in F_p$ лишь в случае 
$|x| \equiv 0 \mod k$ или $|x| \equiv k - 1 \mod k$. Первый случай ведет к противоречию с
тем, что $w$ -- это кратчайшее непокрываемое слово, поскольку мы бы получили $F_p=F_q$. 
Во втором случае по той же лемме мы получим, что $x = a^{k - 2}x'$, что противоречит тому факту, что
$p$ и $q$ являются последовательными вхождениями. Похожие аргументы можно применить к позиции 
$i + |x| \mod k$. А именно, если $i + |x| \equiv k - 1 \mod k$, то снова $x = a^{k - 2}x'$, противоречие. 
Поэтому, либо $i + |x| \equiv 0 \mod k$ или $i+|x|\mod k\notin F_p$. В обоих случаях, мы получаем
$|F_p| < |F_q|$.
\end{proof}

\begin{lemma}
\label{uv_special}
Пусть $p$ и $q$ -- это последовательные вхождения $u$ и $v$ соответственно в слове $w$. Пусть $F_p$ и $F_q$
-- это соответствующие множества запрещенных позиций, и пусть $|F_p| = |F_q|$. Если $F_q = \{0, i, 
\ldots, k - 2\}$ при $i > 1$ и $F_p=[f_{1,1},\ldots,f_{1,m}]$, 
тогда либо $F_p = \{0,1, i + 2, i + 3, \ldots, k - 1\}$, либо $F_p = \{0, i + 1, i + 2, \ldots, k - 1\}$.
\end{lemma}

\begin{proof}
Рассмотрим фактор $pxq$ слова $w$. По лемме~\ref{FP_tranform} мы получаем $F_{p}\subseteq\{0,|x|\mod k,
i+|x|\mod k, i+1+|x|\mod k,\ldots, k-2+|x|\mod k\}$. Рассуждая как в случае~3 теоремы~\ref{increase}
мы легко получаем, что либо $|x| \mod k \notin F_p$ или $i + |x| \mod k \notin F_p$. Предположим, что
позиция $|x| \mod k$ не является запрещенной в $F_p$. Поскольку $|F_p| = |F_q|$, то необходимо, чтобы
$0 \in F_p$, поэтому $k - 1$ также лежит в $F_p$ по лемме~\ref{FP_zero}. Всякое $i \leq j \leq k - 3$
удовлетворяет $j + |x| \not\equiv k - 1 \mod k$, иначе $j + 1 + |x| \equiv 0 \mod k$, 
что влечет $|F_p| < |F_q|$. Поэтому, $k - 2 + |x| \equiv k - 1\mod k$, откуда $|x| \equiv 1 \mod k$ 
и $F_p = \{0, i + 1, \ldots, k - 1\}$. Предположим теперь, что позиция $ i + |x| \mod k \notin F_p$. 
Рассуждая так же, как и в предыдущем случае, мы получаем $k - 1 \in F_p$ и либо $|x| \equiv k - 1 \mod k$ 
либо $k - 2 + |x| \equiv k - 1 \mod k$. В первом случае $F_p = \{0, i, \ldots, k - 3, k - 1\}$, что
больше чем один блок запрещенных позиций, а это противоречит условию. А во втором случае
$|x| \equiv 1 \mod k$ and $F_p = \{0, 1, i+2, \ldots, k-1\}$.
\end{proof}

\begin{theorem}
Длина кратчайшего непокрываемого слова для $S_k$ не менее $5k^2 - 17k + 13$ for $k \ge 4$.
\end{theorem}

\begin{proof}
Пусть $w$ -- это произвольное кратчайшее непокрываемое слово для $S_k$. По теореме~\ref{minimal_border}
слово $u$ является префиксом $w$ и $v$ является его суффиксом. Заметим, что $F_{u}=\{0,1,\ldots,k-1\}$ и
$F_v=\{0\}$ в вышеупомянутых вхождениях $u$ и $v$.

Если $s$ и $t$ -- это два последовательных вхождения слов из $\{u,v\}$ со свойством $|F_s| > |F_t|$, 
тогда мы будем называть $s$ \emph{возрастающим вхождением}. Отметим, что по лемме~\ref{FP_tranform} 
мы получаем, что $|F_s| = |F_t| + 1$.  Поскольку лишь одна позиция является запрещенной в последнем
вхождении слова $v$ в $w$ и уже $k$ позиций запрещены в первом вхождении $u$, то $w$ должно содержать
не менее $k-1$ возрастающего вхождения. Теперь мы оценим длину фактора между двумя такими
вхождениями.

Рассмотрим фактор $pxq$ слова $w$ такой, что $p$ и $q$ являются единственными возрастающими вхождениями
внутри данного фактора. Заметим, что для всякого вхождения $r \in \{u,v\}$ в $pxq$, отличного от $p$ и $q$ 
(если такое найдется), справедливо $|F_r| = |F_q|$. Иначе $p$ и $q$ не являются последовательными
возрастающими вхождениями.

Пусть $3 \leq |F_q| < |F_p| \leq k$. Тогда по теореме~\ref{increase} мы имеем $p = q = u$, 
$F_q = \{0, i, \ldots, k - 1\}$ и $F_p = \{0, i - 1, \ldots, k - 1\}$. Более того, $p$ и $q$
не единственные вхождения слов из $\{u,v\}$ в $pxq$. Предположим сначала $i> 2$, т.е. $|F_p|<k$.

Предположим, что существует лишь одно вхождение $r \in \{u,v\}$ в $pxq$, отличное от $p$ и $q$. 
Тогда по лемме~\ref{uu=} мы получаем, что $r = v$, а из факта $|F_r| = |F_q|$, применяя лемму~\ref{vu=}
мы получаем $F_r = \{0, i - 1, \ldots, k - 2\}$. Но тогда при $i>2$ множество $F_r$ имеет другой вид, 
нежели описанный в теореме~\ref{increase}, а значит $|F_p| > |F_r|$ выполняться не может.

Предположим теперь, что $r_1,r_2 \in \{u,v\}$ -- это два вхождения в $pxq$, отличные от $p$ и $q$. 
Рассуждая как в предыдущем случае, мы заключаем, что $r_2 = v$ и $F_{r_2} = \{0, i - 1, \ldots, k - 2\}$. 
Если $r_1 = u$, тогда с одной стороны, теорема~\ref{increase} влечет $F_{r_1} = \{1, 2, \ldots, k - i + 1\}$.
А с другой стороны, по лемме~\ref{uv_special} позиция $0$ должна быть запрещена в $F_{r_1}$, противоречие. Если 
$r_2 = v$, тогда по лемме~\ref{vv-} мы получаем $|F_{r_1}| < |F_{r_2}|$, что невозможно. Таким образом,
найдется не менее трех вхождений слов из $\{u,v\}$ в $pxq$, кроме $p$ и $q$.

Пусть теперь $r_1, r_2, r_3 \in \{u,v\}$. Как и ранее, мы можем заключить, что $r_3 = v$ и $F_{r_3} = \{0, i - 1, 
\ldots, k - 2\}$. Отсюда по лемме~\ref{vv-} мы заключаем, что $r_2 = u$. Заметим, что тогда $F_{r_2}$ равно 
$\{0,1, i + 1, i + 2, \ldots, k - 1\}$ или $\{0, i, i + 1, \ldots, k - 1\}$ по лемме~\ref{uv_special}. 
Второй случай противоречит минимальности $w$, поскольку тогда выполнено $|F_{r_2}|=|F_{q}|$.
Предположим $r_1=u$, тогда по теореме~\ref{increase} справедливо $F_{r_1}=\{1,2,\ldots,k-i+1\}$. Пусть $r_1yr_2$ -- 
фактор $pxq$. Заметим, что $0\notin F_{r_1}$ и по лемме~\ref{FP_struct} позиция $i+1+|y|\mod k\notin F_{r_1}$. 
Поэтому $|F_{r_1}|<|F_{r_2}|$, противоречие. Таким образом, $r_1=v$. Такой случай возможен. Например, такая ситуация
возникает в слове, представленном в теореме~\ref{non-complete}.

Оценим теперь длину слова $x$ в данном случае. По лемме~\ref{vu=} фактор $r_3$ перекрывается с $q$, тогда мы можем
факторизовать $x$ следующим образом: $x=y_1r_1y_2r_2y_3b^{k-2}$ или, в случае, когда $r_1$ и $r_2$ перекрываются,
$x=z_1b^{k-1}a^{k-1}z_2b^{k-2}$. По доказательству леммы~\ref{uv_special}, поскольку $F_{r_2}=\{0,1, i + 1, i + 2,
\ldots, k - 1\}$, мы получаем $|y_3|\equiv |z_2|\equiv 1\mod k$. Оценим сначала длину слова $z_1$. Поскольку $r_1$
и $r_2$ перекрываются, лемма~\ref{FP_transform_overlap} влечет $F_{r_1}=\{0,i,i+1\ldots,k-1\}$. Тогда по 
теореме~\ref{increase} между $p$ и $r_1$ находится $k-1\mod k$ букв, откуда $|z_1|\equiv k-1\mod k$. Таким образом,
в этом случае мы получаем $|x|\ge 4k-4$. Предположим теперь, что $r_1$ и $r_2$ не перекрываются. По теореме~\ref{increase}
фактор $r_1$ должен содержать ровно один блок запрещенных позиций. Отсюда по лемме~\ref{FP_tranform} мы заключаем 
$F_{r_1}\subseteq\{0, i+1+|y_2|\mod k, i+2+|y_2|\mod k,\ldots, k-1+|y_2|\mod k, |y_2|\mod k, |y_2|+1\mod k\}$. Заметим, что
тогда по лемме~\ref{FP_struct} выполняется $i+1+|y_2|\mod k\notin F_{r_1}$ или $i+1+|y_2|\equiv 0\mod k$. Таким образом,
если множество $F_{r_1}$ содержит ровно один блок последовательных запрещенных позиций и имеет ту же мощность, что и 
$F_{r_2}$, то $1+|y_2|\equiv k-1\mod k$ или $i+2+|y_2|\equiv 1\mod k$. В первом случае, мы получаем $|y_2|\equiv k-2\mod k$
и $F_{r_1}=\{0,i,i+1,\ldots,k-1\}$, что совпадает со случаем перекрывающихся вхождений $r_1$ и $r_2$, а значит такой
случай не может быть реализован в минимальном непокрываемом слове. Во втором случае справедливо $|y_2|\equiv k-i-1\mod k$
и $F_{r_1}=\{0,1,2,\ldots, k-i\}$. Тогда по теореме~\ref{increase} мы заключаем, что $|y_1|\equiv i-1\mod k$. Таким образом,
в данном случае $|x|\ge 4k-3$.

Нетрудно видеть, что если найдется более чем три вхождения слов из $\{u,v\}$ отличных от $p$ и $q$ в $pxq$, тогда даже
если некоторые из них перекрываются, то длина слова $x$ не менее $4k-4$. Таким образом, $|x|\ge 4k-4$. Заметим, что $|x|=4k-4$
для слова из теоремы~\ref{non-complete}.


Пусть теперь $i=2$, т.е. $F_p=\{0,1,\ldots,k-1\}$ и $F_q=\{0,2,3,\ldots,k-1\}$. Рассуждая как в предыдущем случае, по леммам~\ref{uu=}
и \ref{vu=} найдется вхождение $r=v$ перед фактором $q$, перекрывающиеся с $q$ и $F_r=\{0,1,\ldots,k-2\}$. Если это вхождение
единственно и $pxq=pyb^{k-2}q$, то по теореме~\ref{increase} мы получим $|y|\equiv 1\mod k$ и $F_p=\{0,1,\ldots,k-1\}$. Таким
образом, в данном случае $|x|\ge k+1$. Нетрудно понять, что большее число вхождений слов из $\{u,v\}$ в $pxq$ сделает фактор
$x$ лишь длиннее.

Рассуждения предыдущего абзаца показывают, что всякое минимальное непокрываемое слово имеет префикс $pyb^{k-2}q$ при $p=q=u$ и 
$|y|\equiv 1\mod k$. Исходя из симметрии, отмеченной в теореме~\ref{minimal_border} мы получаем, что всякое минимальное
непокрываемое слово также имеет суффикс $q'a^{k-2}\hat{y}p'$ при $p'=q'=v$ и $|\hat{y}|\equiv 1\mod k$. Ясно, что  $F_{p'}=\{0\}$.
Для того, чтобы вычислить $F_{q'}$ отметим, что найдется вхождение $r=u$ перекрывающиеся с $q'$ и $F_r=\{1\}$. Из теоремы~\ref{increase}
мы получаем, что вхождение $q'$ является возрастающим и $F_{q'}=\{0,k-1\}$. Пусть $p$ -- это следующее возрастающее вхождение. Если
$|F_p| = 3$, тогда по той же теореме следует, что $p=u$, $F_p=\{0,k-2,k-1\}$ и найдется не менее $k-1$ букв между $p$ и $q'$. Если же
$|F_p| \leq 2$, тогда нам потребуется не менее $k$ букв между $q'$ и возрастающим вхождением с тремя запрещенными позициями.

Таким образом, для того, чтобы увеличить число запрещенных позиций с $1$ в суффиксе $v$ слова $w$ до $2$ нам потребуется не менее
$k-1$ буквы; с $2$ позиций до $3$ -- не менее $k-1$; с $\ell$ до $\ell+1$ при $3\le \ell\le k-2$ нам нужно не менее $4k-4$ букв, 
и наконец, с $k-1$ до $k$ нам нужна $k-1$ буква. Кроме того, слово содержит не менее $k-1$ возрастающего вхождения и суффикс $v$
слова $w$ лишь с одной запрещенной позицией. Итого, длина кратчайшего непокрываемого слова не менее 
$3(k-1)+(4k-4)(k-4)+k(k-1)+k=5k^2-17k+13.$
\end{proof}

\subsection{Заключение}
Серия множеств $S_k$ была найдена в ходе исчерпывающего вычислительного эксперимента. Мы перебрали все максимальные по включению
непокрывающие множества среди всех подмножеств $\Sigma^{\leq 3}$; нас интересовали множества, с наибольшим возможным непокрываемым
словом. Мы нашли два множества, достигающих наибольшее значение, с точностью до переименования букв и взятия зеркального образа.
А именно, $S_3 = \left(\Sigma^3\setminus\{baa,bba\}\right)\cup\left(\Sigma^{2}\setminus\{aa,bb\}\right)$ и  $\left(\Sigma^3\setminus\{baa,bba\}\right)\cup\left(\Sigma^{2}\setminus\{ab,ba\}\right)$. Вычисления основывались на представлении
множества $S^*$ в виде цветочного автомата и том факте, что $S$ является непокрывающим тогда и только тогда, когда соответствующий
автомат является синхронизируемым. Более того, множество непокрываемых слов совпадает с языком синхронизирующих слов, смотрите 
\cite{BePeReu09} и \cite{Prib09} для деталей. Вычисления тем же методом при $k = 4$ оказались слишком сложными для обычного ноутбука,
поэтому был произведен поиск с ограничением $|\Sigma^{4} \cap S| \geq 11$. Позднее поиск был повторен без ограничений с использованием
УЛУЧШЕННОГО(ОПИСАНИЕ) алгоритма. Был найден лишь один экстремальный пример непокрывающего множества с точностью до переименования 
букв и взятия зеркального образа. А именно, $\left(\Sigma^4\setminus\{aabb, abaa, abbb\}\right)\cup\left(\Sigma^{3}\setminus\{aba, 
bba, bbb\}\right)$. Длина кратчайшего непокрываемого для данного равна $31$. Отметим, что для множества $S_4$ кратчайшее
непокрываемое слово имеет длину $25$. Таким образом, $S_k$ перестает быть оптимальным уже при $k = 4$. А значит, естественно
предположить, что граница $5k^2 - 17k + 13$ может быть улучшена. 
%Самым же интересным вопросом, the most interesting question whether the tight bound is quadratic remains open.


%\bibliographystyle{gost71s}
%\bibliography{PhD_bib}

\newpage
\begin{thebibliography}{99}
\addcontentsline{toc}{section}{Список литературы}

\bibitem{Lis69}
\textsl{В.\,А.\,Лисковец}, Число связных инициальных автоматов, Кибернетика,
\No3 (1969), 16--19.

\bibitem{ST00}
\textsl{В.\,Н.\,Сачков, В.\,Е.\,Тараканов}, Комбинаторика неотрицательных
матриц. М.: ТВП, 2000.

\bibitem{AGW}
\textsl{R.\,L.\,Adler, L.\,W.\,Goodwyn, B.\,Weiss}, Equivalence of topological
Markov shifts, Israel J. Math., 27 (1977), 49--63.

\bibitem{AMR}
\textsl{M.\,Almeida, N.\,Moreira, R.\,Reis}, Enumeration and generation with a
string automata representation, Theor.\ Comput.\ Sci., 387 (2007), 93--102.

\bibitem{AGV10}
\textsl{D.\,S.\,Ananichev, V.\,V.\,Gusev, M.\,V.\,Volkov}, Slowly synchronizing
automata and digraphs, Mathematical Foundations of Computer Science, Lect.\
Notes Comput.\ Sci., 6281 (2010), 55--64.

\bibitem{AVZ}
\textsl{D.\,S.\,Ananichev, M.\,V.\,Volkov, Yu.\,I.\,Zaks}, Synchronizing
automata with a letter of deficiency 2, Theor.\ Comput.\ Sci., 376 (2007),
30--41.

\bibitem{Be10}
\textsl{M.\,Berlinkov}, Approximating the minimum length of synchronizing words
is hard,  Computer Science in Russia, Lect.\ Notes Comput.\ Sci., 6072 (2010),
37--47.

\bibitem{Be11}
\textsl{M.\,Berlinkov}, On a conjecture by Carpi and D'Alessandro, Int.\ J.
Foundations Comp.\ Sci., 22 (2011), 1565--1576.

\bibitem{BePeReu09}
J. Berstel, D. Perrin, and C. Reutenauer. \emph{Codes and automata}, Cambridge University press, 2009.

\bibitem{BrRy91}
\textsl{R.\,Brualdi, H.\,Ryser}, Combinatorial Matrix Theory, Cambridge University Press, 1991.

\bibitem{Carpi&D'Alessandro:2010}
\textsl{A.\,Carpi, F.\,D'Alessandro}, On the hybrid \v{C}ern{\'y}-{R}oad
{C}oloring {P}roblem and {H}amiltonian paths, Developments in Language Theory,
Lect.\ Notes Comput.\ Sci., 6224 (2010), 124--135.

\bibitem{Ce64}
\v{C}ern\'{y} J. \emph{Pozn\'{a}mka k homog\'{e}nnym eksperimentom s kone\v{c}n\'{y}mi auto-matami}//
Mat.-Fyz.\ \v{C}as.\ Slovensk.\ Akad.\ Vied. 1964. V.14. P.208--216. [in Slovak]

\bibitem{Du98}
Dubuc, L.: Sur les automates circulaires et la conjecture de
\v{C}ern\'y. RAIRO Inform.\ Th\'eor.\ Appl. 32, 21--34 (1998) (in
French)

\bibitem{DM62}
\textsl{A.\,L.\,Dulmage, N.\,S.\,Mendelsohn}, The exponent of a primitive
matrix, Can.\ Math.\ Bull., 5 (1962), 241--244.

\bibitem{DM64}
\textsl{A.\,L.\,Dulmage, N.\,S.\,Mendelsohn}, Gaps in the exponent set of
primitive matrices, Ill.\ J. Math., 8 (1964), 642--656.

\bibitem{Ep90}
Eppstein, D.: Reset sequences for monotonic automata. SIAM J.
Comput. 19, 500--510 (1990)

\bibitem{FiciPribSakar10}
G. Fici, E. Pribavkina, J. Sakarovitch. \emph{On the Minimal Uncompletable Word Problem}, CoRR, http://arxiv.org/abs/1002.1928, 2010.

\bibitem{Gu11}
\textsl{V.\,Gusev}, Lower bounds for the length of reset words in {E}ulerian
automata, Reachability Problems, Lect.\ Notes Comput.\ Sci., 6945 (2011),
180--190.

\bibitem{Ka01}
Kari J., \emph{A counter example to a conjecture concerning synchronizing
words in finite automata}// Bull.\ European Assoc.\ Theor.\ Comput.\ Sci., 73
(2001), 146.

\bibitem{Ka03}
Kari, J.: Synchronizing finite automata on Eulerian digraphs.
Theoret.\ Comput.\ Sci. 295, 223--232 (2003)

\bibitem{Mart}
Martyugin, P.V.: Lower bounds for the length of the shortest carefully synchronizing
words for two- and three-letter partial automata. Diskretn. Anal. Issled. Oper., 15(4), 44--56 (2008)
(in Russian)

\bibitem{OlShDr02}
Olesky, D.D., Shader, B., van den Driessche, P.:
Exponents of tuples of nonnegative matrices. Linear Algebra Appl. 356,
123--134 (2002)

\bibitem{OU10}
\textsl{J.\,Olschewski, M.\,Ummels}, The complexity of finding reset words in
finite automata, Mathematical Foundations of Computer Science, Lect.\ Notes
Comput.\ Sci., 6281 (2010), 568--579.

\bibitem{Pi83}
Pin J.-E. \emph{On two combinatorial problems arising from automata theory}//
Ann. Discrete Math. 1983. V.{17}. P.535--548.

\bibitem{Prib09}
E. V. Pribavkina. \emph{Slowly synchronizing automata with zero and incomplete sets},
CoRR, http://arxiv.org/abs/0907.4576, 2009.

\bibitem{RaAl05}
\textsl{J.\,L.\,Ram\'{\i}rez Alfons\'{\i}n}, The diophantine Frobenius problem,
Oxford University Press, 2005.

\bibitem{RamSha09}
N.~Rampersad, J.~Shallit, Z.~Xu \emph{The computational complexity of universality problems
for prefxes, suffixes, factors, and subwords of regular languages}, CoRR,
http://arxiv.org/abs/0907.0159, 2009.

\bibitem{Rest81}
A.~Restivo. \emph{Some remarks on complete subsets of a free
monoid}, Quaderni de "La ricerca scientifica", CNR Roma
\textbf{ 109} (1981) 19--25.

\bibitem{Sa05}
Sandberg S. \emph{Homing and synchronizing sequences}//
В кн. M.~Broy et~al (eds.) Model-Based Testing of Reactive Systems, Lect.\ Notes Comput.\ Sci, Springer-Verlag, Berlin-Heidelberg-New York.
2005. V.{3472}. P.{5--33}.

\bibitem{ShSu03}
Shader, B.L., Suwilo, S.: Exponents of nonnegative matrix
pairs, Linear Algebra Appl. 363, 275--293 (2003)


\bibitem{Shen00}
Shen, J.: Exponents of 2-regular digraphs, Discrete Math. 214,
211--219 (2000)

\bibitem{ST11}
\textsl{E.\,Skvortsov, E.\,Tipikin}, Experimental study of the shortest reset
word of random automata, Implementation and Application  of Automata, Lect.\
Notes Comput.\ Sci., 6807 (2011), 290--298.

\bibitem{Steinberg:2011}
\textsl{B.\,Steinberg}, The \v{C}ern\'y conjecture for one-cluster automata
with prime length cycle, Theor.\ Comput.\ Sci., 412 (2011) 5487--5491.

\bibitem{Tr06}
\textsl{A.\,N.\,Trahtman}, An efficient algorithm finds noticeable trends and
examples concerning the \v{C}ern\'y conjecture, Mathematical Foundations of
Computer Science, Lect.\ Notes Comput.\ Sci., 4162 (2006), 789--800.

\bibitem{Tr06a}
\textsl{A.\,N.\,Trahtman}, Notable trends concerning the synchronization of
graphs and automata, Electr.\ Notes Discrete Math., 25 (2006), 173--175.

\bibitem{Tr07}
Trahtman, A.N.: The \v{C}ern\'y conjecture for aperiodic automata. Discrete
Math.\ Theor.\ Comput.\ Sci. 9(2), 3--10 (2007)

\bibitem{Tr09}
\textsl{A.\,N.\,Trahtman}, The Road Coloring Problem, Israel J. Math., 172
(2009), 51--60.

\bibitem{Tr11}
Trahtman, A. N. \emph{Modifying the upper bound on the length of minimal
synchronizing word}//,
В кн. O.\,Owe, M.\,Steffen, J.\,A.\,Telle (eds.), Fundamentals of Computation Theory. FCT 2012. Lect.\ Notes Comput.\
Sci., Springer Berlin Heidelberg. 2011. V.{6914}. P.{173--180}.

\bibitem{Vo08}
Volkov M. V. \emph{Synchronizing automata and the \v{C}ern\'y conjecture}//
В кн. C.\,Mart\'\i{}n-Vide, F.\,Otto, H.\,Fernau (eds.), Languages and
	Automata: Theory and Applications. LATA 2008, Lect.\ Notes Comp.\
	Sci., Springer-Verlag, Berlin-Heidelberg-New York. 2008. V.{5196}. P.{11--27}.

\bibitem{Vo09}
\textsl{M.\,V.\,Volkov}, Synchronizing automata preserving a chain of partial
orders, Theor.\ Comput.\ Sci., 410 (2009), 3513--3519.

\bibitem{Wi50}
\textsl{H.\,Wielandt}, Unzerlegbare, nicht negative Matrizen, Math.\ Z., 52,
(1950), 642--648 (in German).

\newpage
\bigskip
\centerline{\large\textbf{Работы автора по теме диссертации}}
\bigskip


\end{thebibliography}

\end{document}
