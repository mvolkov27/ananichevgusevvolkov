\documentclass[11pt]{article}
\usepackage{cite}
\usepackage{a4}
\usepackage{amsmath,amsfonts}
\usepackage{amssymb}
\usepackage{epic,gastex}
\usepackage{array}
\usepackage{amsthm}
\usepackage{hhline}
\usepackage{graphicx}

\usepackage[cp1251]{inputenc}
\usepackage[english,russian]{babel}

\newcommand{\sa}{synchronizing automata}
\newcommand{\san}{synchronizing automaton}
\newcommand{\sw}{reset word}
\newcommand{\sws}{reset words}
\newcommand{\ssw}{reset word of minimum length}
\newcommand{\rl}{reset length}

\DeclareMathOperator{\weight}{wg}

\DeclareSymbolFont{rsfscript}{OMS}{rsfs}{m}{n}
\DeclareSymbolFontAlphabet{\mathrsfs}{rsfscript}

\newcommand{\hm}[1]{#1\nobreak\discretionary{}{\hbox{\ensuremath{#1}}}{}}
\newcommand{\qqed}{\hfill$\Box$}

\newtheorem{theorem}{Теорема}
\newtheorem{cor}{Следствие}
\newtheorem{prop}{Предложение}
\newtheorem{lemma}{Лемма}

\renewenvironment{proof}{\trivlist\item[\hskip\labelsep{\bf
Доказательство}.] }{\qqed\endtrivlist}

\newtheorem{conjecture}{Гипотеза}

\begin{document}
\title{
\begin{flushleft}
{\normalsize УДК 519.713.4+519.172.3}
\end{flushleft}
Примитивные орграфы с большими экспонентами\\ и медленно синхронизируемые
автоматы\thanks{Предварительное сообщение о части результатов этой работы было
опубликовано в \cite{AGV10}.}}

\author{Д. С. Ананичев \and М. В. Волков \and В. В. Гусев\thanks{Авторы получали
поддержку РФФИ по гранту 10-01-793. Третий автор был также поддержан программой
Erasmus Mundus Action 2 Partnerships -- Triple I.}}

\date{}

\maketitle

\begin{abstract}
Мы приводим несколько бесконечных серий синхронизируемых автоматов, для каждого
из которых  длина кратчайшего синхронизирующего слова близка к квадрату числа
состояний. Все эти автоматы тесно связаны с примитивными ориентированными
графами с большой экспонентой.
\end{abstract}

\section*{{\centerline{\large\bf \S1. Постановка задачи и структура работы}}}

Данная работа выросла из попытки теоретически объяснить результаты некоторых
численных экспериментов по синхронизации конечных автоматов. Напомним, что
(\emph{детерминированным конечным}) \emph{автоматом} называется тройка
$\mathrsfs{A}=\langle Q,\Sigma,\delta\rangle$, где $Q$ -- конечное
\emph{множество состояний}, $\Sigma$ -- конечный \emph{входной алфавит}, а
$\delta:Q\times\Sigma\to Q$ -- всюду определенная \emph{функция переходов}. Как
обычно, через $\Sigma^*$ обозначаем множество всех конечных слов над алфавитом
$\Sigma$, включая пустое слово 1. Функция $\delta$ естественным образом
продолжается на $Q\times\Sigma^*$: для $q\in Q$ и $w\in\Sigma^*$ полагаем
$\delta(q,w)=q$, если $w=1$, и $\delta(q,w)=\delta(\delta(q,v),a)$, если $w=va$
для некоторого $v\in\Sigma^*$ и $a\in\Sigma$. Таким образом, функция $\delta$
определяет действие слов из $\Sigma^*$ на множестве $Q$.

Автомат $\mathrsfs{A}=\langle Q,\Sigma,\delta\rangle$ называется
\emph{синхронизируемым}, если найдется слово $w\in\Sigma^*$ под действием
которого все состояния переходят в одно: $\delta(q,w)=\delta(q',w)$ для всех
$q,q'\in Q$. Всякое такое слово $w$ называется \emph{синхронизирующим}. Минимум
длин синхронизирующих слов автомата $\mathrsfs{A}$ называется его \emph{порогом
синхронизации}.

Синхронизируемые автоматы представляют собой очень простую и естественную
модель систем, устойчивых к ошибкам. Они используются во многих прикладных
областях (тестирование систем и протоколов, кодирование информации, роботика) и
в то же время неожиданным образом возникают в некоторых разделах
фундаментальной математики (символическая динамика, теория подстановочных
систем и др.). Основы теории синхронизируемых автоматов и ее разнообразные
связи и приложения обсуждаются, например, в недавних обзорах~\cite{Sa05,Vo08}.
В данной работе затрагивается только один аспект этой теории, а именно, вопрос
о том, как зависит порог синхронизации автомата от числа его состояний.

Условимся для краткости называть автомат с $n$ состояниями
$n$-\emph{ав\-то\-ма\-том}. В~1964 г.\ Черни~\cite{Ce64} указал серию
синхронизируемых $n$-автоматов с порогом синхронизации $(n-1)^2$. Немного
позднее он высказал предположение, что автоматы из этой серии реализуют
наихудший (в смысле скорости синхронизации) случай, т.\,е. что каждый
синхронизируемый $n$-автомат может быть синхронизирован словом длины не более
$(n-1)^2$. За этим предположением закрепилось имя \emph{гипотеза Черни}.
Несмотря на простоту формулировки и усилия многочисленных исследователей,
гипотеза Черни остается недоказанной и неопровергнутой уже более 45 лет. Более
того, до сих пор нет верхней оценки порядка $\Theta(n^2)$ на порог
синхронизации произвольного $n$-автомата\footnote{На сегодняшний день лучшей
верхней оценкой на порог синхронизации произвольного $n$-автомата остается
оценка $\frac{n^3-n}6$, полученная Пэном~\cite{Pi83} еще в 1983 г. Чуть лучшая
оценка $\frac{n(7n^2+6n-16)}{48}$ опубликована недавно в~\cite{Tr11}, но в ее
доказательстве имеется неясное место.}.

Почему гипотеза Черни оказывается столь неприступной? Развернутое обсуждение
этого важного вопроса выходит за рамки данной работы, но одно из затруднений, с
которым приходится сталкиваться в теории синхронизируемых автоматов, здесь
уместно обозначить. Мы имеем в виду дефицит примеров \emph{экстремальных}
автоматов, т.\,е.\ $n$-автоматов с порогом синхронизации $(n-1)^2$. В
действительности, серия автоматов, приведенная Черни в~\cite{Ce64}, является
единственной известной на сегодня бесконечной серией экстремальных автоматов, а
кроме нее, известно лишь несколько спорадических примеров экстремальных
автоматов, наибольшим из которых по числу состояний является 6-автомат,
открытый Кари~\cite{Ka01} в 2001 г. (Полный список известных экстремальных
автоматов см.\ в~\cite{Vo08}.) Более того, до сих пор даже $n$-автоматы с
порогом синхронизации, близким к $(n-1)^2$, встречались в литературе крайне
редко -- кроме серии Черни, здесь можно назвать только серии из~\cite{AVZ}. В
условиях, когда число примеров крайне ограничено, трудно было подвергать
проверке различные предположения и допущения, возникавшие при поисках подходов
к гипотезе Черни. Именно поэтому история исследований в данной области богата
<<ложными следами>> -- вспомогательными гипотезами, которые сперва казались
перспективными, но по прошествии некоторого времени опровергались. (Ряд таких
<<ложных следов>> проанализирован в~\cite{Be11}.)

Как же находить медленно синхронизируемые автоматы? Эксперименты (см.,
например, \cite{ST11}) показывают, что взятый наугад автомат с вероятностью,
очень близкой к~1, синхронизируем словом, длина которого значительно меньше
числа состояний. Поэтому случайно натолкнуться на автомат, порог синхронизации
которого близок к квадрату числа состояний, невозможно. Приходится выявлять
такие автоматы путем исчерпывающего перебора. Именно такой переборный
эксперимент и послужил отправной точкой данной работы.

Методика и некоторые результаты эксперимента описаны в \S2. Наше внимание
привлекло сходство между наблюдаемым поведением количества синхронизируемых
автоматов с фиксированным числом состояний как функции от значения порога
синхронизации и хорошо изученным поведением количества примитивных орграфов с
фиксированным числом вершин как функции от значения экспоненты. В \S3 мы
обсуждаем это сходство, предварительно напомнив необходимые понятия и
результаты теории примитивных орграфов. Основные результаты работы содержатся в
\S4. Мы показываем, что медленно синхронизируемые автоматы, обнаруженные в
нашем эксперименте, являются представителями бесконечных серий таких автоматов
и что каждая такая серия тесно связана с некоторой известной серией примитивных
орграфов с большой экспонентой. Установленная связь между орграфами и
автоматами позволила дать прозрачные и единообразные доказательства утверждений
о пороге синхронизации для всех без исключения серий медленно синхронизируемых
автоматов -- как для серий, уже встречавшихся в литературе, так и для серий,
впервые появившихся в данной работе. Техника, примененная в этих
доказательствах, насколько нам известно, является новой и, на наш взгляд,
представляет самостоятельный интерес. В заключительном \S5 обсуждаются
дальнейшие перспективы подхода, развитого в работе, и формулируется ряд новых
гипотез.

\section*{{\centerline{\large\bf \S2. Методика и некоторые результаты эксперимента}}}

Как отмечено в \S1, поиск автоматов с порогом синхронизации, близким к квадрату
числа состояний, требует исчерпывающего перебора. Поскольку число $n$-автоматов
стремительно растет с ростом $n$, такой перебор должен быть разумным образом
организован. Так, задание 9-автомата с двумя входными буквами равносильно
заданию пары функций на 9-элементном множестве. Число таких пар равно
$9^{18}\approx 1.50\times 10^{17}$, и если потратить на вычисление порога
синхронизации каждого заданного таким образом автомата одну наносекунду, то
полный перебор займет около пяти лет. Понятно, что при задании $n$-автоматов с
$k$ входными буквами наборами из $k$ функций на $n$-элементном множестве каждый
автомат будет порождаться $n!k!$ раз. Однако ускорить процесс перебора за счет
отбрасывания изоморфных автоматов невозможно -- даже при $n=9$ и $k=2$ на
проверку того, изоморфен ли очередной автомат какому-либо из уже просмотренных,
не хватит ни времени, ни памяти.

Мы использовали для оптимизации перебора строковое представление достижимых
автоматов, предложенное в~\cite{AMR}. Напомним, что автомат
$\mathrsfs{A}=\langle Q,\Sigma,\delta\rangle$ называется \emph{достижимым} (из
состояния $q_0$), если из $q_0$ можно попасть в любое наперед заданное
состояние, применив подходящее слово: для любого $q\in Q$ существует
$w\in\Sigma^*$ такое, что $q=\delta(q_0,w)$. Автомат, достижимый из каждого
своего состояния, называется \emph{сильно связным}. В общем случае
синхронизируемый автомат может не быть достижимым и тем более сильно связным.
Однако хорошо известно, что в рассмотрениях, связанных с гипотезой Черни, можно
ограничиться сильно связными автоматами. Дело в том, что имеет место следующий
несложный результат.
\begin{prop}[\!\!{\mdseries\cite[предложение~2.1]{Vo09}}]
\label{reduction} Пусть $\mathrsfs{A}=\langle Q,\Sigma,\delta\rangle$ --
синхронизируемый автомат, а $S$ -- множество тех состояний, к которым
$\mathrsfs{A}$ можно синхронизировать. Тогда $\mathrsfs{S}=\langle
S,\Sigma,\delta|_S\rangle$ -- сильно связный подавтомат в $\mathrsfs{A}$ и  для
любой функции $f:\mathbb{Z}^+\to\mathbb{N}$, удовлетворяющей неравенствам
$$f(n)\ge\frac{n(n-1)}2\ \text{ и }\ f(n)\ge f(n-m+1)+f(m) \text{ при } n\ge m\ge 1,$$
из того, что порог синхронизации автомата $\mathrsfs{S}$
ограничен числом $f(|S|)$, вытекает, что порог синхронизации для $\mathrsfs{A}$
не превосходит $f(|Q|)$.
\end{prop}
В частности, беря в качестве функции $f(n)$ функцию $(n-1)^2$, можно заключить,
что если $\mathrsfs{A}$ -- контрпример к гипотезе Черни, то и его сильно
связный подавтомат $\mathrsfs{S}$ необходимо будет контрпримером. Аналогично,
если $\mathrsfs{A}$ -- медленно синхронизируемый автомат, т.\,е.\ автомат с
порогом синхронизации, близким к квадрату числа состояний, то таков и сильно
связный автомат $\mathrsfs{S}$. Таким образом, ограничивая перебор достижимыми
автоматами, мы не рискуем пропустить контрпример к~гипотезе Черни или
какой-нибудь интересный медленно синхронизируемый автомат.

Опишем теперь строковое представление из~\cite{AMR}. Пусть $\mathrsfs{A} =
\langle Q, \Sigma, \delta\rangle$ -- автомат, достижимый из состояния $q_0$.
Зафиксируем некоторый линейный порядок на входном алфавите $\Sigma$ и обойдем
автомат поиском в ширину из $q_0$, выбирая исходящие переходы в соответствии с
этим порядком. Присвоим состоянию $q_0$ номер 0, а остальные состояния из $Q$
пронумеруем в порядке их посещения при указанном обходе. Например, состояния
автомата на рис.~\ref{fig:AMR} при алфавитном упорядочении входных букв $a<b<c$
и выборе состояния $A$ в качестве $q_0$ будут пронумерованы так:
\begin{tabular}{c|c|c|c}
$A$ & $B$ & $C$ & $D$\\
\hline 0 & 2 & 1& 3\end{tabular}\,.

\begin{figure}[ht]
\begin{center}
\unitlength .8mm
\begin{picture}(84,45)(0,-60)
\gasset{Nw=11.0,Nh=11.0,Nmr=5.5}
\node[iangle=90.0,ilength=6.0,Nmarks=i](n1)(23.99,-24.0){$A$}
\node(n2)(60.49,-24.25){$C$} \node(n3)(59.9,-56.18){$D$}
\node(n6)(25.06,-56.08){$B$} \drawloop[loopangle=180.0](n1){$c$}
\drawloop[loopangle=0.0](n3){$b$} \drawloop[loopangle=180.0](n6){$c$}
\drawedge[curvedepth=3.6](n1,n2){$a$} \drawedge[curvedepth=3.6](n2,n1){$c$}
\drawedge[ELside=r,curvedepth=-3.6](n3,n2){$a$}
\drawedge[ELside=r,curvedepth=-3.6](n2,n3){$b$}
\drawedge[ELside=r,curvedepth=-3.6](n6,n1){$b$}
\drawedge[ELside=r,curvedepth=-3.6](n1,n6){$b$}
\drawedge[curvedepth=3.6](n6,n3){$a$} \drawedge[curvedepth=3.6](n3,n6){$c$}
\drawedge(n2,n6){$a$}
\end{picture}
\caption{Автомат с канонической строкой
$[1,2,0,2,3,0,3,0,2,1,3,2]$}\label{fig:AMR}
\end{center}
\end{figure}

\noindent Каждому состоянию $q$ автомата $\mathrsfs{A}$ сопоставим строку длины
$|\Sigma|$, в которой на позиции $i$ стоит порядковый номер того состояния, в
которое $q$ переходит под действием $i$-й буквы. Соединив все такие строки в
порядке возрастания номеров состояний, получим строку чисел из множества
$\{0,1,\dots,|Q|-1\}$, которая имеет длину $|Q||\Sigma|$ и однозначно
определяет $\mathrsfs{A}$. Мы будем называть ее \emph{канонической строкой}
автомата $\mathrsfs{A}$. Так, для автомата на рис.~\ref{fig:AMR} каноническая
строка имеет вид $[1,2,0,2,3,0,3,0,2,1,3,2]$.

Несложно проверить (см.~\cite[теорема~5]{AMR}), что строка
$[s_0,\dots,s_{nk-1}]$ чисел из множества $\{0,1,\dots,n-1\}$ будет
канонической строкой некоторого достижимого $n$-автомата с $k$ входными буквами
тогда и только тогда, когда она удовлетворяет двум условиям:
\begin{enumerate}
\item[(R1)] для каждого $i$ такого, что $s_i>1$, найдется такое $j<i$, что $s_j = s_i-1$,
\item[(R2)] для каждого $m$ такого, что $1\le m<n$, найдется такое $j<mk$,
что $s_j=m$.
\end{enumerate}

Опираясь на это наблюдение, мы вычисляли пороги синхронизации для достижимых
$n$-автоматов с двумя входными буквами следующим образом. Для вычислений
использовался 128-ядерный кластер на базе процессоров AMD Opteron с тактовой
частотой 2.6 ГГц. Кластер, принадлежащий Институту математики и механики УрО
РАН, работает под управлением ОС Linux, имеет 256 ГБ оперативной памяти и
пиковую производительность 665.6 Гфлопс. Один узел кластера генерировал
относительно небольшие порции строк, удовлетворяющих (R1) и (R2), и раздавал
остальным узлам, которые обрабатывали соответствующие порции автоматов
параллельно. Для организации данного процесса использовалась известная
библиотека MPI. Проверка каждого автомата на синхронизируемость и вычисление
порога синхронизации производились с помощью стандартных алгоритмов
(см.~\cite{Sa05,Vo08}). Оба этих алгоритма были реализованы на C. Отметим, что
алгоритм проверки синхронизируемости очень быстр, так как работает с орграфом
пар состояний, в то время как алгоритм вычисления порога синхронизации работает
с орграфом непустых подмножеств состояний и в наихудшем случае время его работы
экспоненциально зависит от размера исходного автомата\footnote{Известно
(см.~\cite[теорема~4]{OU10}), что задача вычисления порога синхронизации
данного автомата полна для класса сложности $\mathsf{FP}^\mathsf{NP[log]}$ --
функционального аналога класса $\mathsf{P}^\mathsf{NP[log]}$ задач
распознавания, разрешимых за полиномиальное время на детерминированной машине
Тьюринга, которая может логарифмическое от размера задачи число раз обращаться
за подсказкой к оракулу для $\mathsf{NP}$-полной задачи.}. Однако на практике
порог синхронизации вычисляется довольно быстро, поскольку, как отмечалось в
\S1, для подавляющего большинства автоматов он мал.

Хотя задание автоматов с помощью канонических строк существенным образом
сокращает перебор (нетрудно понять, например, что при таком задании каждый
$n$-автомат с двумя входными буквами порождается не более $2n$ раз), его объем
все равно остается значительным. Так, при $n=9$ число автоматов, которые
пришлось проанализировать, составило 705\,068\,085\,303.  Тем не менее,
благодаря распараллеливанию, вычисления при $n=9$ заняли меньше суток.

Результатом вычислений являлся массив, в котором для каждого встретившегося
значения порога синхронизации указывалось число автоматов, реализующих это
значение. Наиболее значимая для нас часть результатов, относящаяся к медленно
синхронизируемым автоматам, была затем перепроверена с помощью пакета
TESTAS~\cite{Tr06}.

Табл.~\ref{automata} содержит фрагмент массива результатов, полученных в случае
$n=9$. Количество автоматов в ней указано с точностью до изоморфизма.
\begin{table}[ht]
\extrarowheight=1pt \tabcolsep=4.9pt \caption{Пороги синхронизации 9-автоматов
с двумя входными буквами} \label{automata} {\small
\begin{tabular}{|p{2.9cm}||c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
\hline
\centering{$N$} & 64 & 63 & 62 & 61 & 60 & 59 & 58 & 57 & 56 & 55 & 54 & 53 & 52 & 51 \\
\hline \raggedright{Число автоматов с порогом синхронизации $N$}
&\raisebox{-11pt}{1} &\raisebox{-11pt}{0} &\raisebox{-11pt}{0}
&\raisebox{-11pt}{0} &\raisebox{-11pt}{0} &\raisebox{-11pt}{0}
&\raisebox{-11pt}{1} &\raisebox{-11pt}{2} &\raisebox{-11pt}{3}
&\raisebox{-11pt}{0} &\raisebox{-11pt}{0} &\raisebox{-11pt}{0}
&\raisebox{-11pt}{4} &\raisebox{-11pt}{4} \\
\hline
\end{tabular}}
\end{table}

Понятно, что единственный автомат в столбце, отвечающем $N=64$, -- это
9-автомат из серии Черни. Далее наблюдается разрыв: 9-автоматов с двумя
входными буквами и значением порога синхронизации от 59 до 63 не существует.
Данный разрыв уже упоминался в работах Трахтмана~\cite{Tr06,Tr06a}, где
отмечалось, что при $n=7,8,9,10$ его эксперименты не обнаружили ни одного
$n$-автомата с двумя входными буквами, порог синхронизации которого был бы
больше $n^2-3n+4$, но меньше $n^2-2n-1$. За разрывом следует <<остров>> из трех
значений, достигаемых на 6 автоматах, а за этим <<островом>> снова наблюдается
разрыв. Этот второй разрыв, насколько нам известно, ранее не отмечался в
литературе.

Описанное только что поведение исследуемой величины -- одинокое экстремальное
значение, за которым следуют разрыв, небольшой <<остров>> и еще один разрыв --
проявляется и для автоматов с б\'ольшим числом состояний. При этом размеры
<<острова>> зависят только от четности числа состояний, а размеры разрывов
растут вместе c числом состояний как линейные функции. Сходным образом ведет
себя другая величина, исследовавшаяся в дискретной математике, -- количество
примитивных орграфов с фиксированным числом вершин и данным значением
экспоненты. В следующем параграфе мы напомним соответствующие понятия и обсудим
указанное сходство подробнее.

\section*{{\centerline{\large\bf \S3. Примитивные орграфы и их экспоненты}}}

\emph{Орграф} (т.\,е. ориентированный граф) -- это пара $D=\langle V,E\rangle$,
где $V$ -- конечное множество и $E\subseteq V\times V$. Элементы множеств $V$ и
$E$ будем называть соответственно \emph{вершинами} и \emph{дугами}. Отметим,
что данное определение допускает петли, но исключает кратные дуги. Если
$v,v'\in V$ и $e=(v,v')\in E$, то дуга $e$ называется \emph{исходящей} из $v$.
Мы предполагаем, что читатель знаком с основными понятиями теории орграфов,
такими как маршрут (ориентированный путь), контур (ориентированный цикл),
изоморфизм и~т.\,д.

\emph{Матрица смежности} (или просто матрица) орграфа $D=\langle V,E\rangle$ --
это $V\times V$-матрица, в которой элемент в строке $v$ и столбце $v'$ равен 1,
если $(v,v')\in E$, и равен 0 в противном случае. Обратно, $n\times n$-матрице
$P=(p_{ij})$ с неотрицательными действительными элементами можно сопоставить
орграф $D(P)$ на множестве $\{1,2,\dots,n\}$, в котором пара $(i,j)$ будет
дугой, если и только если $p_{ij}>0$. Указанное соответствие между матрицами и
орграфами позволяет переформулировать на языке орграфов ряд важных понятий и
результатов, возникших в классической теории неотрицательных матриц (теории
Перрона--Фробениуса).

Орграф $D=\langle V,E\rangle$ называется  \emph{сильно связным}, если для
всякой пары $(v,v')\in V\times V$ найдется маршрут из $v$ в $v'$. Сильно
связный орграф $D$ называется \emph{примитивным}, если наибольший общий
делитель длин всех контуров в $D$ равен~1. В литературе такие орграфы иногда
называют \emph{апериодическими}. Наш выбор термина обусловлен тем, что орграф
обладает указанным свойством тогда и только тогда, когда его матрица примитивна
в смысле теории Перрона--Фробениуса, т.\,е.\ когда у этой матрицы есть
положительное собственное значение, строго большее модуля любого из ее
остальных собственных значений.

Под $t$-й \emph{степенью} орграфа $D=\langle V,E\rangle$ понимается орграф
$D^t$ с тем же множеством вершин $V$, в котором $(v,v')\in V\times V$ является
дугой, если и только если в $D$ найдется маршрут из $v$ в $v'$ длины в точности
$t$. Нетрудно видеть, что если $M$ -- матрица орграфа $D$, то орграф $D^t$
изоморфен орграфу $D(M^t)$, где $M^t$ -- обычная $t$-я степень матрицы $M$.
Известно (см., например, \cite[с.\,226]{ST00}), что если $D$ -- примитивный
орграф, то для некоторого $t$ его степень $D^t$ есть полный орграф с петлями,
т.\,е.\ в $D^t$ все пары вершин являются дугами. На языке матрицы орграфа это
означает, что каждый элемент матрицы $M^t$ положителен. Наименьшее число $t$ с
таким свойством называется \emph{экспонентой} орграфа $D$ и обозначается через
$\gamma(D)$. Экспоненты орграфов служат объектом интенсивного изучения на
протяжении последних 50 лет, обзор накопленных в этой области фактов см.,
например, в~\cite{Br}. В данной работе потребуются лишь несколько классических
результатов, собранных в следующем утверждении. В нем (и далее в работе) орграф
с $n$ вершинами для краткости назван $n$-\emph{орграфом}.

\begin{theorem}
\label{dulmage} \emph{(a) (Теорема Виландта, см.\ \cite{Wi50,DM62,DM64})} Если
$D$ -- примитивный $n$-орграф, то $\gamma(D)\le(n-1)^2+1$.

\emph{(b) \cite[теорема~6 и следствие~4]{DM64}} Если $n>2$, то с точностью до
изоморфизма есть ровно один примитивный $n$-орграф с экспонентой $(n-1)^2+1$ и
ровно один примитивный $n$-орграф с с экспонентой $(n-1)^2$. Матрицы этих
орграфов суть соответственно
\begin{equation}
\label{wielandt}
\begin{pmatrix}
0 & 1 & 0 & \dots & 0 & 0\\
0 & 0 & 1 & \dots & 0 & 0\\
\hdotsfor{6}\\
0 & 0 & 0 & \dots & 0 & 1\\
1 & 1 & 0 & \dots & 0 & 0
\end{pmatrix} \text{ и }
\begin{pmatrix}
0 & 1 & 0 & \dots & 0 & 0\\
0 & 0 & 1 & \dots & 0 & 0\\
\hdotsfor{6}\\
1 & 0 & 0 & \dots & 0 & 1\\
1 & 1 & 0 & \dots & 0 & 0
\end{pmatrix}.
\end{equation}

\emph{(c) \cite[теорема~7]{DM64}} Если $n>4$ и $n$ четно, то нет ни одного
примитивного $n$-орграфа $D$, для которого $n^2-4n+6<\gamma(D)<(n-1)^2$. С
точностью до изоморфизма существуют ровно три, если $n$ кратно трем, или ровно
четыре, если $n$ не кратно трем, примитивных $n$-орграфа с экспонентой
$n^2-4n+6$.

\emph{(d) \cite[теорема~8]{DM64}} Если $n>3$ и $n$ нечетно, то нет ни одного
примитивного $n$-орграфа $D$, для которого $n^2-3n+4<\gamma(D)<(n-1)^2$. С
точностью до изоморфизма есть ровно один примитивный $n$-орграф с экспонентой
$n^2-3n+4$, ровно один примитивный $n$-орграф с экспонентой $n^2-3n+3$, и ровно
два примитивных $n$-орграфа с экспонентой $n^2-3n+2$. Матрицы этих орграфов
суть соответственно
\begin{gather}
\label{odd island}
\begin{pmatrix}
0 & 1 & 0 & \dots & 0 & 0\\
0 & 0 & 1 & \dots & 0 & 0\\
\hdotsfor{6}\\
0 & 0 & 0 & \dots & 1 & 0\\
0 & 0 & 0 & \dots & 0 & 1\\
1 & 0 & 1 & \dots & 0 & 0
\end{pmatrix},\quad
\begin{pmatrix}
0 & 1 & 0 & \dots & 0 & 0\\
0 & 0 & 1 & \dots & 0 & 0\\
\hdotsfor{6}\\
0 & 0 & 0 & \dots & 1 & 0\\
0 & 1 & 0 & \dots & 0 & 1\\
1 & 0 & 1 & \dots & 0 & 0
\end{pmatrix},\\
\begin{pmatrix}
0 & 1 & 0 & \dots & 0 & 0\\
0 & 0 & 1 & \dots & 0 & 0\\
\hdotsfor{6}\\
1 & 0 & 0 & \dots & 1 & 0\\
0 & 1 & 0 & \dots & 0 & 1\\
1 & 0 & 1 & \dots & 0 & 0
\end{pmatrix}, \quad
\begin{pmatrix}
0 & 1 & 0 & \dots & 0 & 0\\
0 & 0 & 1 & \dots & 0 & 0\\
\hdotsfor{6}\\
1 & 0 & 0 & \dots & 1 & 0\\
0 & 0 & 0 & \dots & 0 & 1\\
1 & 0 & 1 & \dots & 0 & 0
\end{pmatrix}.
\end{gather}

\emph{(e) \cite[теорема~8]{DM64}} Если $n>3$ и $n$ нечетно, то нет ни одного
$n$-орграфа $D$, для которого $n^2-4n+6<\gamma(D)<n^2-3n+2$. С точностью до
изоморфизма существуют ровно три, если $n$ кратно трем, или ровно четыре, если
$n$ не кратно трем, примитивных $n$-орграфа с экспонентой $n^2-4n+6$.
\end{theorem}

В табл.~\ref{9 states} экспериментальные данные из табл.~\ref{automata},
сопоставлены с информацией, которую можно извлечь из теоремы~\ref{dulmage}.

\begin{table}[ht]
\tabcolsep=4.2pt \extrarowheight=1pt \caption{Экспоненты примитивных 9-орграфов
и пороги синхронизации 9-автоматов с двумя входными буквами} \label{9 states}
{\small
\begin{tabular}{|p{2.9cm}||c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|} \hline
\centering{$N$} & 65 & 64 & 63 & 62 & 61 & 60 & 59 & 58 & 57 & 56 & 55 & 54 & 53 & 52 & 51 \\
\hline \raggedright{Число орграфов с~экспонентой $N$} & \raisebox{-6pt}{1} &
\raisebox{-6pt}{1} & \raisebox{-6pt}{0} & \raisebox{-6pt}{0} &
\raisebox{-6pt}{0} & \raisebox{-6pt}{0} & \raisebox{-6pt}{0} &
\raisebox{-6pt}{1} & \raisebox{-6pt}{1} & \raisebox{-6pt}{2}
& \raisebox{-6pt}{0} & \raisebox{-6pt}{0} & \raisebox{-6pt}{0} & \raisebox{-6pt}{0} & \raisebox{-6pt}{4} \\
\hline \raggedright{Число автоматов с порогом синхронизации $N$}
&\raisebox{-11pt}{0} &\raisebox{-11pt}{1} &\raisebox{-11pt}{0}
&\raisebox{-11pt}{0} &\raisebox{-11pt}{0} &\raisebox{-11pt}{0}
&\raisebox{-11pt}{0} &\raisebox{-11pt}{1} &\raisebox{-11pt}{2}
&\raisebox{-11pt}{3}
&\raisebox{-11pt}{0} &\raisebox{-11pt}{0} &\raisebox{-11pt}{0} &\raisebox{-11pt}{4} &\raisebox{-11pt}{4} \\
\hline
\end{tabular}}
\end{table}

Сходство между второй и третьей строками табл.~\ref{9 states} очевидно.
Аналогичное сходство проявляется при сравнении данных для других размеров
автоматов/орграфов. Нам представляется, что обнаруженное сходство не случайно,
а напротив, отражает глубокие и, возможно, еще не до конца проясненные
взаимосвязи между примитивными орграфами и синхронизируемыми автоматами.
Некоторые из этих взаимосвязей были вскрыты при изучении так называемой
проблемы раскраски дорог. Напомним соответствующие понятия.

\emph{Орграфом} автомата $\mathrsfs{A}=\langle Q,\Sigma,\delta\rangle$ будем
называть орграф $D(\mathrsfs{A})$ со множеством вершин $Q$, в котором дугами
служат все такие пары $(q,q')\in Q\times Q$, что $q'=\delta(q,a)$ для некоторой
буквы $a\in\Sigma$. Легко видеть, что орграф $D$ изоморфен орграфу некоторого
автомата тогда и только тогда, когда любая вершина $D$ имеет хотя бы одну
исходящую дугу. В дальнейшем мы всегда будем предполагать, что рассматриваемые
орграфы удовлетворяют этому условию. Если $D$ -- орграф, то его
\emph{раскраской} называется всякий автомат $\mathrsfs{A}$ со свойством $D\cong
D(\mathrsfs{A})$. Любая раскраска орграфа $D=\langle V,E\rangle$ получается,
если зафиксировать некоторый конечный алфавит $\Sigma$ и приписать каждой дуге
из $E$ непустое множество букв из $\Sigma$ так, чтобы для каждой вершины $v\in
V$ множества, приписанные исходящим из $v$ дугам, составляли разбиение алфавита
$\Sigma$. На рис.\,\ref{fig:cerny} изображен орграф и две его раскраски при
помощи алфавита $\Sigma=\{a,b\}$.

\begin{figure}[ht]
 \begin{center}
  \unitlength=2.8pt
    \begin{picture}(18,30)(-65,-4)
    \gasset{Nw=6,Nh=6,Nmr=3}
    \node(A1)(0,18){$1$}
    \node(A2)(18,18){$2$}
    \node(A3)(18,0){$3$}
    \node(A4)(0,0){$4$}
    \drawloop[loopangle=135](A1){$a$}
    \drawloop[loopangle=45](A2){$b$}
    \drawloop[loopangle=-45](A3){$b$}
    \drawedge(A1,A2){$b$}
    \drawedge(A2,A3){$a$}
    \drawedge(A3,A4){$a$}
    \drawedge(A4,A1){$a,b$}
    \end{picture}
 \begin{picture}(18,30)(0,-4)
    \gasset{Nw=6,Nh=6,Nmr=3}
    \node(A1)(0,18){$1$}
    \node(A2)(18,18){$2$}
    \node(A3)(18,0){$3$}
    \node(A4)(0,0){$4$}
    \drawloop[loopangle=135](A1){$a$}
    \drawloop[loopangle=45](A2){$a$}
    \drawloop[loopangle=-45](A3){$a$}
    \drawedge(A1,A2){$b$}
    \drawedge(A2,A3){$b$}
    \drawedge(A3,A4){$b$}
    \drawedge(A4,A1){$a,b$}
    \end{picture}
 \begin{picture}(18,30)(65,-4)
    \gasset{Nw=6,Nh=6,Nmr=3}
    \node(A1)(0,18){$1$}
    \node(A2)(18,18){$2$}
    \node(A3)(18,0){$3$}
    \node(A4)(0,0){$4$}
    \drawloop[loopangle=135](A1){}
    \drawloop[loopangle=45](A2){}
    \drawloop[loopangle=-45](A3){}
    \drawedge(A1,A2){}
    \drawedge(A2,A3){}
    \drawedge(A3,A4){}
    \drawedge(A4,A1){}
    \end{picture}
 \end{center}
 \caption{Орграф и две его раскраски}
 \label{fig:cerny}
\end{figure}

Еще в 1977 г.\ Адлер, Гудвин и Вейс~\cite{AGW} отметили, что орграф каждого
сильно связного синхронизируемого автомата примитивен, и предположили,  что
каждый примитивный орграф имеет синхронизируемую раскраску -- в этом и состояла
гипотеза раскраски дорог, недавно доказанная Трахтманом~\cite{Tr09}. Нетрудно
указать и соотношение между порогом синхронизации сильно связного
синхронизируемого автомата и экспонентой его орграфа.

\begin{prop}
\label{lower bound} Пусть $\mathrsfs{A}=\langle Q,\Sigma,\delta\rangle$ --
сильно связный синхронизируемый $n$-автомат с порогом синхронизации $t$. Тогда
\begin{equation}
\label{eq:lower bound} \gamma(D(\mathrsfs{A}))\le t+n-1.
\end{equation}
\end{prop}

\begin{proof}
Пусть $w\in\Sigma^*$ -- синхронизирующее слово длины $t$ и пусть $p$ -- то
состояние, к которому $w$ синхронизирует автомат $\mathrsfs{A}$, т.\,е.
$\delta(q,w)=p$ для всех $q\in Q$. Возьмем теперь произвольную пару
$(q',q'')\in Q\times Q$ и укажем в орграфе $D(\mathrsfs{A})$ маршрут из $q'$ в
$q''$ длины в точности $t+n-1$. Поскольку орграф $D(\mathrsfs{A})$ сильно
связный, в нем существует маршрут из $p$ в $q''$. Пусть $\ell$ -- минимальная
длина такого маршрута. Так как маршрут минимальный длины не проходит ни через
одну вершину дважды, $\ell\le n-1$. Рассмотрим теперь произвольный маршрут
длины $n-1-\ell$, начинающийся из $q'$. Из конечной вершины этого маршрута
пройдем по маршруту длины $t$, вдоль которого в автомате $\mathrsfs{A}$
читается слово $w$. Поскольку $w$ -- синхронизирующее слово, такой маршрут
необходимо окончится в $p$. Теперь осталось пройти по маршруту  длины $\ell$ из
$p$ в $q''$, чтобы получить маршрут из $q'$ в $q''$ длины
$(n-1-\ell)+t+\ell=t+n-1$.
\end{proof}

Таким образом, раскраски примитивных орграфов с~большими экспонентами приводят
к автоматам с большими порогами синхронизации. Это наблюдение, однако, еще не
достаточно для того, чтобы полностью объяснить сходство между строками
табл.~\ref{9 states}, поскольку далеко не все автоматы, отвечающие ненулевым
позициям в третьей строке, могут быть получены как раскраски примитивных
орграфов с~большими экспонентами. В \S4 мы укажем еще один способ получения
медленно синхронизируемых автоматов из примитивных орграфов.

\section*{{\centerline{\large\bf \S4. Серии медленно синхронизируемых автоматов}}}

\paragraph*{4.1. Обзор.} Обсудим прежде всего, какими именно автоматами мы
интересуемся, другими словами, какой точный смысл вкладывается в выражения типа
<<медленно синхронизируемые автоматы>> или <<автоматы, с порогом синхронизации,
близким к квадрату числа состояний>>. Как отмечалось в \S1, порог синхронизации
$n$-автомата может достигать $(n-1)^2$ -- соответствующим примером служит
открытый Черни~\cite{Ce64} автомат $\mathrsfs{C}_n=\langle
\{1,2,\dots,n\},\{a,b\},\delta\rangle$, где буквы $a$ и $b$ действуют следующим
образом:
$$\delta(i,a)=\begin{cases}
i, &\text{если } i<n,\\
1, &\text{если } i=n;
\end{cases}\quad
\delta(i,b)=\begin{cases}
i+1, &\text{если } i<n,\\
1, &\text{если } i=n.
\end{cases}$$
Автомат $\mathrsfs{C}_n$ изображен слева на рис.\,\ref{fig:cerny-n} ниже.
Нетрудно понять, что если к автомату $\mathrsfs{C}_{n-1}$ добавить новое
состояние $q_0$, а затем всевозможными способами доопределять действие букв $a$
и $b$ на этом новом состоянии так, чтобы хотя бы одна из них не фиксировала
$q_0$, то можно получить $n^2-1$ неизоморфных достижимых $n$-автоматов с
порогом синхронизации от $(n-2)^2$ до $(n-2)^2+1$. Аналогичным образом можно
<<размножать>> до семейств $n$-автоматов и другие $(n-1)$-автоматы с порогом
синхронизации, близким к $(n-2)^2$. Поскольку мы хотим избежать рассмотрения
таких более или менее тривиальных модификаций, наше внимание сосредоточено на
$n$-автоматах с порогом синхронизации, заключенным в пределах от $(n-2)^2+2$ до
$(n-1)^2$. (В частности, именно из этих соображений выбирался диапазон значений
порога синхронизации в табл.~\ref{automata} и~\ref{9 states}.)

Наши эксперименты показывают, что в указанных пределах автоматов не слишком
много и что их распределение по возможным значениям порога синхронизации
устойчиво следует такому образцу: изолированное экстремальное значение --
разрыв -- небольшой <<остров>> -- разрыв -- <<материк>>, см.
табл.~\ref{automata} и обсуждение в конце \S2. Мы продемонстрируем, что исходя
из примитивных орграфов с большими экспонентами, представленных в
теореме~\ref{dulmage}, можно построить следующие серии автоматов над
двухбуквенным алфавитом:
\begin{itemize}
\item серию $\mathrsfs{C}_n$, отвечающую экстремальному значению;
\item серии $\mathrsfs{W}_n$, $\mathrsfs{D}'_n$, $\mathrsfs{D}''_n$,
$\mathrsfs{E}_n$, а при нечетном $n$ -- еще и серии $\mathrsfs{B}_n$ и
$\mathrsfs{F}_n$, отвечающие <<островным>> значениям;
\item серии $\mathrsfs{G}_n$ (при нечетном $n$) и $\mathrsfs{H}_n$,
отвечающие максимальным <<материковым>> значениям.
\end{itemize}
Рис.~\ref{fig:relation} показывает, из каких именно орграфов получаются
перечисленные серии. (Для наглядности на рис.~\ref{fig:relation} вместо матриц
из теоремы~\ref{dulmage} изображены <<типичные представители>> соответствующих
серий орграфов.) Если от символа орграфа к букве, обозначающей серию автоматов,
проведена сплошная стрелка, то автоматы серии получены раскраской
соответствующих орграфов; штриховая стрелка указывает на другой способ
получения автомата из орграфа. Пунктирной рамкой объединены серии автоматов с
одинаковым значением порога синхронизации.
\begin{figure}[h]
\begin{center}
\includegraphics[width=12cm]{relation.eps}
\unitlength 0.86mm
\begin{picture}(1,1)(2,0)
\put(-132,45){\Large{$\mathrsfs{C}_n$}}
\put(-106,45){\Large{$\mathrsfs{D}'_n$}} \put(-92,45){\Large{$\mathrsfs{W}_n$}}
\put(-84,45){\Large{$\mathrsfs{F}_n$}} \put(-71,45){\Large{$\mathrsfs{E}_n$}}
\put(-64,45){\Large{$\mathrsfs{D}''_n$}} \put(-54,45){\Large{$\mathrsfs{B}_n$}}
\put(-23,45){\Large{$\mathrsfs{G}_n$}} \put(-10,45){\Large{$\mathrsfs{H}_n$}}
\put(-118, 47){\Large{$\dots$}} \put(-38, 47){\Large{$\dots$}}
\end{picture}
\caption{Связи между сериями примитивных орграфов с большими экспонентами и
сериями медленно синхронизируемых автоматов} \label{fig:relation}
\end{center}
\end{figure}

Итак, здесь мы докажем ряд утверждений о перечисленных на
рис.~\ref{fig:relation} сериях автоматов. (Два из этих утверждений -- о сериях
$\mathrsfs{C}_n$ и $\mathrsfs{B}_n$ -- встречались в литературе, но наши
доказательства являются новыми.) Эти результаты будут объединены в 5 групп в
соответствии с <<происхождением>> серий, т.\,е.\ по типу орграфов, из которых
получены автоматы серий.

\paragraph*{4.2. Автоматы, связанные с орграфами серии $W_n$.} Орграф $W_n$ -- это
$n$-орграф наибольшей экспоненты, отвечающий первой матрице в~\eqref{wielandt}.
Если обозначить вершины $W_n$ через $1,2,\dots,n$, то его дуги суть $(n,1)$,
$(n,2)$ и $(i,i+1)$ для $i=1,\dots,n-1$. Нетрудно видеть, что с точностью до
изоморфизма и переименования букв существует единственная раскраска орграфа
$W_n$ с помощью двух букв. Обозначим соответствующий автомат через
$\mathrsfs{W}_n$. Орграф $W_n$ и автомат $\mathrsfs{W}_n$ изображены на
рис.\,\ref{fig:anan}.

\begin{figure}[hb]
\begin{center}
\unitlength .5mm
\begin{picture}(72,60)(20,-67)
\gasset{Nw=16,Nh=16,Nmr=8} \node(n0)(36.0,-16.0){1} \node(n1)(4.0,-40.0){$n$}
\node(n2)(68.0,-40.0){2} \node(n3)(16.0,-72.0){$n{-}1$}
\node(n4)(56.0,-72.0){3} \drawedge[ELdist=2.0](n1,n0){}
\drawedge[ELdist=1.5](n2,n4){} \drawedge[ELdist=1.7](n0,n2){}
\drawedge[ELdist=1.7](n3,n1){} \drawedge[ELdist=2.0](n1,n2){}
\put(31,-73){$\dots$}
\end{picture}
\begin{picture}(72,60)(-20,-67)
\gasset{Nw=16,Nh=16,Nmr=8}
\node(n0)(36.0,-16.0){1}
\node(n1)(4.0,-40.0){$n$} \node(n2)(68.0,-40.0){2}
\node(n3)(16.0,-72.0){$n{-}1$} \node(n4)(56.0,-72.0){3}
\drawedge[ELdist=2.0](n1,n0){$b$} \drawedge[ELdist=1.5](n2,n4){$a, b$}
\drawedge[ELdist=1.7](n0,n2){$a, b$}
\drawedge[ELdist=1.7](n3,n1){$a, b$} \drawedge[ELdist=2.0](n1,n2){$a$}
\put(31,-73){$\dots$}
\end{picture}
\end{center}
\caption{Орграф $W_n$ и автомат $\mathrsfs{W}_n$}\label{fig:anan}
\end{figure}

\begin{theorem}
\label{theorem:anan} Автомат $\mathrsfs{W}_n$ синхронизируем, и его порог
синхронизации равен $n^2-3n+3$.
\end{theorem}

\begin{proof}
Нетрудно проверить, что слово $(ab^{n-2})^{n-2}a$ синхронизирует автомат
$\mathrsfs{W}_n$. Длина этого слова равна $(n-1)(n-2)+1=n^2-3n+3$. С другой
стороны, из теоремы~\ref{dulmage}(b) и предложения~\ref{lower bound} вытекает,
что порог синхронизации для $\mathrsfs{W}_n$ не может быть меньше чем
$((n-1)^2+1)-(n-1)=n^2-3n+3$.
\end{proof}

Серия автоматов $\mathrsfs{W}_n$ была обнаружена первым автором данной работы
в~2008 г. Его первоначальное доказательство теоремы~\ref{theorem:anan}
использовало теоретико-игровую технику из~\cite{AVZ} и было весьма трудоемким.

Теперь продемонстрируем, что и серия автоматов $\mathrsfs{C}_n$ тесно (хотя и
менее очевидным образом) связана с орграфами из серии $W_n$. А именно, мы дадим
новое простое доказательство следующего классического результата.
\begin{figure}[th]
\begin{center}
\unitlength .5mm
\begin{picture}(72,66)(25,-76)
\gasset{Nw=16,Nh=16,Nmr=8,loopdiam=10} \node(n0)(36.0,-16.0){1}
\node(n1)(4.0,-40.0){$n$} \node(n2)(68.0,-40.0){2}
\node(n3)(16.0,-72.0){$n{-}1$} \node(n4)(56.0,-72.0){3}
\drawedge[ELdist=2.0](n1,n0){$a,b$} \drawedge[ELdist=1.5](n2,n4){$b$}
\drawedge[ELdist=1.7](n0,n2){$b$} \drawedge[ELdist=1.7](n3,n1){$b$}
\drawloop[ELdist=1.5,loopangle=30](n2){$a$}
\drawloop[ELdist=2.4,loopangle=-30](n4){$a$}
\drawloop[ELdist=1.5,loopangle=-90](n0){$a$}
\drawloop[ELdist=1.5,loopangle=210](n3){$a$} \put(31,-73){$\dots$}
\end{picture}
\begin{picture}(72,66)(-25,-76)
\gasset{Nw=16,Nh=16,Nmr=8} \node(n0)(36.0,-16.0){1} \node(n1)(4.0,-40.0){$n$}
\node(n2)(68.0,-40.0){2} \node(n3)(16.0,-72.0){$n{-}1$}
\node(n4)(56.0,-72.0){3} \drawedge[ELdist=2.0](n1,n0){$b$}
\drawedge[ELdist=1.5](n2,n4){$b,c$} \drawedge[ELdist=1.7](n0,n2){$b,c$}
\drawedge[ELdist=1.7](n3,n1){$b,c$} \drawedge[ELdist=2.0](n1,n2){$c$}
\put(31,-73){$\dots$}
\end{picture}
\end{center}
\caption{Автомат $\mathrsfs{C}_n$ и автомат, определяемый действиями слов $b$ и
$c=ab$}\label{fig:cerny-n}
\end{figure}

\begin{theorem}[\!\!{\mdseries\cite[лемма~1]{Ce64}}]
\label{theorem:cerny} Автомат $\mathrsfs{C}_n$ синхронизируем, и его порог
синхронизации равен $(n-1)^2$.
\end{theorem}

\begin{proof}
Легко проверить, что слово $(ab^{n-1})^{n-2}a$ синхронизирует автомат
$\mathrsfs{C}_n$. Длина этого слова равна $n(n-2)+1=(n-1)^2$.

Пусть теперь $w$ -- некоторое синхронизирующее $\mathrsfs{C}_n$ слово
минимальной длины. Поскольку буква $b$ действует как перестановка множества
состояний, слово $w$ не может оканчиваться на $b$ -- в противном случае, удалив
последнюю букву из $w$, мы получили бы более короткое синхронизирующее слово.
Итак, $w=w'a$ для некоторого слова $w'\in\{a,b\}^*$, причем образ множества
всех состояний под действием слова $w'$ равен $\{1,n\}$.

Поскольку слово $a^2$ действует на множестве состояний автомата
$\mathrsfs{C}_n$ точно так же, как буква $a$, это слово не может появиться в
$w$ в качестве фактора --  в противном случае, заменив вхождение $a^2$ на $a$,
мы получили бы более короткое синхронизирующее слово. Поэтому после каждого
вхождения $a$ в $w$, кроме последнего, следует вхождение буквы $b$. Положим
$c=ab$, тогда слово $w'$ может быть переписано в слово $v$ над алфавитом
$\{b,c\}$. Действия $b$ и $c$ на множестве $\{1,2,\dots,n\}$ определяют
автомат, изображенный на рис.\,\ref{fig:cerny-n} справа и, как нетрудно видеть,
изоморфный автомату $\mathrsfs{W}_n$. Поскольку слова $w'$ и $v$ действуют на
множестве $\{1,2,\dots,n\}$ одинаково, слово $vc$ является синхронизирующим для
$\mathrsfs{W}_n$. По теореме~\ref{theorem:anan} длина $vc$ (как слова над
алфавитом $\{b,c\}$) не меньше $n^2-3n+3$.  Поскольку $b$ лишь переставляет
состояния, а каждое применение $c$ может перевести в одно состояние лишь одну
пару состояний, слово $vc$, переводящее все состояния в одно, должно содержать
по меньшей мере $n-1$ вхождение $c$. Отсюда длина $v$ как слова над $\{b,c\}$
не меньше $n^2-3n+2$ и $v$ содержит по меньшей мере $n-2$ вхождения $c$.
Поскольку каждое вхождение $c$ в $v$ отвечает вхождению фактора $ab$ в $w'$, мы
можем заключить, что слово $w'$ имеет длину не меньше
$(n^2-3n+2)+(n-2)=n^2-2n$, откуда длина слова $w=w'a$ не меньше
$n^2-2n+1=(n-1)^2$.
\end{proof}

Прием, использованный в приведенном доказательстве теоремы~\ref{theorem:cerny},
пригодится нам ниже, поэтому вычленим центральный аргумент доказательства в
виде отдельного утверждения.
\begin{cor}
\label{simple idempotent} Пусть $\mathrsfs{A}=\langle Q,\{a,b\},\delta\rangle$
-- синхронизируемый $n$-автомат,
\end{cor}

Следующая серия из семейства автоматов, связанных с орграфом $W_n$, состоит из
автоматов $\mathrsfs{E}_n=\langle\{1,2,\dots,n\},\{a,b\},\delta\rangle$, где
буквы $a$ и $b$ действуют следующим образом:
$$\delta(i,a)=\begin{cases}
2, &\text{если } i = 1,\\
3, &\text{если } i = 2,\\
i, &\text{если } i>2;
\end{cases}\quad
\delta(i,b)=\begin{cases}
i+1, &\text{если } i<n,\\
1, &\text{если } i=n.
\end{cases}$$
Автомат $\mathrsfs{E}_n$ изображен на рис.\,\ref{fig:e-n} слева.
\begin{figure}[ht]
\begin{center}
\unitlength .45mm
\begin{picture}(72,66)(25,-76)
\gasset{Nw=16,Nh=16,Nmr=8,loopdiam=10} \node(n0)(36.0,-16.0){2}
\node(n1)(4.0,-40.0){$1$} \node(n2)(68.0,-40.0){3} \node(n3)(16.0,-72.0){$n$}
\node(n4)(56.0,-72.0){4} \drawedge[ELdist=2.0](n1,n0){$a$}
\drawedge[ELdist=1.5](n2,n4){$b$} \drawedge[ELdist=1.7](n0,n2){$a,b$}
\drawedge[ELdist=1.7](n3,n1){$b$} \drawedge[ELdist=1.7](n1,n2){$b$}
\drawloop[ELdist=1.5,loopangle=30](n2){$a$}
\drawloop[ELdist=2.4,loopangle=-30](n4){$a$}
\drawloop[ELdist=1.5,loopangle=210](n3){$a$} \put(31,-73){$\dots$}
\end{picture}
\begin{picture}(72,66)(-25,-76)
\gasset{Nw=16,Nh=16,Nmr=8,loopdiam=10} \node(n0)(36.0,-16.0){2}
\node(n1)(4.0,-40.0){1} \node(n2)(68.0,-40.0){3} \node(n3)(16.0,-72.0){$n$}
\node(n4)(56.0,-72.0){4} \drawedge[ELdist=1.5](n2,n4){$b$}
\drawedge[ELdist=1.7](n0,n2){$b,c$} \drawedge[ELdist=1.7](n3,n1){$b$}
\drawedge[ELdist=2.0](n1,n2){$b,c$} \drawloop[ELdist=1.5,loopangle=30](n2){$c$}
\drawloop[ELdist=2.4,loopangle=-30](n4){$c$}
\drawloop[ELdist=1.5,loopangle=210](n3){$c$} \put(31,-73){$\dots$}
\end{picture}
\end{center}
\caption{Автомат $\mathrsfs{E}_n$ и автомат, определяемый действиями слов $b$ и
$c=aa$}\label{fig:e-n}
\end{figure}

\begin{theorem}
\label{thm:e-n} Автомат $\mathrsfs{E}_n$ синхронизируем, и его порог
синхронизации равен $n^2-3n+2$.
\end{theorem}

\begin{proof}
Несложно проверить, что слово $(a^2b^{n-2})^{n-3}a^2$ синхронизирует автомат
$\mathrsfs{E}_n$. Длина этого слова равна $n(n-3)+2=n^2-3n+2$.

Пусть теперь $w$ -- некоторое синхронизирующее $\mathrsfs{E}_n$ слово
минимальной длины. Заметим, что в $\mathrsfs{E}_n$ слова $bab$ и $b^2$
действуют одинаково и слова $a^3$ и $a^2$ тоже действуют одинаково. Поэтому
факторы $bab$ и $a^3$ не могут входить в слово $w$. Кроме того, $w$ не может
начинаться с $ab$. Действительно, образ множества всех состояний под действием
слова $ab$ равен $\{1,3,\dots,n\}$, что совпадает с образом буквы $b$. Поэтому
если бы слово $w$ начиналось с $ab$, то, заменив $ab$ на $b$, мы получили бы
более короткое синхронизирующее слово. Наконец, $w$ не может заканчиваться на
$ba$. Действительно, если $w=w'a$, то из минимальности $w$ следует, что образ
множества всех состояний под действием слова $w'$ равен $\{2,3\}$, но последнее
множество не принадлежит образу буквы $b$, т.\,е.\ $w'$ не может оканчиваться
на $b$. Итак, любое вхождение буквы $a$ в слово $w$ происходит внутри фактора
$a^2$ и никакие два вхождения таких факторов в $w$ не перекрываются.

Положим $c=a^2$, тогда слово $w$ может быть переписано в слово $v$ над
алфавитом $\{b,c\}$. Действия $b$ и $c$ на множестве $\{1,2,\dots,n\}$
определяют автомат, изображенный на рис.\,\ref{fig:e-n} справа. Поскольку слова
$w$ и $v$ действуют на множестве $\{1,2,\dots,n\}$ одинаково, слово $v$
является синхронизирующим для этого автомата, а значит, и для его подавтомата с
множеством состояний $\{1,3,\dots,n\}$. Легко видеть, что этот подавтомат
изоморфен автомату $\mathrsfs{C}_{n-1}$. По теореме~\ref{theorem:cerny} длина
$v$ как слова над $\{b,c\}$ не меньше $(n-2)^2$ и $v$ содержит по меньшей мере
$n-2$ вхождения $c$. Поскольку каждое вхождение $c$ в $v$ отвечает вхождению
фактора $a^2$ в $w$, мы можем заключить, что слово $w$ имеет длину не меньше
$(n-2)^2+(n-2)=n^2-3n+2$.
\end{proof}

Доказательство теоремы~\ref{thm:e-n} показывает, что автомат $\mathrsfs{E}_n$
возникает из одной из той <<тривиальных>> модификаций автомата
$\mathrsfs{C}_{n-1}$, которые мы обсудили в п.\,4.1. Последняя серия медленно
синхронизируемых автоматов из семейства автоматов, связанных с орграфом $W_n$,
возникает из аналогичной модификации автомата $\mathrsfs{W}_{n-1}$. Она состоит
из автоматов $\mathrsfs{H}_n=\langle\{1,2,\dots,n\},\{a,b\},\delta\rangle$, где
буквы $a$ и $b$ действуют следующим образом:
$$\delta(i,a)=\begin{cases}
n, &\text{если } i=1,\\
i, &\text{если } 1<i<n,\\
1, &\text{если } i=n;
\end{cases}\quad
\delta(i,b)=\begin{cases}
i+1, &\text{если } i<n-1,\\
1, &\text{если } i=n-1,\\
3, &\text{если } i=n.
\end{cases}$$
Автомат $\mathrsfs{H}_n$ изображен на рис.\,\ref{fig:h-n} слева.

\begin{figure}[ht]
\unitlength .5mm
\begin{center}
\begin{picture}(72,72)(25,-75)
\gasset{Nw=16,Nh=16,Nmr=8,loopdiam=10}
\node[NLangle=0.0](n0)(24.25,-23.6){$n{-}1$}
\node[NLangle=0.0](n1)(52.25,-7.6){$1$}
\node[NLangle=0.0](n2)(80.25,-23.6){$2$}
\node[NLangle=0.0](n3)(24.25,-52){$n{-}2$}
\node[NLangle=0.0](n4)(55,-67.6){$4$} \node[NLangle=0.0](n6)(80.25,-52){$3$}
\drawedge(n1,n2){$b$} \drawedge(n2,n6){$b$} \drawedge(n0,n1){$b$}
\drawedge(n3,n0){$b$} \drawedge(n6,n4){$b$} \drawloop[loopangle=0.0](n6){$a$}
\drawloop[loopangle=270.0](n4){$a$} \drawloop[loopangle=180.0](n3){$a$}
\drawloop[loopangle=0.0](n2){$a$} \node[NLangle=0.0](n31)(52.0,-38){$n$}
\drawedge[ELside=r,ELdist=3.0,curvedepth=-5.0](n1,n31){$a$}
\drawedge[ELside=r,ELdist=3.0,curvedepth=-5.0](n31,n1){$a$}
\drawloop[loopangle=180.0](n0){$a$} \drawedge(n31,n6){$b$}
\put(31,-67){$\dots$}
\end{picture}
\begin{picture}(72,72)(-25,-75)
\gasset{Nw=16,Nh=16,Nmr=8,loopdiam=10}
\node[NLangle=0.0](n0)(24.25,-23.6){$n{-}1$}
\node[NLangle=0.0](n1)(52.25,-7.6){$1$}
\node[NLangle=0.0](n2)(80.25,-23.6){$2$}
\node[NLangle=0.0](n3)(24.25,-52){$n{-}2$}
\node[NLangle=0.0](n4)(55,-67.6){$4$} \node[NLangle=0.0](n6)(80.25,-52){$3$}
\drawedge[ELdist=0.7](n1,n2){$b$} \drawedge[ELpos=35, ELdist=0.5](n1,n6){$c$}
\drawedge(n2,n6){$b, c$} \drawedge(n0,n1){$b, c$} \drawedge(n3,n0){$b, c$}
\drawedge(n6,n4){$b,c$} \node[NLangle=0.0](n31)(50,-40){$n$}
\drawedge[ELpos=35,ELdist=0.7](n31,n6){$b$}
\drawedge[ELpos=35,ELdist=0.7](n31,n2){$c$} \put(31,-67){$\dots$}
\end{picture}
\end{center}
\caption{Автомат $\mathrsfs{H}_n$ и автомат, определяемый действиями слов $b$ и
$c=ab$}\label{fig:h-n}
\end{figure}

\begin{theorem}
\label{thm:h-n} Автомат $\mathrsfs{H}_n$ синхронизируем, и его порог
синхронизации равен $n^2-4n+6$.
\end{theorem}

\begin{proof}
Легко убедиться, что слово $b(ab^{n-2})^{n-3}ab$ синхронизирует автомат
$\mathrsfs{H}_n$. Длина этого слова равна $1+(n-1)(n-3)+2=n^2-4n+6$.

Пусть теперь $w$ -- некоторое синхронизирующее $\mathrsfs{H}_n$ слово
минимальной длины. Поскольку в $\mathrsfs{H}_n$ слово $a^2$ действует как
тождественное преобразование, оно не может входить в $w$ в качестве фактора.
Кроме того, слово $w$ не может ни начинаться, ни заканчиваться буквой $a$, так
как эта буква действует на множестве всех состояний как перестановка.

Положим $c=ab$, тогда слово $w$ может быть переписано в слово $v$ над алфавитом
$\{b,c\}$. Действия $b$ и $c$ на множестве $\{1,2,\dots,n\}$ определяют
автомат, изображенный на рис.\,\ref{fig:h-n} справа. Поскольку слова $w$ и $v$
действуют на множестве $\{1,2,\dots,n\}$ одинаково, слово $v$ является
синхронизирующим для этого автомата. Выше отмечено, что слово $w$ начинается с
буквы $b$, а значит, с нее начинается и $v$. Если записать $v=bv'$ для
некоторого $v'\in\{b,c\}^*$, то легко видеть, что слово $v'$ будет
синхронизирующим для подавтомата с множеством состояний $\{1,2,\dots,n-1\}$.
Поскольку этот подавтомат изоморфен автомату $\mathrsfs{W}_{n-1}$, по
теореме~\ref{theorem:anan} длина $v'$ как слова над $\{b,c\}$ не меньше
$(n-1)^2-3(n-1)+3$. Кроме того, $v'$ содержит по меньшей мере $n-2$ вхождения
$c$, поскольку $b$ лишь переставляет состояния из $\{1,2,\dots,n-1\}$, а каждое
применение $c$ может перевести в одно состояние лишь одну пару состояний.
Учитывая, что каждое вхождение $c$ в $v'$ отвечает вхождению фактора $ab$ в
$w$, мы можем заключить, что длина слова $w$  не может быть меньше чем
$1+((n-1)^2-3(n-1)+3)+(n-2)=n^2-4n+6$.
\end{proof}

\paragraph*{4.3. Автоматы, связанные с орграфами серии $D_n$.} Орграф $D_n$ -- это
$n$-орграф с экспонентой $(n-1)^2$, отвечающий второй матрице
в~\eqref{wielandt}. Он получается из орграфа $W_n$ добавлением дуги $(n-1,1)$.
Нетрудно видеть, что с точностью до изоморфизма и переименования букв
существуют ровно две раскраски орграфа $D_n$ с помощью двух букв. На
рис.\,\ref{fig:dulmage} изображен орграф $D_n$ и две его раскраски -- автоматы
$\mathrsfs{D}'_n$ и $\mathrsfs{D}''_n$.

\begin{figure}[ht]
\begin{center}
\unitlength .5mm
\begin{picture}(64,60)(30,-72)
\gasset{Nw=16,Nh=16,Nmr=8}
\node(n0)(32.0,-16.0){1}
\node(n1)(0,-40.0){$n$} \node(n2)(64.0,-40.0){2}
\node(n3)(12.0,-72.0){$n{-}1$} \node(n4)(52.0,-72.0){3}
\drawedge[ELdist=2.0](n1,n0){} \drawedge[ELdist=1.5](n2,n4){}
\drawedge[ELdist=1.7](n0,n2){} \drawedge[ELdist=1.7](n3,n0){}
\drawedge[ELdist=1.7](n3,n1){} \drawedge[ELdist=2.0](n1,n2){}
\put(31,-73){$\dots$}
\end{picture}
\begin{picture}(64,60)(0,-72)
\gasset{Nw=16,Nh=16,Nmr=8}
\node(n0)(32.0,-16.0){1}
\node(n1)(0,-40.0){$n$} \node(n2)(64.0,-40.0){2}
\node(n3)(12.0,-72.0){$n{-}1$} \node(n4)(52.0,-72.0){3}
\drawedge[ELdist=2.0](n1,n0){$b$} \drawedge[ELdist=1.5](n2,n4){$a, b$}
\drawedge[ELdist=1.7](n0,n2){$a,b$} \drawedge[ELdist=1.7](n3,n0){$a$}
\drawedge[ELdist=1.7](n3,n1){$b$} \drawedge[ELdist=2.0](n1,n2){$a$}
\put(31,-73){$\dots$}
\end{picture}
\begin{picture}(64,60)(-30,-72)
\gasset{Nw=16,Nh=16,Nmr=8}
\node(n0)(32.0,-16.0){1}
\node(n1)(0,-40.0){$n$} \node(n2)(64.0,-40.0){2}
\node(n3)(12.0,-72.0){$n{-}1$} \node(n4)(52.0,-72.0){3}
\drawedge[ELdist=2.0](n1,n0){$a$} \drawedge[ELdist=1.5](n2,n4){$a, b$}
\drawedge[ELdist=1.7](n0,n2){$a, b$} \drawedge[ELdist=1.7](n3,n0){$a$}
\drawedge[ELdist=1.7](n3,n1){$b$} \drawedge[ELdist=2.0](n1,n2){$b$}
\put(31,-73){$\dots$}
\end{picture}
\end{center}
\caption{Орграф $D_n$ и его раскраски $\mathrsfs{D}'_n$ и $\mathrsfs{D}''_n$}\label{fig:dulmage}
\end{figure}

\begin{theorem}
\label{theorem:new series} Автоматы $\mathrsfs{D}'_n$ и $\mathrsfs{D}''_n$
синхронизируемы, и их пороги синхронизации равны $n^2-3n+4$ и $n^2-3n+2$
соответственно.
\end{theorem}

\begin{proof}
Нетрудно проверить, что слово $(ab^{n-2})^{n-2}ba$ синхронизирует автомат
$\mathrsfs{D}'_n$, а слово $(ba^{n-1})^{n-3}ba$ -- автомат $\mathrsfs{D}''_n$.
Длины этих слова равны $(n-1)(n-2)+2=n^2-3n+4$ и $n(n-3)+2=n^2-3n+ 2$.

Из теоремы~\ref{dulmage}(b) и предложения~\ref{lower bound} вытекает, что порог
синхронизации для раскрасок орграфа $D_n$ не может быть меньше чем
$(n-1)^2-(n-1)=n^2-3n+2$. Это доказывает утверждение теоремы для автомата
$\mathrsfs{D}''_n$.

Займемся теперь автоматом $\mathrsfs{D}'_n$. Здесь будет полезен следующий
элементарный результат.
\begin{lemma}[\!\!{\mdseries\cite[Теорема 2.1.1]{RaAl05}}]
\label{sylvester} Если натуральные числа $k$ и $\ell$ взаимно просты, то
наибольшее натуральное число, не представимое в виде линейной комбинации чисел
$k$ и $\ell$ c целыми неотрицательными коэффициентами, равно $k\ell-k-\ell$.
\end{lemma}

Пусть теперь $w$ -- некоторое синхронизирующее автомат $\mathrsfs{D}'_n$ слово
минимальной длины. Поскольку 2 -- единственное состояние в $\mathrsfs{D}'_n$,
являющееся общим концом двух разных дуг с одинаковой меткой, из минимальности
$w$ следует, что под действием $w$ все состояния автомата переходят в~2. Если
предположить, что длина $w$ равна $n^2-3n+2$, тогда в $D_n$ найдется маршрут
$\mu$ указанной длины из вершины~1 в вершину~2. Но вершина~1 имеет единственную
исходящую дугу $(1,2)$, следовательно, маршрут $\mu$ состоит из этой дуги и
контура длины $n^2-3n+1$. В орграфе $D_n$ есть ровно три простых контура: один
длины $n$ и два длины $n-1$. Любой контур можно разбить на простые контуры, а
потому число $n^2-3n+1$ должно (как длина некоторого контура в $D_n$) быть
линейной комбинацией чисел $n$ и $n-1$ (длин простых контуров) c целыми
неотрицательными коэффициентами. Но это невозможно по лемме~\ref{sylvester},
поскольку $n^2-3n+1=n(n-1)-n-(n-1)$.

Предположим теперь, что длина $w$ равна $n^2-3n+3$. Тогда в $D_n$ найдется
маршрут указанной длины из вершины~$n-1$ в вершину~2. Поскольку $b$ действует
как перестановка множества всех состояний автомата $\mathrsfs{D}'_n$, слово $w$
должно начинаться с буквы $a$. Состояние $n-1$ под действием $a$ переходит в
состояние~1. Поэтому в $D_n$ должен быть и маршрут  длины $n^2-3n+2$ из~1 в~2,
но в предыдущем абзаце показано, что это невозможно. Таким образом, длина $w$
не может быть меньше чем $n^2-3n+4$.
\end{proof}

Серия $\mathrsfs{D}'_n$ интересна тем, что при $n>6$ автоматы этой серии
обладают наибольшим порогом синхронизации среди всех известных автоматов за
исключением автоматов из серии Черни $\mathrsfs{C}_n$, а также наибольшим
порогом синхронизации среди всех известных автоматов без петель. Серия
$\mathrsfs{D}''_n$ также обладает экстремальным свойством: автоматы этой серии
обладают наибольшим порогом синхронизации среди всех известных автоматов, в
которых ни одна буква не действует как перестановка множества состояний.

C орграфами $D_n$ связана еще одна серия $n$-автоматов с порогом синхронизации
$n^2-4n+6$. Мы не будем ее здесь приводить, поскольку одна серия с такими же
параметрами уже описана выше (см.\ теорему~\ref{thm:h-n}).

\paragraph*{4.4. Автоматы, связанные с орграфами серии $V_n$.} Орграф $V_n$ -- это
$n$-орграф, отвечающий первой матрице в~\eqref{odd island}. Если обозначить
вершины $V_n$ через $1,2,\dots,n$, то его дуги суть $(n,1)$, $(n,3)$ и
$(i,i+1)$ для $i=1,\dots,n-1$. Орграф $V_n$ примитивен только при нечетном $n$,
и в этом случае его экспонента равна $n^2-3n+4$.

Рассмотрим автомат
$\mathrsfs{F}_n=\langle\{1,2,\dots,n\},\{a,b\},\delta\rangle$, где буквы $a$ и
$b$ действуют следующим образом::
$$\delta(i,a)=\begin{cases}
3, &\text{если } i = 1,\\
i, &\text{если } i>1;
\end{cases}\quad
\delta(i,b)=\begin{cases}
i+1, &\text{если } i<n,\\
1, &\text{если } i=n.
\end{cases}$$
Автомат $\mathrsfs{F}_n$ изображен на рис.\,\ref{fig:f-n} слева.

\begin{figure}[th]
\begin{center}
\unitlength .5mm
\begin{picture}(72,86)(25,-76)
\gasset{Nw=16,Nh=16,Nmr=8,loopdiam=10} \node(n0)(36.0,-16.0){2}
\node(n1)(4.0,-40.0){$1$} \node(n2)(68.0,-40.0){3} \node(n3)(16.0,-72.0){$n$}
\node(n4)(56.0,-72.0){4} \drawedge[ELdist=2.0](n1,n0){$b$}
\drawedge[ELdist=1.5](n2,n4){$b$} \drawedge[ELdist=1.7](n0,n2){$b$}
\drawedge[ELdist=1.7](n3,n1){$b$} \drawedge[ELdist=1.7](n1,n2){$a$}
\drawloop[ELdist=1.5,loopangle=30](n2){$a$}
\drawloop[ELdist=2.4,loopangle=-30](n4){$a$}
\drawloop[ELdist=1.5,loopangle=210](n3){$a$}
\drawloop[ELdist=1.5,loopangle=90](n0){$a$} \put(31,-73){$\dots$}
\end{picture}
\begin{picture}(72,86)(-25,-76)
\gasset{Nw=16,Nh=16,Nmr=8}
\node(n0)(36.0,-16.0){2}
\node(n1)(4.0,-40.0){1} \node(n2)(68.0,-40.0){3}
\node(n3)(16.0,-72.0){$n$} \node(n4)(56.0,-72.0){4}
\drawedge[ELdist=1.5](n2,n4){$b,c$}
\drawedge[ELdist=1.7](n0,n2){$b,c$}
\drawedge[ELdist=1.7](n3,n1){$b,c$}
\drawedge[ELdist=2.0](n1,n0){$b$}
\drawedge[ELdist=2.0](n1,n4){$c$}
\put(31,-73){$\dots$}
\end{picture}
\end{center}
\caption{Автомат $\mathrsfs{F}_n$ и автомат, определяемый действиями слов $b$ и
$c=ab$}\label{fig:f-n}
\end{figure}


\begin{theorem}
\label{thm:f-n} Автомат $\mathrsfs{F}_n$ синхронизируем при нечетном $n$, и его
порог синхронизации равен $n^2-3n+3$.
\end{theorem}

\begin{proof}
Непосредственно проверяется, что при каждом нечетном $n$ слово
$(ab^{n-2})^{n-2}a$ синхронизирует автомат $\mathrsfs{F}_n$. Длина этого слова
составляет $(n-1)(n-2)+1=n^2-3n+3$.

Пусть $w$ -- некоторое синхронизирующее автомат $\mathrsfs{F}_n$ слово
минимальной длины. Поскольку буква $b$ действует как перестановка множества
состояний, слово $w$ не может оканчиваться на $b$. Итак, $w=w'a$ для некоторого
слова $w'\in\{a,b\}^*$, причем образ множества всех состояний под действием
слова $w'$ равен $\{1,3\}$. Далее, слово $a^2$ действует на множестве состояний
автомата $\mathrsfs{F}_n$ точно так же, как буква $a$, и потому не может
появиться в $w$ в качестве фактора. Поэтому после каждого вхождения $a$ в $w$,
кроме последнего, следует вхождение буквы $b$. Положим $c=ab$, тогда слово $w'$
может быть переписано в слово $v$ над алфавитом $\{b,c\}$. Действия $b$ и $c$
на множестве $\{1,2,\dots,n\}$ определяют автомат, изображенный на
рис.\,\ref{fig:f-n} справа; обозначим этот автомат через $\mathrsfs{A}$. Ясно,
что автомат $\mathrsfs{A}$ изоморфен некоторой раскраске орграфа $V_n$.
Поскольку слова $w'$ и $v$ действуют на множестве $\{1,2,\dots,n\}$ одинаково,
слово $vc$ является синхронизирующим для $\mathrsfs{A}$. Из
теоремы~\ref{dulmage}(d) и предложения~\ref{lower bound} следует, что порог
синхронизации для раскрасок орграфа $V_n$ не может быть меньше чем
$(n^2-3n+4)-(n-1)=n^2-4n+5$. Поскольку $b$ лишь переставляет состояния, а
каждое применение $c$ может перевести в одно состояние лишь одну пару
состояний, слово $vc$, переводящее все состояния в одно, должно содержать по
меньшей мере $n-1$ вхождение $c$. Отсюда длина $v$ как слова над $\{b,c\}$ не
меньше $n^2-4n+4$ и $v$ содержит по меньшей мере $n-2$ вхождения $c$. Поскольку
каждое вхождение $c$ в $v$ отвечает вхождению фактора $ab$ в $w'$, мы можем
заключить, что слово $w'$ имеет длину не меньше $(n^2-4n+4)+(n-2)=n^2-3n+2$,
откуда длина слова $w=w'a$ не меньше $n^2-3n+3$.
\end{proof}


Кроме автоматов Черни $\mathrsfs{C}_n$, единственной бесконечной серией
2-буквенных медленно-синхронизируемых автоматов,
представленной в литературе ранее, является серия $\mathrsfs{B}_n$ ($n>3$
нечетно)~\cite{AVZ}. Автомат $\mathrsfs{B}_n$ имеет множество состояний
$Q=\{1,2,\dots,n\}$, а его входные буквы $a$ и $b$ действуют на $Q$ следующим
образом:
$$\delta(i,a)=\begin{cases}
i &\text{if } i<n-1,\\
1 &\text{if } i=n-1,\\
2 &\text{if } i=n;
\end{cases}\quad
\delta(i,b)=\begin{cases}
i+1 &\text{if } i<n,\\
1 &\text{if } i=n.
\end{cases}$$
Автомат $\mathrsfs{B}_n$ изображен на рис.\,\ref{fig:avz-n} слева.


%Except the \v{C}ern\'y series $\mathrsfs{C}_n$, the only infinite series of
%2-letter slowly \sa\ published so far was the series $\mathrsfs{B}_n$ ($n>3$
%is odd) constructed in~\cite{AVZ}. The automaton $\mathrsfs{B}_n$ has $Q=\{1,2,\dots,n\}$
%as its state set, and its input letters $a$ and $b$ act on $Q$ as follows:
%$$\delta(i,a)=\begin{cases}
%i &\text{if } i<n-1,\\
%1 &\text{if } i=n-1,\\
%2 &\text{if } i=n;
%\end{cases}\quad
%\delta(i,b)=\begin{cases}
%i+1 &\text{if } i<n,\\
%1 &\text{if } i=n.
%\end{cases}$$
%The automaton $\mathrsfs{B}_n$ is shown in Fig.\,\ref{fig:avz-n} on the left.

\begin{figure}[ht]
\begin{center}
\unitlength .45mm
\begin{picture}(72,72)(30,-76)
\gasset{Nw=16,Nh=16,Nmr=8}
\node(n1)(56.0,-16.0){1}
\node(n2)(68.0,-44.0){2}
\node(n3)(56.0,-72.0){3}
\node(n4)(16.0,-72.0){$n{-}2$}
\node(n5)(4.0,-44.0){$n{-}1$}
\node(n6)(16.0,-16.0){$n$}
\drawedge[ELdist=1.7](n1,n2){$b$}
\drawedge[ELdist=1.7](n2,n3){$b$}
\drawedge[ELdist=1.7](n4,n5){$b$}
\drawedge[ELdist=1.7](n5,n6){$b$}
\drawedge[ELdist=1.7](n6,n1){$b$}
\drawedge[ELdist=1.7,ELpos=40](n5,n1){$a$}
\drawedge[ELdist=1.7,ELpos=60](n6,n2){$a$}
\drawloop[ELdist=1.5,loopangle=30](n1){$a$}
\drawloop[ELdist=1.5,loopangle=0](n2){$a$}
\drawloop[ELdist=1.5,loopangle=-30](n3){$a$}
\drawloop[ELdist=1.5,loopangle=210](n4){$a$}
\put(31,-73){$\dots$}
\end{picture}
\begin{picture}(72,72)(-30,-76)
\gasset{Nw=16,Nh=16,Nmr=8}
\node(n1)(56.0,-16.0){1}
\node(n2)(68.0,-44.0){2}
\node(n3)(56.0,-72.0){3}
\node(n4)(16.0,-72.0){$n{-}2$}
\node(n5)(4.0,-44.0){$n{-}1$}
\node(n6)(16.0,-16.0){$n$}
\drawedge[ELdist=1.7](n1,n2){$b,c$}
\drawedge[ELdist=1.7](n2,n3){$b,c$}
\drawedge[ELdist=1.7](n4,n5){$b,c$}
\drawedge[ELdist=1.7](n5,n6){$b$}
\drawedge[ELdist=1.7](n6,n1){$b$}
\drawedge[ELdist=1.7,ELpos=60](n5,n2){$c$}
\drawedge[ELdist=1.7,ELpos=40](n6,n3){$c$}
\put(31,-73){$\dots$}
\end{picture}
\end{center}
\caption{Автомат $\mathrsfs{B}_n$ и автомат порожденный действием $b$ и $c=ab$}\label{fig:avz-n}
%\caption{The automaton $\mathrsfs{B}_n$ and the automaton induced by the actions of $b$ and $c=ab$}\label{fig:avz-n}
\end{figure}

\begin{theorem}[{\mdseries\cite[Theorem~1.1]{AVZ}}]
\label{theorem:avz}
Если $n>3$ нечетно, то автомат $\mathrsfs{B}_n$ синхронизируем и его граница
синхронизации равна $n^2-3n+2$.

%If $n>3$ is odd, then the automaton $\mathrsfs{B}_n$ is synchronizing and
%its reset length is $n^2-3n+2$.
\end{theorem}

%ДОКАЗАТЕЛЬСТВО ДЛЯ АВТОМАТА ВОЛКОВА
%
%The proof of Theorem~\ref{theorem:avz} in \cite{AVZ} is quite involved. Now we can easily
%prove this result using an argument similar to that in our proof of Theorem~\ref{theorem:cerny}.
%The key observation is that the automaton induced by the actions of $b$ and $c=ab$ on the set $Q$
%as shown in Fig.\,\ref{fig:avz-n} on the right is nothing but a coloring of one of the digraphs
%with exponent $n^2-3n+2$, namely, of the digraph defined by the second matrix in \eqref{odd island}.
%The details of the proof will appear in an extended version of this paper.

Доказательство данного утверждения в~\cite{AVZ} было довольно нетривиальным. Теперь же можно привести
более простое доказательство, сходное с доказательством теоремы~\ref{theorem:cerny}.


\begin{proof}
Пусть $w$ кратчайшее синхронизирующее слово автомата $\mathrsfs{B}_n$.
Преобразование, соответствующее букве $a$, является идемпотентом,
значит в $w$ все появления $a$ разделены между собой буквой $b$. Заметим, что $b$ не склеивает состояния, значит
$w$ начинается и заканчивается на $a$. Пусть $w = w'a$.
%$w = aw'$ и в $w'$ всякое появление $a$ предварено $b$.
Введем новую букву $d = ab$, тогда $w'$ можно однозначно преобразовать в слово $v$ над $\{b,d\}$, заменив всякое
вхождение $ab$ на $d$. Легко видеть, что $ab$ в автомате $\mathrsfs{B}_n$ действует также, как и $d$ в $\mathrsfs{D}$.
Тогда слова $w'$ и $v$ приводят автоматы $\mathrsfs{B}_n$ и $\mathrsfs{D}$, соответственно, к позиции, в которой остались лишь две монеты
непосредственно перед слиянием. Таким образом, $vd$ -- синхронизирующее слово автомата $\mathrsfs{D}$. Интересно также подметить,
что при четном $n$ автоматы $\mathrsfs{A}$ и $\mathrsfs{D}$ не синхронизируемы.
В качестве заключительного состояния в автомате $\mathrsfs{D}$ могут выступать как $1$, так и $2$.
По рассуждениям для автоматов с длинным циклом [диплом] в обоих случаях имеем, что длина слова $vd$ никак не
меньше $(n - 2)n - (2n - 2) + 1 = n^2 - 4n + 3$.
При этом, легко можно повысить это значение как минимум на $1$ за счет предшествующих состояний по большому циклу.
Покажем, что всякое синхронизирующее слово автомата $\mathrsfs{D}$ содержит не меньше $n - 1$ буквы $d$.
Проведем доказательство индукцией по длине синхронизирующего слова $u$.

База индукции: $u$ имеет длину в точности $n^2 - 4n + 4$, и меньше оно быть не может по приведенным выше рассуждениям.
Тогда легко видеть, что $u$ начинается и заканчивается на $d$. Заметим также, что для автомата $\mathrsfs{D}$ выполнены равенства:
$b^n = \varepsilon$ и $db^{n - 1}d = d$. Но тогда ясно, что $b$ не может встретится больше, чем $n - 2$ раза подряд, иначе мы
сможем получить синхронизирующее слово длины меньше, чем $n^2 - 4n + 4$.
Тогда слово $u$ можно представить в виде $db^{k_1}db^{k_2}d...db^{k_l}d$, где $k_i \leq n - 2$, при $i \in \overline{1,l}$.
Предоположим, что $l \leq n - 3$.
Оценим сверху длину $u$. $|u| = l + 1 + \sum\limits_{i = 1}^{l}k_i \leq n - 3 + 1 + l(n - 2) \leq n - 2 + (n - 3)(n - 2) = n^2 - 4n + 4 = |u|$.
Таким образом, все неравенства точны, и мы имеем слово $d(b^{n - 2}d)^{n - 3}$,
но оно не является синхронизирующим, поскольку переставляет состояния $2$ и $3$. Значит предположение не верно и $l \geq n - 2$,
а тогда $d$ встречается не меньше $n - 1$ раза.

Шаг индукции: Пусть теперь $|u| \geq n^2 - 4n + 5$ и любое синхронизирующее слово меньшей длины содержит не меньше $n - 1$ буквы $d$.
Ясно, что если слово $u$ начинается или кончается на букву $b$, то отбросив ее мы получим синхронизирующее слово меньшей длины, а по
предположению индукции оно содержит не меньше $n - 1$ буквы $d$. Если же слово $u$ содержит букву $b$ в степени большей, чем $n - 2$,
то воспользовавшись вышеприведенными равенствами мы сможем перейти к синхронизирующему подслову меньшей длины, а по
предположению индукции оно содержит не меньше $n - 1$ буквы $d$. Если ни одно из сведений не применимо, то применимы рассуждения
из базы индукции. А именно, из предположения $l \leq n - 3$ следует, что $|u| \leq n^2 - 4n + 4$, что противоречит шагу индукции.
Таким образом, слово $u$ содержит не меньше $n - 1$ буквы $d$.
Тогда $vd$, как синхронизирующее слово, содержит не менее $n - 1$ раза букву $d$,
а длина $w'$ будет не меньше $n^2 - 4n + 3 + (n - 2) = n^2 - 3n + 1$.
Откуда мы заключаем, что $w$ не короче $n^2 - 3n + 2$. Заметим, что полученная оценка точна, поскольку слово
$(ab^{n - 2})^{\left[\frac{n}{2}\right] - 1}ab^{n - 3}(ab^{n - 2})^{\left[\frac{n}{2}\right] - 1}a$
синхронизирует автомат $\mathrsfs{A}$.
\end{proof}


Для нечетного, можно поднять еще на единицу.

\unitlength .45mm
\begin{figure}[h]
\begin{center}
%\begin{picture}(102,102)(0,-102)
\begin{picture}(100,95)(0,-95)
\gasset{Nw=16,Nh=16,Nmr=8, loopdiam=10}
%\gasset{Nw=11.0,Nh=11.0,Nmr=5.5}
\node[NLangle=0.0](n0)(24.09,-24.01){$n$}
\node[NLangle=0.0](n1)(51.93,-12.0){$1$}
\node[NLangle=0.0](n2)(80.09,-24.01){$2$}
\node[NLangle=0.0](n3)(12.09,-48.01){$n{-}1$}
\node[NLangle=0.0](n4)(16.09,-76.01){$n{-}2$}
\node[NLangle=0.0](n5)(92.09,-48.01){$3$}
\node[NLangle=0.0](n6)(64.09,-92.01){$5$}
\node[NLangle=0.0](n7)(88.09,-76.01){$4$}
\drawedge(n1,n2){$b$}
\drawedge(n2,n5){$a, b$}
\drawedge(n5,n7){$a, b$}
\drawedge(n7,n6){$a, b$}
%\drawedge[dash={2.0 2.0 2.0 3.0}{0.0},curvedepth=5.65](n6,n4){ }
\drawedge(n4,n3){$a, b$}
\drawedge(n3,n0){$b$}
\drawedge(n0,n1){$a, b$}
\drawedge(n1,n7){$a$}
\drawedge(n3,n2){$a$}
\put(33,-90){$\dots$}
\end{picture}
\end{center}
\caption{ Автомат $\mathrsfs{G}_n$ }
\label{fig:aut:fat}
\end{figure}

\begin{theorem}
Автомат $\mathrsfs{G}_n$ синхронизируем при нечетном $n$, и его граница синхронизации равна $n^2 - 4n + 7$.
\end{theorem}

\begin{proof}
В графе два простых цикла с длинами $n$ и $n - 2$. Эти числа будут взаимнопростыми в случае нечетного $n$. При $n$ четном, данный автомат не будет
синхронизируемым, поэтому в дальнейшем считаем, что $n$ нечетно. Пусть $w$ кратчайшее синхронизирующее слово длины $k$, тогда применяя рассуждения из доказательства
для первого автомата к состоянию 4 получим, что $k \ge (n - 1)(n - 3)$ и нет пути из 4 в 4 длины $n^2 - 4n + 2$. Последовательно покажем невозможность выполнения
нижних оценок для $k$. Пусть $k = n^2 - 4n + 3$, тогда есть путь из 3 в 4 данной длины, а значит и из 4 в 4 длины $n^2 - 4n + 2$, что неверно.
Пусть $k = n^2 - 4n + 4$, тогда есть путь из 2 в 4 данной длины, а значит и из 3 в 4 длины на единицу меньше, что неверно. Ясно, что $w$ начинается на $a$, тогда
равенство $k = n^2 - 4n + 5$ влечет за собой существование пути из состояния $(n - 1)$ в 4 данной длины, причем второй вершиной является 2, но тогда есть путь
длины $n^2 - 4n + 4$
из 2 в 4, что неверно. Пусть выполнено $k = n^2 - 4n + 6$, и рассмотрим два возможных случая для второй буквы $w$. Если $a$, то после действия $aa$ на
состояние $(n - 2)$ получим путь из 2 в 4 длины $n ^2 - 4n + 4$, что неверно. Если $b$, то после действия $ab$ на состояние $n$ снова получим путь длины $n^2 - 4n + 4$
из 2 в 4. Таким образом, справедлива оценка $k \ge n^2 - 4n + 7$, а она точна, поскольку слово $aa(baba^{n - 3})^{n - 4}babaa$ является синхронизирующим.
\end{proof}

\section*{{\centerline{\large\bf \S5. Обсуждение и новые гипотезы}}}

Как уже упоминалось в \S3, из результатов Трахтмана~\cite{Tr09} следует, что
всякий примитивный орграф имеет синхронизируемую раскраску. Это дает основания
для следующего, довольно естественного вопроса: дан примитивный орграф на $n$
вершинах, какова минимальная длина синхронизирующих слов для всех его
синхронизируемых раскрасок? Заметим, что порожденные орграфы
медленно-синхронизируемых автоматов могут обладать раскрасками с маленькой
границей синхронизации. Рис.~\ref{fig:cerny} иллюстрирует это утверждение:
первая раскраска -- это автомат Черни $\mathrsfs{C}_4$, кратчайшее
синхронизирующее слово которого имеет длину~9, вторая же раскраска может быть
синхронизирована словом $a^3$ длины~3. Орграф Виланда $W_n$, в свою очередь,
может быть раскрашен единственным образом, поэтому теорема~\ref{theorem:anan}
дает нижнюю оценку $n^2-3n+3$ на поставленный нами вопрос. Мы убеждены, что
данная оценка, точна. Поэтому мы предлагаем гибридную гипотезу, которая в
некотором смысле параллельна гипотезе Черни и проблеме раскраски дорог.

%As mentioned in Section~\ref{matrices}, Trahtman's recent result~\cite{Tr09}
%implies that every primitive digraph admits a synchronizing coloring. This
%gives rise to the following natural question: given a primitive digraph on
%$n$ vertices, what is the minimum length of \sws\ for its synchronizing
%colorings? Observe that in general underlying digraphs of slowly \sa\ may
%admit colorings with rather short \sws. Fig.~\ref{fig:cerny} illustrates
%this phenomenon: the first coloring of the 4-vertex digraph in Fig.~\ref{fig:cerny}
%is the \v{C}ern\'{y} automaton $\mathrsfs{C}_4$ with shortest reset word of
%length~9 while the second coloring can be reset of the word $a^3$ of length~3.
%Wielandt's digraphs $W_n$, however, can be colored in a essentially unique
%way, whence Theorem~\ref{theorem:anan} gives the lower bound $n^2-3n+3$
%for the value in question. We strongly believe that this lower bound is
%in fact tight, in other words, we suggest a conjecture that is in a sense
%parallel to the \v{C}ern\'{y} one.


\begin{conjecture}
\label{hybrid} Всякий примитивный орграф на $n$ вершинах допускает
синхронизируемую раскраску граница синхронизации которой не превосходит
$n^2-3n+3$.

%Every primitive digraph on $n$ vertices admits a synchronizing coloring
%that can be reset by a word of length $n^2-3n+3$.
\end{conjecture}


Отметим, что несмотря на тесную взаимосвязь между гипотезами~\ref{hybrid} и
Черни, справедливость одной из них, не влечет справедливость другой.

%We observe that while there is a clear analogy between Conjecture~\ref{hybrid}
%and the \v{C}ern\'{y} conjecture, the validity of none of them immediately
%implies the validity of the other.



\begin{thebibliography}{99}
\bibitem{ST00}
\textsl{В.\,Н.\,Сачков, В.\,Е.\,Тараканов}, Комбинаторика неотрицательных
матриц. М.: ТВП, 2000.

\bibitem{AGW}
\textsl{R.\,L.\,Adler, L.\,W.\,Goodwyn, B.\,Weiss}, Equivalence of topological
Markov shifts, Israel J. Math., 27 (1977), 49--63.

\bibitem{AMR}
\textsl{M.\,Almeida, N.\,Moreira, R.\,Reis}, Enumeration and generation with a
string automata representation, Theor.\ Comput.\ Sci., 387 (2007), 93--102.

\bibitem{AGV10}
\textsl{D.\,S.\,Ananichev, V.\,V.\,Gusev, M.\,V.\,Volkov}, Slowly synchronizing
automata and digraphs, Mathematical Foundations of Computer Science, Lect.\
Notes Comput.\ Sci., 6281 (2010), 55--64.

\bibitem{AVZ}
\textsl{D.\,S.\,Ananichev, M.\,V.\,Volkov, Yu.\,I.\,Zaks}, Synchronizing
automata with a letter of deficiency 2, Theor.\ Comput.\ Sci., 376 (2007),
30--41.

\bibitem{Be11}
\textsl{M.\,Berlinkov}, On a conjecture by Carpi and D'Alessandro, Int.\ J.
Foundations Comp.\ Sci., 22 (2011), 1565--1576.

\bibitem{Br}
\textsl{R.\,Brualdi, H.\,Ryser}, Combinatorial Matrix Theory, Cambridge University Press, 1991.

\bibitem{Ce64}
\textsl{J.\,\v{C}ern\'{y}}, Pozn\'{a}mka k homog\'{e}nnym eksperimentom s
kone\v{c}n\'{y}mi automatami, Matematicko-fyzikalny \v{C}asopis Slovensk.\
Akad.\ Vied, 14, \No3 (1964), 208--216 (in Slovak).

\bibitem{DM62}
\textsl{A.\,L.\,Dulmage, N.\,S.\,Mendelsohn}, The exponent of a primitive
matrix, Can.\ Math.\ Bull., 5 (1962), 241--244.

\bibitem{DM64}
\textsl{A.\,L.\,Dulmage, N.\,S.\,Mendelsohn}, Gaps in the exponent set of
primitive matrices, Ill.\ J. Math., 8 (1964), 642--656.

\bibitem{Ka01}
\textsl{J.\,Kari}, A counter example to a conjecture concerning synchronizing
words in finite automata, Bull.\ European Assoc.\ Theor.\ Comput.\ Sci., 73
(2001), 146.

\bibitem{OU10}
\textsl{J.\,Olschewski, M.\,Ummels}, The complexity of finding reset words in
finite automata, Mathematical Foundations of Computer Science, Lect.\ Notes
Comput.\ Sci., 6281 (2010), 568--579.

\bibitem{Pi83}
\textsl{J.-E.\,Pin}, On two combinatorial problems arising from automata
theory, Ann.\ Discrete Math., 17 (1983), 535--548.

\bibitem{RaAl05}
\textsl{J.\,L.\,Ram\'{\i}rez Alfons\'{\i}n}, The diophantine Frobenius problem,
Oxford University Press, 2005.

\bibitem{Sa05}
\textsl{S.\,Sandberg}, Homing and synchronizing sequences, Model-Based Testing
of Reactive Systems, Lect.\ Notes Comput.\ Sci., 3472 (2005), 5--33.


\bibitem{ST11}
\textsl{E.\,Skvortsov, E.\,Tipikin}, Experimental study of the shortest reset
word of random automata, Implementation and Application  of Automata, Lect.\
Notes Comput.\ Sci., 6807 (2011), 290--298.


\bibitem{Tr06}
\textsl{A.\,N.\,Trahtman}, An efficient algorithm finds noticeable trends and
examples concerning the \v{C}ern\'y conjecture, Mathematical Foundations of
Computer Science, Lect.\ Notes Comput.\ Sci., 4162 (2006), 789--800.

\bibitem{Tr06a}
\textsl{A.\,N.\,Trahtman}, Notable trends concerning the synchronization of
graphs and automata, Electr.\ Notes Discrete Math., 25 (2006), 173--175.

\bibitem{Tr09}
\textsl{A.\,N.\,Trahtman}, The Road Coloring Problem, Israel J. Math., 172
(2009), 51--60.

\bibitem{Tr11}
\textsl{A.\,N.\,Trahtman}, Modifying the upper bound on the length of minimal
synchronizing word,  Fundamentals of Computation Theory, Lect.\ Notes Comput.\
Sci, 6914 (2011), 173--180.

\bibitem{Vo08}
\textsl{M.\,V.\,Volkov}, Synchronizing automata and the \v{C}ern\'{y}
conjecture, Languages and Automata: Theory and Applications, Lect.\ Notes
Comput.\ Sci., 5196, (2008), 11--27.

\bibitem{Vo09}
\textsl{M.\,V.\,Volkov}, Synchronizing automata preserving a chain of partial
orders, Theor.\ Comput.\ Sci., 410 (2009), 3513--3519.

\bibitem{Wi50}
\textsl{H.\,Wielandt}, Unzerlegbare, nicht negative Matrizen, Math.\ Z., 52,
(1950), 642--648 (in German).
\end{thebibliography}


\end{document}

Здесь (и в некоторых из последующих доказательств) удобно смотреть на процесс
синхронизации как на игру. В начальной позиции этой игры все состояния автомата
покрыты фишками. Каждый ход игры состоит в применении к текущей позиции одной
из букв входного алфавита; при этом фишки перемещаются вдоль дуг, помеченных
примененной буквой, и если после хода на каком-то состоянии окажется более
одной фишки, то с него снимаются все фишки, кроме одной. Цель игры --
освободить все фишки, кроме одной. Ясно, что каждая последо
